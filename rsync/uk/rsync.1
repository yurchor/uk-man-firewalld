.\"*******************************************************************
.\"
.\" This file was generated with po4a. Translate the source file.
.\"
.\"*******************************************************************
.TH rsync 1 "15 квітня 2022 року" "rsync 3.2.4" "Команди користувача"
.\" prefix=/usr
.P
.SH НАЗВА
.P
rsync — швидкий, різнобічний, віддалений (і локальний) інструмент для
копіювання файлів
.P
.SH "КОРОТКИЙ ОПИС"
.P
.nf
Локально:
    rsync [ПАРАМЕТР...] ДЖЕРЕЛО... [ПРИЗНАЧЕННЯ]

Доступ з віддаленої оболонки:
    Отримання:
        rsync [ПАРАМЕТР...] [КОРИСТУВАЧ@]ВУЗОЛ:ДЖЕРЕЛО... [ПРИЗНАЧЕННЯ]
    Надсилання:
        rsync [ПАРАМЕТР...] ДЖЕРЕЛО... [КОРИСТУВАЧ@]ВУЗОЛ:ПРИЗНАЧЕННЯ

Доступ з фонової служби rsync:
    Отримання:
        rsync [ПАРАМЕТР...] [КОРИСТУВАЧ@]ВУЗОЛ::ДЖЕРЕЛО... [ПРИЗНАЧЕННЯ]
        rsync [ПАРАМЕТР...] rsync://[КОРИСТУВАЧ@]ВУЗОЛ[:ПОРТ]/ДЖЕРЕЛО... [ПРИЗНАЧЕННЯ]
    Надсилання:
        rsync [ПАРАМЕТР...] ДЖЕРЕЛО... [КОРИСТУВАЧ@]ВУЗОЛ::ПРИЗНАЧЕННЯ
        rsync [ПАРАМЕТР...] ДЖЕРЕЛО... rsync://[КОРИСТУВАЧ@]ВУЗОЛ[:ПОРТ]/ПРИЗНАЧЕННЯ)
.fi
.P
Якщо вказано лише аргумент ДЖЕРЕЛО без аргументу ПРИЗНАЧЕННЯ, буде виведено
список файлів джерела замість копіювання.
.P
Інтернет\-версія цієї сторінки підручника (із перехресними посиланнями)
доступна за адресою https://download.samba.org/pub/rsync/rsync.1.
.P
.SH ОПИС
.P
Rsync є швидким і дуже різнобічним інструментом для копіювання файлів. Він
може копіювати локально, на інший вузол або з іншого вузла за допомогою
будь\-якої віддаленої командної оболонки або з віддаленої фонової служби
rsync чи до неї. Програма пропонує велику кількість параметрів, які керують
усіма аспектами поведінки програми, і уможливлює дуже гнучке визначення
набору файлів, які слід скопіювати. Програма відома своїм алгоритмом
дельта\-передавання, який зменшує обсяг даних, які передаються мережею,
шляхом надсилання лише відмінностей між файлами джерела та наявними файлами
призначення. Rsync широко використовують для резервного копіювання та
створення дзеркал даних, як удосконалену версію команди копіювання для
щоденного використання.
.P
Rsync знаходить файли, які має бути передано, за допомогою алгоритму
«швидкої перевірки» (типово), який шукає файли із різним розміром або різним
часом останнього внесення змін. Усі зміни в інших збережених атрибутах
(відповідно до параметрів) буде внесено до файла призначення безпосередньо,
якщо швидка перевірка вказує, що дані у самому файлів не потребують
оновлення.
.P
Серед додаткових можливостей rsync такі:
.P
.IP o
підтримка копіювання посилань, пристроїв, власників, груп та прав доступу
.IP o
параметри exclude і exclude\-from, подібні до GNU tar
.IP o
режим виключення системи керування версіями (CVS) для ігнорування тих самих
файлів, які ігнорує система керування версіями
.IP o
може використовувати будь\-яку прозору віддалену оболонку, включно із ssh та
rsh
.IP o
не потребує привілеїв надкористувача
.IP o
канальне передавання файлів для мінімізації латентності
.IP o
підтримка анонімних фонових служб та служб із розпізнаванням rsync (ідеально
для створення дзеркал)
.P
.SH ЗАГАЛЬНЕ
.P
Rsync копіює файли на віддалений вузол або з віддаленого вузла чи локально
на поточному вузлі (підтримки копіювання файлів між двома віддаленими
вузлами не передбачено).
.P
Передбачено два різних способи зв'язку rsync із віддаленою системою: за
допомогою каналу передавання даних програми віддаленої оболонки (зокрема ssh
або rsh), або за допомогою встановлення зв'язку із фоновою службою rsync
безпосередньо за допомогою TCP. Канал передавання даних віддаленої оболонки
буде використано, якщо у записах шляхів джерела і призначення міститься
двокрапка\-роздільник (:) після специфікації вузла. Зв'язок із фоновою
службою rsync безпосередньо відбувається, коли у записах шляхів джерела і
призначення міститься роздільник — подвійна двокрапка (::) після
специфікації вузла, або вказано адресу rsync:// (див. також розділ
ВИКОРИСТАННЯ МОЖЛИВОСТЕЙ ФОНОВОЇ СЛУЖБИ RSYNC ЗА ДОПОМОГОЮ З'ЄДНАННЯ
ВІДДАЛЕНОЇ ОБОЛОНКИ за виключенням цього останнього правила).
.P
Окремим випадком, визначення лише аргументу джерела, без призначення. У
цьому випадку буде виведено список файлів у форматі, подібному до «\fBls\ \-l\fP».
.P
Як і слід очікувати, якщо ні шлях джерела, ні шлях призначення не вказують
на віддалений вузол, копіювання виконуватиметься локально (див. також
параметр \fB\-\-list\-only\fP).
.P
У rsync локальним боком є клієнт, а віддаленим боком — сервер. Не слід
плутати сервер із фоновою службою rsync. Фонова служба завжди є сервером,
але сервер може бути як фоновою службою, так і породженим віддаленою
оболонкою процесом.
.P
.SH НАЛАШТУВАННЯ
.P
Див. файл README.md, де наведено настанови щодо встановлення.
.P
Після встановлення ви можете скористатися rsync на будь\-якому комп'ютері, до
якого ви маєте доступ за допомогою віддаленої оболонки (а також комп'ютері,
до якого ви можете отримати доступ за допомогою протоколу режиму фонової
служби rsync). Для віддаленого передавання даних у сучасній версії rsync
буде використано ssh для обміну даними, але можна налаштувати типове
використання іншої віддаленої оболонки, зокрема rsh або remsh.
.P
Ви також можете вказати будь\-яку бажану для вас віддалену оболонку за
допомогою параметра командного рядка \fB\-e\fP або встановлення змінної
середовища \fBRSYNC_RSH\fP.
.P
Зауважте, що rsync має бути встановлено на комп'ютерах джерела та
призначення копійованих даних.
.P
.SH КОРИСТУВАННЯ
.P
Користування rsync подібне до користування rcp. Вам слід вказати джерело і
призначення, один із цих параметрів може бути віддаленим.
.P
Ймовірно, найкращим способом пояснити синтаксис команд є декілька прикладів:
.RS 4
.P
.nf
rsync \-t *.c десь:джерело/
.fi
.RE
.P
Ця команда перенесе усі файли, назви яких відповідають взірцю \fB*.c\fP, з
поточного каталогу до каталогу «джерело» на комп'ютері «десь». Якщо у
віддаленій файловій системі вже існують якість з копійованих файлів, буде
використано протокол remote\-update rsync для оновлення файлів шляхом
надсилання лише відмінностей у даних, які у них зберігаються. Зауважте, що
за розгортання шаблонів заміни у рядку команди (\fB*.c\fP) до списку файлів
відповідає командна оболонка, яка виконує це завдання до запуску rsync, а не
сама програма rsync (так само, яке це справедливо для усіх інших програм у
стилі Posix).
.RS 4
.P
.nf
rsync \-avz десь:джерело/щось /data/tmp
.fi
.RE
.P
Ця команда виконає рекурсивне перенесення усіх файлів з каталогу
«джерело/щось» на комп'ютері «десь» до каталогу «/data/tmp/щось» на
локальному комп'ютері. Файли буде перенесено у режимі архівування, який
зберігає символічні посилання, пристрої, атрибути, права доступу, права
власності тощо під час перенесення. Крім того, для зменшення потоку даних
буде використано стискання.
.RS 4
.P
.nf
rsync \-avz десь:джерело/щось/ /data/tmp
.fi
.RE
.P
Кінцевий символ похилої риски в аргументі джерела змінює цю поведінку: у
призначенні буде створено додатковий рівень каталогів. Кінцевий символ
похилої риски можна розглядати як наказ «скопіювати вміст цього каталогу»,
замість «скопіювати каталог за назвою», але в обох випадках атрибути
каталогу буде перенесено до відповідного каталогу призначення. Іншими
словами, обидві наступні команди копіюють файли однаково, разом із їхнім
набором атрибутів у /призначення/десь:
.RS 4
.P
.nf
rsync \-av /джерело/десь /призначення
rsync \-av /джерело/десь/ /призначення/десь
.fi
.RE
.P
Зауважте також, що посилання на вузол і модуль не потребують завершальної
похилої риски для копіювання вмісту типового каталогу. Наприклад, обидві ці
команди скопіюють вміст віддаленого каталогу до «/призначення»:
.RS 4
.P
.nf
rsync \-av вузол: /призначення
rsync \-av вузол::модуль /призначення
.fi
.RE
.P
Ви також можете скористатися rsync у режимі локального комп'ютера, де і у
записі джерела, і у записі призначення немає «:». У цьому випадку програма
поводить себе як удосконалена версія команди copy.
.P
Нарешті, ви можете ознайомитися зі списком усіх модулів певної фонової
служби rsync, якщо не будете вказувати назви модуля:
.RS 4
.P
.nf
rsync якийсь_вузол.mydomain.com::
.fi
.RE
.P
Докладніше про це у наступному розділі.
.P
.SH "ДОДАТКОВІ МОЖЛИВОСТІ"
.P
Синтаксична конструкція для запиту декількох файлів з віддаленого вузла є
такою: слід задати додаткові аргументи віддаленого вузла у тому самому
стилі, що і перший аргумент, або не вказувати назви вузла. Наприклад,
працюватимуть усі такі команди:
.RS 4
.P
.nf
rsync \-aiv вузол:файл1 :файл2 вузол:файл{3,4} /призначення/
rsync \-aiv вузол::назва_модуля/файл{1,2} вузол::назва_модуля/extra /призначення/
rsync \-aiv вузол::назва_модуля/перший ::modname/extra{1,2} /призначення/
.fi
.RE
.P
У сучасних версіях rsync вам достатньо взяти у лапки або екранувати
зворотною похилою рискою речі, подібні до пробілів з локальної оболонки, але
не робити цього з віддаленої оболонки:
.RS 4
.P
.nf
rsync \-aiv вузол:'простий файл.pdf' /призначення/
.fi
.RE
.P
У дуже старих версіях rsync можна вказувати лише один аргумент
remote\-source, тому на віддаленому боці аргументи поділяються на
пробілах. Ви усе ще можете скористатися цим давнім стилем поділу аргументів,
якщо скористаєтеся параметром \fB\-\-old\-args\fP:
.RS 4
.P
.nf
rsync \-ai \-\-old\-args вузол:'каталог1/файл1 каталог2/файл2' /призначення
rsync \-ai \-\-old\-args вузол::'назва_модуля/каталог1/файл1 назва_модуля/каталог2/файл2' /призначення
.fi
.RE
.P
Ознайомтеся із розділом щодо цього параметра, щоб дізнатися більше про
змінну середовища, яку можна експортувати, щоб допомогти роботі застарілих
скриптів.
.P
.SH "ВСТАНОВЛЕННЯ З'ЄДНАННЯ ІЗ ФОНОВОЮ СЛУЖБОЮ RSYNC"
.P
Також можна скористатися rsync без віддаленої оболонки для передавання
даних. У цьому випадку з'єднання із віддаленою фоновою службою rsync
встановлюють безпосередньо, типово, за допомогою TCP, порт 873. (Це,
очевидно, потребує запуску фонової служби у віддаленій системі, тому
зверніться до розділу ЗАПУСК ФОНОВОЇ СЛУЖБИ RSYNC ДЛЯ ПРИЙНЯТТЯ З'ЄДНАНЬ,
щоб дізнатися про це більше.)
.P
Користування rsync у цей спосіб подібне до користування програмою за
допомогою віддаленої оболонки, окрім такого:
.P
.IP o
вам слід або користуватися подвійною двокрапкою, ::, замість одинарної
двокрапки для відокремлення назви вузла від шляху, або слід користуватися
адресою rsync://.
.IP o
першим словом «шляху» має бути сама назва модуля.
.IP o
віддалене фонова служба може виводити «повідомлення дня» при з'єднанні.
.IP o
якщо ви не вкажете назви шляху на віддаленій фоновій службі, буде виведено
список доступних шляхів на фоновій службі.
.IP o
якщо ви вкажете нелокальне призначення, буде виведено список вказаних файлів
на віддаленій фоновій службі.
.IP o
вам не слід користуватися параметром \fB\-\-rsh\fP (\fB\-e\fP) (оскільки він наказує
використовувати для з'єднання із фоновою службою ssh\ \-\- див. ВИКОРИСТАННЯ
МОЖЛИВОСТЕЙ ФОНОВОЇ СЛУЖБИ RSYNC\-ЗА ДОПОМОГОЮ З'ЄДНАННЯ ІЗ ВІДДАЛЕНОЮ
ОБОЛОНКОЮ нижче).
.P
Приклад копіювання усіх файлів у віддаленому модулі із назвою «джерело»:
.RS 4
.P
.nf
rsync \-av вузол::джерело /призначення
.fi
.RE
.P
Деякі модулі у віддаленій фоновій службі можуть потребувати проходження
розпізнавання. Якщо ви матимете справу з таким модулем, програма покаже
запит щодо пароля під час встановлення з'єднання. Ви можете уникнути запиту
встановленням для змінної середовища \fBRSYNC_PASSWORD\fP значення пароля, яким
ви хочете скористатися, або додати до команди параметра
\fB\-\-password\-file\fP. Ці варіанти корисні при створенні скриптів з rsync.
.P
УВАГА! У деяких системах змінні середовища є видимими для усіх
користувачів. У цих системах рекомендуємо користуватися параметром
\fB\-\-password\-file\fP.
.P
Ви можете встановити з'єднання за допомогою проксі\-сервера, якщо встановите
для змінної середовища \fBRSYNC_PROXY\fP значення назва_вузла:порт, яке
вказуватиме на ваш проксі\-сервер. Зауважте, що у налаштуваннях вашого
проксі\-сервера має бути передбачено підтримку з'єднань з проксі\-сервером на
порту 873.
.P
Ви також можете встановлювати з'єднання з фоновою службою за допомогою
програми, як проксі\-сервера, встановленням для змінної середовища
\fBRSYNC_CONNECT_PROG\fP значення команд, які ви хочете запустити замість
створення безпосереднього з'єднання із сокетом. У рядку може міститися
замінник «%H», який є відповідником назви вузла, вказану у команді rsync
(тому користуйтеся «%%», якщо вам потрібен одинарний символ «%» у
рядку). Приклад:
.RS 4
.P
.nf
export RSYNC_CONNECT_PROG='ssh proxyhost nc %H 873'
rsync \-av цільовий_вузол1::модуль/джерело/ /призначення/
rsync \-av rsync://цільовий_вузол2/модуль/джерело/ /призначення/
.fi
.RE
.P
У вказаній вище команді використано ssh для запуску nc (netcat) на
проксі\-вузлі, який переспрямовує усі дані на порт 873 (фонова служба rsync)
на цільовому_вузлі (%H).
.P
Зауважте також, що якщо встановлення значення змінної середовища
\fBRSYNC_SHELL\fP, відповідну програму буде використано для запуску команди
\fBRSYNC_CONNECT_PROG\fP замість використання типової командної оболонки
виклику \fBsystem()\fP.
.P
.SH "ВИКОРИСТАННЯ МОЖЛИВОСТЕЙ ФОНОВОЇ СЛУЖБИ RSYNC\-ЗА ДОПОМОГОЮ З'ЄДНАННЯ ІЗ ВІДДАЛЕНОЮ ОБОЛОНКОЮ"
.P
Іноді корисно скористатися різноманітними можливостями фонової служби rsync
(зокрема іменованими модулями) без уможливлення якихось нових з'єднань із
сокетами у системі (окрім тих, які вже потрібні для уможливлення доступу до
віддаленої оболонки). У rsync передбачено підтримку з'єднання із вузлом за
допомогою віддаленої оболонки із наступним породженням одноразового сервера
«фонової служби», який прочитає свій файл налаштувань у домашньому каталозі
віддаленого користувача. Це може бути корисним, якщо ви хочете шифрувати
передані дані у стилі фонової служби, але оскільки фонову службу запущено
наново віддаленим користувачем, ви не можете скористатися можливостями зміни
кореневої теки або зміни uid, використаного фоновою службою. (Іншим способом
шифрування переданих даних фонової служби є використання ssh для тунелювання
локального порту до віддаленого комп'ютера і налаштовування звичайної
фонової служби rsync на віддаленому вузлі так, щоб вона приймала лише
з'єднання з вузла «localhost».)
.P
З точки зору користувача при передаванні даних фоновою службою за допомогою
з'єднання із віддаленою оболонкою використовують майже такий самий синтаксис
командного рядка, що і при звичайному передаванні даних фоновою службою
rsync. Єдиним винятком є те, що вам доведеться явним чином встановити
програму віддаленої оболонки у командному рядку за допомогою параметра
\fB\-\-rsh=КОМАНДА\fP. (Встановлення RSYNC_RSH у середовищі не увімкне цю
функціональну можливість.) Приклад:
.RS 4
.P
.nf
rsync \-av \-\-rsh=ssh вузол::модуль /призначення
.fi
.RE
.P
Якщо вам потрібно вказати іншого користувача віддаленої оболонки, зверніть
увагу на те, що префікс «користувач@» перед записом вузла вказує значення
користувача rsync (для модуля, який потребує розпізнавання на рівні
користувачів). Це означає, що вам слід вказати параметр «\-l користувач» для
ssh при визначенні віддаленої оболонки, як у цьому прикладі, де використано
коротку версію параметра \fB\-\-rsh\fP:
.RS 4
.P
.nf
rsync \-av \-e "ssh \-l користувач\-ssh" користувач\-rsync@вузол::модуль /призначення
.fi
.RE
.P
Запис «користувач\-ssh» буде використано на рівні ssh; запис
«користувач\-rsync» буде використано для входу до «модуля».
.P
.SH "ЗАПУСК ФОНОВОЇ СЛУЖБИ RSYNC ДЛЯ ПРИЙНЯТТЯ З'ЄДНАНЬ"
.P
Для встановлення з'єднання із фоновою службою rsync на віддаленій системі
вже має бути запущено фонову службу (або там має бути налаштовано щось,
подібне до inetd для породження фонової служби rsync для вхідних з'єднань на
певному порту). Щоб дізнатися про те, як запустити фонову службу, яка
оброблятиме вхідні з'єднання на сокеті, ознайомтеся зі сторінкою підручника
щодо \fBrsyncd.conf\fP(5)\ \-\- сторінку присвячено файлу налаштувань фонової
служби, він містить усі подробиці щодо того, як запустити фонову службу
(включно із самодостатніми налаштуваннями та налаштуваннями для inetd).
.P
Якщо ви користуєтеся одним із каналів передавання віддаленої оболонки, у
запуску фонової служби rsync вручну немає потреби.
.P
.SH "ПОРЯДОК СОРТУВАННЯ ПЕРЕДАВАНЬ ДАНИХ"
.P
Rsync завжди упорядковує вказані назви файлів у власному вбудованому списку
передавань. Це стосується об'єднання вмісту каталогів із однаковими назвами,
спрощення вилучення дублікатів назв файлів і може спричинити непорозуміння:
файли буде передано не у тому порядку, у якому їх було вказано у рядку
команди.
.P
Якщо вам потрібно, щоб певний файл було передано перед іншими, або розділіть
файли між різними викликами rsync, або скористайтеся параметром
\fB\-\-delay\-updates\fP (який не впливає на порядок сортування передавань, але
значно пришвидшує настання остаточної фази оновлення файлів).
.P
.SH ПРИКЛАДИ
.P
Нижче наведено декілька прикладів використання rsync.
.P
Для резервного копіювання домашнього каталогу жінки автора, де містяться
великі файли MS Word і поштові теки, автор користується завданням cron, яке
віддає команду
.RS 4
.P
.nf
rsync \-Cavz . arvidsjaur:backup
.fi
.RE
.P
кожної ночі за з'єднанням PPP до каталогу дублікатів на комп'ютері автора
«arvidsjaur».
.P
Щоб синхронізувати ієрархії файлів початкового коду samba, автор
використовує такі цілі у Makefile:
.RS 4
.P
.nf
get:
    rsync \-avuzb \-\-exclude '*~' samba:samba/ .
put:
    rsync \-Cavuzb . samba:samba/
sync: get put
.fi
.RE
.P
Це уможливлює синхронізацію з каталогом CVS версіями на іншому боці
з'єднання. Далі, автор виконує дії із CVS на віддаленому комп'ютері, що
заощаджує багато часу, оскільки протокол віддаленої роботи з CVS не є аж
надто ефективним.
.P
Автор віддзеркалює каталог «old» і «new» сайтів ftp за допомогою такою
команди:
.RS 4
.P
.nf
rsync \-az \-e ssh \-\-delete ~ftp/pub/samba nimbus:"~ftp/pub/tridge"
.fi
.RE
.P
Це запускається з cron кожні декілька годин.
.P
.SH "РЕЗЮМЕ ПАРАМЕТРІВ"
.P
Тут наведено коротке резюме параметрів, які доступні у rsync. Кожен параметр
докладно описано нижче на цій сторінці підручника.
.P
.nf
\-\-verbose, \-v            збільшити докладність
\-\-info=ПРАПОРЦІ          точне керування докладністю відомостей
\-\-debug=ПРАПОРЦІ         точне керування докладністю діагностики
\-\-stderr=e|a|c           змінити режим виведення stderr (типовий рівень: errors, помилки)
\-\-quiet, \-q              придушити повідомлення, які не є помилками
\-\-no\-motd                придушити MOTD режиму фонової служби
\-\-checksum, \-c           пропускати на основі контрольної суми, а не часу змін та розміру
\-\-archive, \-a            режим архівування \-rlptgoD (не \-A,\-X,\-U,\-N,\-H)
\-\-no\-ПАРАМЕТР            вимкнути ПАРАМЕТР (наприклад, \-\-no\-D)
\-\-recursive, \-r          рекурсивно обробляти каталоги
\-\-relative, \-R           використовувати відносні шляхи
\-\-no\-implied\-dirs        не надсилати неявні каталоги з \-\-relative
\-\-backup, \-b             створювати резервні копії (див. \-\-suffix і \-\-backup\-dir)
\-\-backup\-dir=КАТАЛОГ     створювати резервні копії до ієрархії на основі КАТАЛОГУ
\-\-suffix=СУФІКС          суфікс резервних копій (типово ~ без \-\-backup\-dir)
\-\-update, \-u             пропускати файли, які є новішими на боці отримувача
\-\-inplace                оновити файли призначення на місці
\-\-append                 дописати дані до коротших файлів
\-\-append\-verify          \-\-append зі старими даними у контрольній сумі файла
\-\-dirs, \-d               передавати каталоги без рекурсії
\-\-old\-dirs, \-\-old\-d      працює як \-\-dirs при роботі зі старим rsync
\-\-mkpath                 створити компонент шляху призначення
\-\-links, \-l              копіювати символічні посилання як символічні посилання
\-\-copy\-links, \-L         перетворити символічні посилання на відповідні файли/каталоги
\-\-copy\-unsafe\-links      перетворювати лише «небезпечні» символічні посилання
\-\-safe\-links             ігнорувати символічні посилання, які вказують на об'єкти поза ієрархією
\-\-munge\-links            псувати символічні посилання, щоб зробити їх безпечними і непридатними
\-\-copy\-dirlinks, \-k      перетворювати символічні посилання на каталог на відповідний каталог
\-\-keep\-dirlinks, \-K      вважати символічне посилання на каталог на боці отримувача каталогом
\-\-hard\-links, \-H         зберігати жорсткі посилання
\-\-perms, \-p              зберігати права доступу
\-\-executability, \-E      зберігати права на виконання
\-\-chmod=РЕЖИМ            змінювати права доступу на файл і/або каталог на вказані
\-\-acls, \-A               зберігати ACL (неявно встановлює \-\-perms)
\-\-xattrs, \-X             зберігати розширені атрибути
\-\-owner, \-o              зберігати власника (лише для надкористувача)
\-\-group, \-g              зберігати групу
\-\-devices                зберігати файли пристроїв (лише для надкористувача)
\-\-copy\-devices           копіювати вміст пристрою як звичайний файл
\-\-write\-devices          записувати на пристрої, як у файли (неявно встановлює \-\-inplace)
\-\-specials               зберігати спеціальні файли
\-D                       те саме, що і \-\-devices \-\-specials
\-\-times, \-t              зберігати час внесення змін
\-\-atimes, \-U             зберігати час доступу (використання)
\-\-open\-noatime           уникати зміни atime для відкрити файлів
\-\-crtimes, \-N            зберігати час створення (новизну)
\-\-omit\-dir\-times, \-O     пропустити directories from \-\-times
\-\-omit\-link\-times, \-J    пропустити symlinks from \-\-times
\-\-super                  отримувач намагається виконати дії надкористувача
\-\-fake\-super             зберігати/відновлювати привілейовані атрибути за допомогою xattrs
\-\-sparse, \-S             перетворити послідовності нулів на розріджені блоки
\-\-preallocate            отримувати пам'ять для файлів призначення до запису їх
\-\-dry\-run, \-n            виконати тестовий запуск без внесення змін
\-\-whole\-file, \-W         копіювати файли цілком (без алгоритму delta\-xfer)
\-\-checksum\-choice=РЯДОК  вибрати алгоритм контрольної суми (альтернатива \-\-cc)
\-\-one\-file\-system, \-x    не виходити за межі файлової системи
\-\-block\-size=РОЗМІР, \-B  примусово використати фіксований розмір блоку контрольної суми
\-\-rsh=КОМАНДА, \-e        вказати віддалену оболонку, якою слід скористатися
\-\-rsync\-path=ПРОГРАМА    вказати rsync програму для запуску на віддаленому комп'ютері
\-\-existing               пропустити створення файлів на боці отримувача
\-\-ignore\-existing        пропустити оновлення файлів, які існують на боці отримувача
\-\-remove\-source\-files    відправник вилучає синхронізовані файли (не каталоги)
\-\-del                    альтернатива \-\-delete\-during
\-\-delete                 вилучити сторонні файли з каталогів призначення
\-\-delete\-before          отримувач вилучає до xfer, а не у процесі
\-\-delete\-during          отримувач вилучає під час перенесення
\-\-delete\-delay           знаходити об'єкти вилучення у процесі, вилучити після
\-\-delete\-after           отримувач вилучає дані після перенесення, а не у процесі
\-\-delete\-excluded        також вилучити виключені файли з каталогів призначення
\-\-ignore\-missing\-args    ігнорувати пропущені аргументи джерела без помилки
\-\-delete\-missing\-args    вилучити пропущені аргументи джерела з призначення
\-\-ignore\-errors          вилучити, навіть якщо стануться помилки введення\-виведення
\-\-force                  примусове вилучення каталогів, навіть якщо вони не порожні
\-\-max\-delete=ЧИСЛО       не вилучати більше, ніж ЧИСЛО файлів
\-\-max\-size=РОЗМІР        не переносити файли, більші за РОЗМІР
\-\-min\-size=РОЗМІР        не переносити файли, менші за РОЗМІР
\-\-max\-alloc=РОЗМІР       змінити обмеження щодо отримання пам'яті
\-\-partial                зберігати частково перенесені файли
\-\-partial\-dir=КАТАЛОГ    розміщувати частково перенесені файли до КАТАЛОГУ
\-\-delay\-updates          розміщувати усі оновлені файли на кінцевому місці
\-\-prune\-empty\-dirs, \-m   витирати порожні ланцюжки каталогів зі списку файлів
\-\-numeric\-ids            не пов'язувати значення uid/gid з назвами користувачів і груп
\-\-usermap=РЯДОК          нетипова прив'язка до імені користувача
\-\-groupmap=РЯДОК         нетипова прив'язка до назви групи
\-\-chown=КОРИСТУВАЧ:ГРУПА проста прив'язка до користувача і групи
\-\-timeout=СЕКУНДИ        встановити час очікування на введення\-виведення у секундах
\-\-contimeout=СЕКУНДИ     встановити час очікування на з'єднання із фоновою службою
\-\-ignore\-times, \-I       не пропускати файли, у яких збігаються розмір і час
\-\-size\-only              пропускати файли, для яких збігається розмір
\-\-modify\-window=N, \-@    встановити точність порівнянь часу внесення змін
\-\-temp\-dir=КАТАЛОГ, \-T   створити тимчасові файли у каталозі КАТАЛОГ
\-\-fuzzy, \-y              знаходити подібні файли, якщо немає файла призначення
\-\-compare\-dest=КАТАЛОГ   також порівняти файли призначення відносно КАТАЛОГУ
\-\-copy\-dest=КАТАЛОГ      ... і включити копії незмінених файлів
\-\-link\-dest=КАТАЛОГ      створювати жорсткі посилання на файли у КАТАЛОЗІ, якщо не змінено
\-\-compress, \-z           стискати дані файла під час перенесення
\-\-compress\-choice=РЯДОК  вибрати алгоритм стискання (альтернатива \-\-zc)
\-\-compress\-level=ЧИСЛО   явно встановити рівень стискання (альтернатива \-\-zl)
\-\-skip\-compress=СПИСОК   пропустити стиснуті файли із суфіксом зі СПИСКУ
\-\-cvs\-exclude, \-C        автоматично ігнорувати файли у спосіб, який використано у CVS
\-\-filter=ПРАВИЛО, \-f     додати ПРАВИЛО фільтрування файлів
\-F                       те саме, що і \-\-filter='dir\-merge /.rsync\-filter'
                         повторно: \-\-filter='\- .rsync\-filter'
\-\-exclude=ВЗІРЕЦЬ        виключити файли, які відповідають ВЗІРЦЮ
\-\-exclude\-from=ФАЙЛ      прочитати взірці виключення з файла ФАЙЛ
\-\-include=ВЗІРЕЦЬ        не виключати файли, які відповідають ВЗІРЦЮ
\-\-include\-from=ФАЙЛ      прочитати взірці включення з файла ФАЙЛ
\-\-files\-from=ФАЙЛ        прочитати список назв файлів джерела з файла ФАЙЛ
\-\-from0, \-0              записи усіх файлів *\-from/filter відокремлено 0\-символами
\-\-old\-args               вимкнути сучасну ідіому захисту аргументів
\-\-protect\-args, \-s       без поділу пробілами; лише символи\-замінники
\-\-copy\-as=КОРИСТУВАЧ[:ГРУПА] вказати користувача і необов'язкову групу для копії
\-\-address=АДРЕСА         пов'язати адресу для вихідного сокета до фонової служби
\-\-port=ПОРТ              вказати альтернативний номер порту через подвійну двокрапку
\-\-sockopts=ПАРАМЕТРИ     вказати нетипові параметри TCP
\-\-blocking\-io            використати блокувальне введення\-виведення для віддаленої оболонки
\-\-outbuf=N|L|B           встановити буферизацію у None (немає), Line (рядок) або Block (блок)
\-\-stats                  надати деяку статистику передавання файлів
\-\-8\-bit\-output, \-8       лишити символи з верхніми бітами без екранування у виведенні
\-\-human\-readable, \-h     вивести числа у зручному для читання форматі
\-\-progress               показувати поступ під час перенесення
\-P                       те саме, що і \-\-partial \-\-progress
\-\-itemize\-changes, \-i    вивести резюме змін для усіх оновлень
\-\-remote\-option=ПАР, \-M  надіслати параметр ПАР лише на віддалений бік
\-\-out\-format=ФОРМАТ      вивести оновлення з використанням вказаного ФОРМАТУ
\-\-log\-file=ФАЙЛ          записати журнал дій до вказаного ФАЙЛА
\-\-log\-file\-format=ФОРМАТ записати оновлення за допомогою вказаного ФОРМАТУ
\-\-password\-file=ФАЙЛ     прочитати пароль доступу до фонової служби з файла ФАЙЛ
\-\-early\-input=ФАЙЛ       використати ФАЙЛ для раннього введення виконання фонової служби
\-\-list\-only              вивести список файлів замість їхнього копіювання
\-\-bwlimit=ШВИДКІСТЬ      обмежити ширину каналу введення\-виведення сокетом
\-\-stop\-after=ХВИЛИНИ     зупинити rsync після роботи протягом вказаної кількості ХВИЛИН
\-\-stop\-at=р\-м\-дTг:х      зупинити rsync у вказаний момент часу
\-\-fsync                  fsync для кожного записаного файла
\-\-write\-batch=ФАЙЛ       записувати пакетне оновлення до ФАЙЛ
\-\-only\-write\-batch=ФАЙЛ  подібне до \-\-write\-batch, але без оновлення призначення
\-\-read\-batch=ФАЙЛ        прочитати пакетне оновлення з ФАЙЛ
\-\-protocol=ЧИСЛО         примусово використати стару версію протоколу
\-\-iconv=СПЕЦ_ПЕРЕТВ      виконати перетворення наборів символів у назвах файлів
\-\-checksum\-seed=ЧИСЛО    встановити базу для контрольних сум блоків/файлів (додатково)
\-\-ipv4, \-4               пріоритет IPv4
\-\-ipv6, \-6               пріоритет IPv6
\-\-version, \-V            вивести дані щодо версії та іншого і завершити роботу
\-\-help, \-h (*)           показати цю довідку (* \-h, лише якщо він є єдиним параметром)
.fi
.P
Rsync також можна запустити як фонову службу. У цьому випадку прийнятними є
такі параметри:
.P
.nf
\-\-daemon                 запустити як фонову службу rsync
\-\-address=АДРЕСА         прив'язатися до вказаної адреси
\-\-bwlimit=ШВИДКІСТЬ      обмежити передавання сокетом
\-\-config=ФАЙЛ            вказати альтернативний файл rsyncd.conf
\-\-dparam=ПЕРЕВИЗНАЧЕННЯ, \-M перевизначити загальний параметр налаштування фонової служби
\-\-no\-detach              не від'єднуватися від батьківського процесу
\-\-port=ПОРТ              очікувати на дані на порті з альтернативним номером
\-\-log\-file=ФАЙЛ          перевизначити параметр «файл журналу»
\-\-log\-file\-format=ФОРМАТ перевизначити параметр «формат журналу»
\-\-sockopts=ПАРАМЕТРИ     вказати нетипові параметри TCP
\-\-verbose, \-v            збільшити докладність
\-\-ipv4, \-4               пріоритет IPv4
\-\-ipv6, \-6               пріоритет IPv6
\-\-help, \-h               показати цю довідку (при використанні з \-\-daemon)
.fi
.P
.SH ПАРАМЕТРИ
.P
Rsync приймає і довгі (подвійний дефіс + слово) і короткі (одинарний дефіс +
літера) параметри. Повний список доступних параметрів описано нижче. Якщо
параметр можна вказати у декілька способів, варіанти відокремлено комами. У
деяких параметрів є лише довгий варіант, але немає короткого. Якщо параметр
приймає аргумент, аргумент вказано після довгого варіанта, хоча його можна
також вказувати і після короткого. При визначенні параметра ви можете
скористатися або формою \fB\-\-параметр=аргумент\fP, або замінити «=»
пробілом. Аргумент може потребувати певного екранування, щоб його можна було
правильно розібрати після обробки командного рядка оболонкою. Слід
пам'ятати, що початкову тильду (\fB~\fP) у назві файла буде замінено вашою
командною оболонкою, отже, у \fB\-\-параметр=~/щось\fP тильду не буде замінено на
адресу вашого домашнього каталогу (для цього слід прибрати «=»).
.P
.IP \fB\-\-help\fP
Вивести коротку довідкову сторінку з описом параметрів, які доступні у
rsync, і завершити роботу. Ви також можете скористатися \fB\-h\fP замість
\fB\-\-help\fP, якщо параметр використано без інших параметрів (оскільки,
зазвичай, він означає \fB\-\-human\-readable\fP).
.IP "\fB\-\-version\fP, \fB\-V\fP"
Вивести дані щодо версії rsync та інші відомості і завершити роботу
програми.
.IP
Серед виведених даних буде типовий список алгоритмів обчислення контрольних
сум, типовий список алгоритмів стискання, список зібраних можливостей,
посилання на сайт rsync і деякі відомості щодо ліцензування та авторських
прав.
.IP "\fB\-\-verbose\fP, \fB\-v\fP"
Цей параметр збільшує обсяг відомостей, які буде надано під час передавання
даних. Типово, rsync працює без повідомлень. Одинарне \fB\-v\fP надасть вам
відомості щодо того, які файли передаються і коротке резюме наприкінці. Два
параметри \fB\-v\fP нададуть вам відомості щодо того, які файли пропущено і
трохи більше даних наприкінці. Більше, ніж два параметри \fB\-v\fP, слід
використовувати, лише якщо ви виконуєте діагностику rsync.
.IP
У кінцевому резюме програма повідомить вам про кількість надісланих байтів
до віддаленого rsync (який є боком отримання при локальному копіюванні),
кількість байтів, отриманих від віддаленого вузла і середню кількість байтів
переданих даних за секунду, обчислену за увесь час роботи rsync. У другому
рядку буде показано загальний розмір (у байтах) даних, який є сумою усіх
розмірів файлів, які rsync розглядала для передавання. Також буде показано
значення «пришвидшення», яким є відношення загального розміру файлів до суми
надісланих і отриманих байтів (тобто просто числовою оцінкою
«більше\-краще»). Зауважте, що ці значення у байтах можна зробити зручнішими
(або менш зручними) для читання за допомогою параметра \fB\-\-human\-readable\fP
(або \fB\-\-no\-human\-readable\fP).
.IP
У сучасних версіях rsync параметр \fB\-v\fP є еквівалентним до встановлення груп
для параметрів \fB\-\-info\fP і \fB\-\-debug\fP. Ви можете додатково скористатися цими
новішими параметрами на додачу до використання \fB\-\-verbose\fP або замість
нього, як і будь\-якими параметрами тонкого керування для перевизначення
неявно визначених параметрів \fB\-v\fP. Для обох параметрів, \fB\-\-info\fP і
\fB\-\-debug\fP, передбачено спосіб отримання довідкових даних щодо того, які
прапорці встановлено для кожного рівня докладності.
.IP
Втім, слід пам'ятати, що параметр «\fBмаксимальна докладність\fP» фонової
служби обмежить рівень різноманітних окремих прапорців, які може бути
встановлено на боці фонової служби. Наприклад, якщо максимумом є 2,
будь\-який прапорець відомостей і/або діагностики, який встановлено на вище
значення, чим встановлений параметром \fB\-vv\fP, буде знижено до рівня \fB\-vv\fP у
журналюванні фонової служби.
.IP \fB\-\-info=ПРАПОРЦІ\fP
Цей параметр надає у ваше розпорядження тонке керування над виведенням
відомостей, які ви хочете побачити. За назвою окремого прапорця може бути
вказано номер рівня. 0 означає «придушити виведення», 1 — типовий рівень
виведення, а більші значення збільшують докладність виведення для
відповідного прапорця (там, де передбачено підтримку вищих
рівнів). Скористайтеся \fB\-\-info=help\fP, щоб переглянути доступні назви
прапорців, дані, які буде виведено, якщо їх буде використано, і які назви
прапорців буде додано для кожного збільшення рівня докладності. Деякі
приклади:
.RS 4
.IP
.nf
rsync \-a \-\-info=progress2 джерело/ призначення/
rsync \-avv \-\-info=stats2,misc1,flist0 джерело/ призначення/
.fi
.RE
.IP
Зауважте, що на виведення \fB\-\-info=назва\fP впливатимуть параметри
\fB\-\-out\-format\fP і \fB\-\-itemize\-changes\fP (\fB\-i\fP). Див. ці параметри, щоб
дізнатися більше про те, що буде виведено, і коли.
.IP
Цей параметр було додано у версії 3.1.0, отже, у старіших версіях rsync на
боці сервера може бути відмовлено у ваших спробах точнішого налаштовування
(якщо потрібно надіслати на сервер один або декілька прапорців, а сервер є
надто старим, щоб зрозуміти їх). Див. також проблему із «\fBмаксимальною
докладністю\fP» вище при роботі з фоновою службою.
.IP \fB\-\-debug=ПРАПОРЦІ\fP
Цей параметр надає у ваше розпорядження тонке керування над виведенням
діагностичних даних, які ви хочете побачити. За назвою окремого прапорця
може бути вказано номер рівня. 0 означає «придушити виведення», 1 — типовий
рівень виведення, а більші значення збільшують докладність виведення для
відповідного прапорця (там, де передбачено підтримку вищих
рівнів). Скористайтеся \fB\-\-debug=help\fP, щоб переглянути доступні назви
прапорців, дані, які буде виведено, якщо їх буде використано, і які назви
прапорців буде додано для кожного збільшення рівня докладності. Деякі
приклади:
.RS 4
.IP
.nf
rsync \-avvv \-\-debug=none джерело/ призначення/
rsync \-avA \-\-del \-\-debug=del2,acl джерело/ призначення/
.fi
.RE
.IP
Зауважте, що деякі діагностичні повідомлення буде виведено, лише якщо
вказано параметр \fB\-\-stderr=all\fP, особливо повідомлення, які пов'язано із
введенням\-виведенням і діагностикою буфера.
.IP
Починаючи з версії 3.2.0, цей параметр більше не переспрямовується
автоматично на бік сервера з метою уможливити для вас визначення різних
діагностичних значень для обох боків передавання даних, а також вказати
новий параметр діагностики, який передбачено лише в одній з версій
rsync. Якщо ви хочете здублювати параметр на обох кінцях з'єднання,
використання розгортання фігурних дужок є простим способом заощадити деякий
час на введенні команд. Це працює у zsh і bash:
.RS 4
.IP
.nf
rsync \-aiv {\-M,}\-\-debug=del2 джерело/ призначення/
.fi
.RE
.IP \fB\-\-stderr=errors|all|client\fP
Цей параметр керує тим, які процеси виводитимуть дані до stderr, і чи буде
переспрямовано інформаційні повідомлення до stderr. Рядки режимів може бути
скорочено, тому можете скористатися однолітерним значенням. 3 можливими
варіантами є такі:
.IP
.RS
.IP o
\fBerrors\fP — (типовий варіант) наказує усім процесам rsync надсилати
повідомлення про помилки безпосередньо stderr, навіть якщо процес перебуває
на віддаленому боці передавання даних. Інформаційні повідомлення буде
надіслано на бік клієнта за допомогою потоку даних протоколу. Якщо stderr
виявиться недоступним (тобто недоступним на момент безпосереднього з'єднання
з фоновою службою за допомогою сокета), резервним місцем для повідомлень про
помилки буде потік даних протоколу.
.IP o
\fBall\fP — наказує записувати усі повідомлення rsync (інформаційні і
повідомлення про помилки) безпосередньо до stderr з усіх (можливих)
процесів. Це спричиняє буферизацію stderr за рядками (а не вимикання
будь\-якої обробки) і усуває можливість ділити інформаційні повідомлення та
повідомлення про помилки за дескриптором файла. Для тих, хто виконує
діагностику або використовує декілька рівнів докладності, цей параметр може
допомогти уникнути засмічування потоку даних передавання (це має запобігти
будь\-якому блокуванню усього потоку). Це також уможливлює вмикання за
допомогою \fB\-\-debug\fP деяких додаткових повідомлень, які пов'язано із
введенням\-виведенням.
.IP o
\fBclient\fP — наказує надсилати усі повідомлення rsync на бік клієнта за
допомогою потоку даних протоколу. Один клієнтський процес виводить усі
повідомлення із помилками до stderr, а інформаційні повідомлення — до
stdout. Це \fBбула\fP типова поведінка у застарілих версіях rsync. Втім, вона
могла спричиняти затримки у виведенні повідомлень про помилки, якщо
повідомленням передували значні блоки переданих даних. Якщо ви надсилаєте
файли до застарілої версії rsync, вам варто скористатися \fB\-\-stderr=all\fP,
оскільки ця ідіома вже використовується протягом низки випусків.
.RE
.IP
Цей варіант було додано у rsync 3.2.3. У цій версії також було розпочато
переспрямовування нетипових параметрів на віддалений бік з'єднання, хоча
rsync використовує зворотно сумісні параметри \fB\-\-msgs2stderr\fP і
\fB\-\-no\-msgs2stderr\fP для відтворення варіантів \fBall\fP і \fBclient\fP,
відповідно. Новіші версії rsync продовжуватимуть приймати ці старі назви
варіантів для забезпечення сумісності.
.IP "\fB\-\-quiet\fP, \fB\-q\fP"
Цей параметр зменшує обсяг відомостей, які буде надано під час передавання
даних, зокрема придушує надсилання інформаційних повідомлень з віддаленого
сервера. Цей параметр є корисним, якщо виклик rsync відбувається з cron.
.IP \fB\-\-no\-motd\fP
Цей параметр впливає на відомості, які буде виведено клієнтом на початку
передавання з використанням фонової служби. Він придушує виведення тексту
повідомлення дня (MOTD), а також вимикає виведення списку модулів, який
фонова служба надсилає у відповідь на запит «rsync host::» (через обмеження
протоколу rsync), тому не використовуйте цей параметр, якщо ви хочете
надіслати запит щодо списку модулів до фонової служби.
.IP "\fB\-\-ignore\-times\fP, \fB\-I\fP"
Зазвичай, rsync пропускає при передавання усі файли, які мають такий самий
розмір та ту саму часову позначку внесення змін. За допомогою цього
параметра можна вимкнути таку поведінку із «швидкою перевіркою» і наказати
програмі виконати оновлення усіх файлів.
.IP
Цей параметр можна сплутати з \fB\-\-ignore\-existing\fP і
\fB\-\-ignore\-non\-existing\fP, але вказані параметри зменшують кількість файлів,
які передає rsync, а цей параметр наказує rsync передати більше файлів.
.IP \fB\-\-size\-only\fP
Змінює алгоритм «швидкої перевірки» rsync для пошуку файлів, які має бути
передано, від типового перенесення файлів із зміненим розміром або часом
внесення змін до алгоритму, який шукає лише файли, розмір яких
змінено. Корисно, якщо ви розпочинаєте користування rsync після користування
іншою системою віддзеркалення даних, яка могла не зберігати точні часові
позначки файлів.
.IP "\fB\-\-modify\-window=NUM\fP, \fB\-@\fP"
При порівняння двох часових позначок rsync вважає позначки однаковими, якщо
вони відрізняються не більше, ніж на значення modify\-window. Типовим є
значення 0, що означає, що значення мають бути рівним із точністю до цілих
секунд. Якщо вами буде вказано від'ємне значення (і на боці отримувача даних
буде встановлено принаймні версію 3.1.3), буде враховано позначки з точністю
до наносекунд. Значення 1 може бути корисним для копіювання на файлові
системи FAT MS Windows та з таких файлових систем, оскільки FAT зберігає
часові дані з 2\-секундною точністю (тобто записи часу можуть відрізнятися
від початкових аж до 1 секунди).
.IP
Якщо вам потрібно, щоб під час усіх передавань даних типово порівняння
виконувалося із точністю до наносекунд, ви можете створити файл \fB~/.popt\fP і
записати до нього такі рядки:
.RS 4
.IP
.nf
rsync alias \-a \-a@\-1
rsync alias \-t \-t@\-1
.fi
.RE
.IP
Коли такі налаштування є типовими, вам слід вказати \fB\-\-modify\-window=0\fP
(або \fB\-@0\fP), щоб перевизначити їх і ігнорувати наносекунди, наприклад, якщо
копіювання відбувається між ext3 і ext4, або якщо rsync на боці отримувача є
старішим за 3.1.3.
.IP "\fB\-\-checksum\fP, \fB\-c\fP"
Змінює спосіб, у який rsync перевіряє, чи було змінено файли і чи слід
переносити їхні дані. Без цього параметра rsync використовує «швидку
перевірку», тобто (типово) перевіряє, чи збігається розмір і час останнього
внесення змін на боці відправника і отримувача. За допомогою цього параметра
можна змінити перевірку на порівняння 128\-бітових контрольних сум для
кожного файлів та рівності розмірів файлів. Створення контрольних сум
потребуватиме на обох кінцях з'єднання значних потоків введення\-виведення
для читання усіх даних файлів, які буде передано, отже значно уповільнить
процедуру (читання буде виконано до читання даних для передавання змінених
файлів).
.IP
На боці надсилання створення контрольних сум буде виконано під час
сканування файлової системи для побудови списку доступних файлів. На боці
отримувача контрольні суми буде створено під час пошуку змінених файлів —
контрольні суми буде створено для файлів, розмір яких збігається із
відповідними файлами на боці відправника — для перенесення буде вибрано
файли, розмір або контрольна сума яких є різними на кінцях з'єднання.
.IP
Зауважте, що rsync завжди перевіряє, чи правильно \fIперенесений\fP файл було
відтворено на боці отримувача шляхом перевірки контрольної суми усього
файла, яку буде створено після перенесення файла, але цю автоматичну
перевірку після перенесення ніяким чином не пов'язано із цією перевіркою до
перенесення з метою відповісти на питання «Чи має бути оновлено той чи інший
файл?».
.IP
Контрольну суму буде використано під час автоматичного узгодження між
клієнтом та сервером, але таку поведінку може бути перевизначено за
допомогою або параметра \fB\-\-checksum\-choice\fP (\fB\-\-cc\fP) або змінної
середовища, обговорення щодо якої наведено у розділі щодо відповідного
параметра.
.IP "\fB\-\-archive\fP, \fB\-a\fP"
Еквівалент \fB\-rlptgoD\fP. Це швидкий спосіб вказати, що вам потрібна рекурсія,
і ви хочете зберегти майже усе. Зауважте, що це \fBне\fP стосується збереження
ACL (\fB\-A\fP), xattr (\fB\-X\fP), atime (\fB\-U\fP), crtime (\fB\-N\fP), а також пошуку і
збереження жорстких посилань (\fB\-H\fP).
.IP
Єдиними виключенням із наведеної вище еквівалентності є визначення
\fB\-\-files\-from\fP, яке не встановлює неявним чином \fB\-r\fP.
.IP \fB\-\-no\-ПАРАМЕТР\fP
Ви можете вимкнути один або декілька неявно заданих параметрів, додавши до
назви параметра префікс «no\-». Негативні варіанти є не в усіх параметрів,
але у багатьох є, включно з тими, якими можна скористатися для вимикання
неявно заданих параметрів (наприклад, \fB\-\-no\-D\fP, \fB\-\-no\-perms\fP) або
встановлення інших типових значень за різних обставин (наприклад,
\fB\-\-no\-whole\-file\fP, \fB\-\-no\-blocking\-io\fP, \fB\-\-no\-dirs\fP). Кожен коректний
негативний параметр можна використати для короткої і довгої версії назви
після префікса «no\-» (наприклад, \fB\-\-no\-R\fP є тим самим, що і
\fB\-\-no\-relative\fP).
.IP
Наприклад, якщо ви хочете скористатися \fB\-\-archive\fP (\fB\-a\fP), але не хочете
\fB\-\-owner\fP (\fB\-o\fP), замість перетворення \fB\-a\fP на \fB\-rlptgD\fP, ви можете
вказати \fB\-a\ \-\-no\-o\fP (або \fB\-\-archive\ \-\-no\-owner\fP).
.IP
Порядок параметрів є важливим: якщо ви вкажете \fB\-\-no\-r\ \-a\fP, параметр \fB\-r\fP
буде увімкнено, і навпаки, якщо вказати \fB\-a\ \-\-no\-r\fP. Зауважте також, що
побіжні результати застосування параметра \fB\-\-files\-from\fP НЕ є позиційними,
оскільки параметр змінює типовий стан декількох параметрів і дещо змінює
значення \fB\-a\fP (див. параметр \fB\-\-files\-from\fP, щоб дізнатися більше).
.IP "\fB\-\-recursive\fP, \fB\-r\fP"
Наказує rsync копіювати каталоги рекурсивно. Див. також \fB\-\-dirs\fP (\fB\-d\fP),
щоб дізнатися про параметр, який уможливлює сканування окремого каталогу.
.IP
Див. опис параметра \fB\-\-inc\-recursive\fP, де наведено обговорення
нарощувальної рекурсії для створення списку файлів для передавання.
.IP "\fB\-\-inc\-recursive\fP, \fB\-\-i\-r\fP"
Цей параметр явним чином вмикає нарощувальну рекурсію при пошуку
файлів. Таку рекурсію буде типово увімкнено, якщо використано параметр
\fB\-\-recursive\fP і на обох кінцях з'єднання запущено rsync 3.0.0 або новішу
версію.
.IP
Для нарощувальної рекурсії буде використано набагато менше пам'яті, ніж для
ненарощувальної, а передавання буде розпочато швидше (оскільки є непотрібним
сканування усіх ієрархії передавання до того, як буде розпочато передавання
файлів). Якщо рекурсію не увімкнено для файлів джерела, цей параметр ні на
що не вплине.
.IP
Для використання деяких параметрів потрібно, щоб rsync був відомим повний
список файлів, тому використання цих параметрів призводить до вимикання
режиму нарощувальної рекурсії. Серед цих параметрів такі:
.IP
.RS
.IP o
\fB\-\-delete\-before\fP (старе типове значення \fB\-\-delete\fP)
.IP o
\fB\-\-delete\-after\fP
.IP o
\fB\-\-prune\-empty\-dirs\fP
.IP o
\fB\-\-delay\-updates\fP
.RE
.IP
Щоб зробити \fB\-\-delete\fP сумісним із нарощувальною рекурсією, у rsync 3.0.0
типовим режимом вилучення зроблено \fB\-\-delete\-during\fP (цей режим було вперше
додано у 2.6.4).
.IP
Одним із побіжних результатів нарощувальної рекурсії є те, що будь\-які
підкаталоги у рекурсивно сканованого каталогу, яких не вистачає, буде
(типово) створено до рекурсивного переходу підкаталогами. Ця рання позиція
створення (порівняно із ненарощувальною рекурсією) дозволяє rsync потім
одразу встановити час внесення змін для завершеного каталогу (без чекання,
Доки буде завершено пакет дій з рекурсивного копіювання). Втім, ці
попередньо створені каталоги ще не матимуть завершеного встановленого режиму
доступу, позначки часу внесення змін та прав власності\ \-\- для них буде
встановлено жорсткіші права доступу до того, як розпочнеться справжнє
копіювання. Цієї ідіоми раннього створення можна уникнути використанням
параметра \fB\-\-omit\-dir\-times\fP.
.IP
Нарощувальну рекурсію можна вимкнути за допомогою параметра
\fB\-\-no\-inc\-recursive\fP (\fB\-\-no\-i\-r\fP).
.IP "\fB\-\-no\-inc\-recursive\fP, \fB\-\-no\-i\-r\fP"
Вимикає новий алгоритм нарощувальної рекурсії параметра
\fB\-\-recursive\fP. Наказує rsync сканувати повний список файлів до того, як
програма розпочне переносити файли. Див. \fB\-\-inc\-recursive\fP, щоб дізнатися
більше.
.IP "\fB\-\-relative\fP, \fB\-R\fP"
Використовувати відносні шляхи. Це означає, що повні шляхи, які вказано у
рядку команди, буде надіслано на сервер замість простого надсилання останніх
частин назв файлів. Це, зокрема, корисно, якщо ви хочете надіслати декілька
різних каталогів одночасно. Наприклад, якщо ви використали таку команду:
.RS 4
.IP
.nf
rsync \-av /щось/десь/там.c remote:/tmp/
.fi
.RE
.IP
створить файл із назвою там.c у /tmp/ на віддаленому комп'ютері. Якщо ж ви
скористаєтеся таким:
.RS 4
.IP
.nf
rsync \-avR /щось/десь/там.c remote:/tmp/
.fi
.RE
.IP
на віддаленому комп'ютері буде створено файл із назвою /tmp/щось/десь/там.c
зі збереженням його повного шляху. Ці додаткові елементи шляху називають
«неявними каталогами» (тобто каталоги «щось» і «щось/десь» у наведеному вище
прикладі).
.IP
Починаючи з версії rsync 3.0.0, rsync завжди надсилає ці неявні каталоги як
справжні каталоги у списку файлів, навіть якщо елемент шляху є насправді
символічним посиланням на боці відправника. Це запобігає небажаним
результатам при копіюванні повного шляху до файла, для якого не було
встановлено наявність символічного посилання у шляху. Якщо ви хочете
здублювати символічне посилання на боці сервера, включіть символічне
посилання на основі його шляху і каталог, на яке воно посилається, на основі
справжнього шляху до нього. Якщо ви маєте справу із застарілою версією rsync
на боці відправника, ймовірно, вам доведеться скористатися параметром
\fB\-\-no\-implied\-dirs\fP.
.IP
Також можна обмежити обсяг даних щодо шляху, які буде надіслано як неявні
каталоги для кожного вказаного вами шляху. Для сучасних версій rsync на боці
відправника (починаючи з 2.6.7), ви можете вставити крапку і символ похилої
риски до шляху джерела, ось так:
.RS 4
.IP
.nf
rsync \-avR /щось/./десь/там.c remote:/tmp/
.fi
.RE
.IP
У результаті буде створено /tmp/десь/там.c на віддаленому
комп'ютері. (Зауважте, що після крапки має бути символ похилої риски, отже
«/щось/.» не буде скорочено.) Для застарілих версій rsync, вам доведеться
скористатися chdir для обмеження шляху джерела. Наприклад, при надсиланні
файлів:
.RS 4
.IP
.nf
(cd /десь; rsync \-avR щось/там.c remote:/tmp/)
.fi
.RE
.IP
(Зауважте, що круглі дужки надсилають дві команди до підоболонки, тому
наслідки команди «cd» не стосуються наступних команд.) Якщо ви отримуєте
файли зі старіших версій rsync, користуйтеся такою синтаксичною конструкцією
(але лише для передавання даних без фонової служби):
.RS 4
.IP
.nf
rsync \-avR \-\-rsync\-path="cd /десь; rsync" \e
     remote:щось/там.c /tmp/
.fi
.RE
.IP \fB\-\-no\-implied\-dirs\fP
Цей параметр впливає на типову поведінку параметра \fB\-\-relative\fP. Якщо його
вказано, атрибути неявних каталогів з назв джерела не буде включено до
передавання. Це означає, що відповідні елементи шляху у системі призначення
лишаються незмінними, якщо вони існують, і усі пропущені неявні каталоги
буде створено із типовими атрибутами. Це навіть уможливлює більші
відмінності у цих елементах неявних шляхів, зокрема символічні посилання на
каталоги на боці отримувача.
.IP
Наприклад, якщо аргумент рядка команди або запис походження файлів наказують
rsync перенести файл «шлях/щось/файл», каталоги «шлях» і «шлях/десь» буде
неявним чином використано, якщо використано \fB\-\-relative\fP. Якщо «шлях/щось»
є символічним посиланням на «десь» у системі призначення, rsync отримання,
зазвичай, вилучить «шлях/щось», повторно створить його як каталог і отримає
файл до нового каталогу. З \fB\-\-no\-implied\-dirs\fP rsync отримувача оновить
«шлях/щось/файл» з використанням наявних елементів шляху, тобто файл буде
створено у «шлях/десь». Іншим способом досягти такого збереження посилань є
використання параметра \fB\-\-keep\-dirlinks\fP (який також вплине на символічні
посилання на каталоги у решті масиву передавання даних).
.IP
При отриманні файлів з rsync, який є старішим за 3.0.0, вам варто
скористатися цим параметром, якщо з боку відправника є символічне посилання
на потрібний вам шлях, і ви хочете перенести неявні каталоги, як звичайні
каталоги.
.IP "\fB\-\-backup\fP, \fB\-b\fP"
У разі використання цього параметра програма перейменовуватиме початкові
файли у каталогах призначення, які згодом буде оновлено або
вилучено. Керувати місцем зберігання початкових файлів та додаванням до їх
назв суфікса (якщо такий слід додавати) можна за допомогою параметрів the
\fB\-\-backup\-dir\fP і \fB\-\-suffix\fP.
.IP
Якщо ви не вкажете \fB\-\-backup\-dir\fP:
.RS
.IP
.IP 1.
параметр \fB\-\-omit\-dir\-times\fP буде примусово увімкнено
.IP 2.
використання \fB\-\-delete\fP (без \fB\-\-delete\-excluded\fP) наказує rsync додати
правило фільтрування «захистити» для суфікса резервної копії наприкінці усіх
ваших наявних фільтрів, який виглядає десь так: \fB\-f\ "P\ *~"\fP. Це правило
запобігає вилученню файлів, для яких раніше було створено резервні копії.
.RE
.IP
Зауважте, що якщо ви надаєте програмі власні правила фільтрування, вам,
можливо, слід вручну вставити ваше власне правило виключення/захисту десь
вище у списку, щоб воно мало достатньо високу пріоритетність, щоб бути
працездатним (наприклад, якщо ваші правила визначають кінцеве
включення/виключення \fB*\fP, програма ніколи не дістанеться правила
автоматичного додавання).
.IP \fB\-\-backup\-dir=КАТАЛОГ\fP
Неявним чином встановлює параметр \fB\-\-backup\fP і наказує rsync зберегти усі
резервні копії у вказаному каталозі на боці отримання. Цим можна
скористатися для створення нарощувальних резервних копій. Крім того, ви
можете вказати суфікс назв файлів резервних копій за допомогою параметра
\fB\-\-suffix\fP (якщо цього не зробити, резервні копії у вказаному каталозі
матимуть ті самі назви, що і початкові файли).
.IP
Зауважте, що якщо ви вкажете відносний шлях, каталог резервних копій буде
визначено відносно каталогу призначення, тому, ймовірно, вам варто вказати
або абсолютний шлях, або шлях, який починається з «../». Якщо отримувачем є
фонова служба rsync, каталог резервних копій не може перебувати поза
ієрархією шляхів модуля, тому будьте особливо уважні — не вилучайте його і
не копіюйте до нього дані.
.IP \fB\-\-suffix=СУФІКС\fP
За допомогою цього параметра ви можете перевизначити типовий суфікс назв
резервних копій, який буде використано для команди з параметром \fB\-\-backup\fP
(\fB\-b\fP). Типовим суфіксом, якщо не вказано параметра \fB\-\-backup\-dir\fP, буде
\fB~\fP, якщо ж цей параметр буде вказано, програма використовуватиме порожній
рядок.
.IP "\fB\-\-update\fP, \fB\-u\fP"
За допомогою цього параметра можна наказати rsync пропускати всі файли у
каталозі призначення, які позначено часом зміни, новішим за час зміни файла
джерела. Якщо наявний файл призначення матиме часову позначку зміни, рівну
часовій позначці зміни файла джерела, його буде оновлено за умови
відмінності у розмірах файлів.
.IP
Зауважте, що цей не стосується копіювання каталогів, символічних посилань
або інших особливих файлів. Крім того, відмінність у форматах файлів між
відправником та отримувачем завжди вважається достатньо важливою для
оновлення, незалежно від датування об'єктів. Іншими словами, якщо у джерелі
маємо каталог там, де у призначенні маємо файл, передавання даних буде
здійснено незалежно від часових позначок.
.IP
Цей параметр є правилом передавання, а не виключення, тому він не впливає на
дані, які потрапляють до списків файлів, а отже, не впливає на
вилучення. Він просто обмежує перелік файлів, на які отримувач надішле запит
щодо передавання.
.IP
Попередження для тих, хто поєднує \fB\-\-inplace\fP з \fB\-\-update\fP: перерване
передавання даних лишить по собі частковий файл на боці отримувача із досить
свіжим часом внесення змін, тому повторний запуск передавання, ймовірно,
\fBне\fP продовжиться на перерваному файлі. Ось чому, зазвичай, варто уникати
поєднання цього параметра з \fB\-\-inplace\fP, якщо вами не реалізовано вручну
обробку сценаріїв роботи із будь\-якими файлами, передавання яких було
перервано.
.IP \fB\-\-inplace\fP
Цей параметр змінює спосіб, у який rsync передаватиме файл, якщо дані у
ньому слід оновити: замість типового способу створення нової копії файла і
пересування її на місце при завершенні передавання, rsync записуватиме
оновлені дані безпосередньо до файла призначення.
.IP
Результатів буде декілька:
.IP
.RS
.IP o
Жорсткі посилання не буде пошкоджено. Це означає, що нові дані будуть
видимими через інші жорсткі посилання на файл призначення. Більше того,
спроби копіювання відмінних файлів джерела до файла призначення із
декількома посиланнями призведуть до «перетягування канату» зі зміною даних
призначення вперед і назад.
.IP o
Виконувані файли, які перебувають у використанні, не можна буде оновити
(цьому запобігатиме або операційна система, або виконувані файли, які
намагатимуться створити резервну копію даних на диску, поводитимуться
нештатно і завершуватимуть роботу в аварійному режимі).
.IP o
Під час передавання даних дані файла перебуватимуть у неузгодженому стані і
лишатимуться у такому стані, якщо передавання буде перервано або оновлення
зазнає невдачі.
.IP o
Файл, до якого не може записати дані rsync, не можна оновити. Надкористувач
може оновлювати будь\-які файли, а ось звичайному користувачеві має бути
надано доступ до запису для того, щоб відкриття файла для запису було
успішним.
.IP o
Ефективність алгоритму дельта\-передавання rsync може знизитися, якщо деякі
дані у файлів призначення буде перезаписано до того, як їх можна буде
скопіювати до позиції далі у файлі. Це не стосується випадку, коли ви
використовуєте \fB\-\-backup\fP, оскільки rsync є достатньо кмітливим, щоб
скористатися файлом резервної копії як базовим файлом для передавання даних.
.RE
.IP
УВАГА! Не слід користуватися цим параметром для оновлення файлів, доступ до
яких здійснюють інші користувачі. Отже, будьте уважні при використанні цього
параметра для копіювання.
.IP
Цей параметр є корисним для передавання великих файлів із змінами на основі
блоків або дописування даних, а також у системах, які обмежені за
параметрами дисків, а не мережі. Він також може допомогти у створенні знімка
файлової системи з копіюванням при записі: не треба буде копіювати увесь
вміст файла, зміни у якому є незначними.
.IP
Параметр неявним чином встановлює \fB\-\-partial\fP (оскільки при частковому
передаванні файл не буде вилучено), але конфліктує із параметрами
\fB\-\-partial\-dir\fP і \fB\-\-delay\-updates\fP. До версії rsync 2.6.4 \fB\-\-inplace\fP
параметр був несумісним із параметрами \fB\-\-compare\-dest\fP і \fB\-\-link\-dest\fP.
.IP \fB\-\-append\fP
Цей особливий режим копіювання ефективно працює лише для оновлення файлів,
розмір яких збільшується з часом, там, де усі наявні дані на боці отримувача
завжди є і на боці відправника. Використання \fB\-\-append\fP \fBможе бути
небезпечним\fP, якщо немає 100% гарантії, що усі файли у передаванні є
спільними і розміри їх зростають із часом. Через це, вам слід скористатися
правилами фільтрування, щоб усунути з передавання усі файли, які не
відповідають цим критеріям.
.IP
Rsync виконує оновлення таких файлів, розмір яких збільшується, без
перевірки наявного вмісту файла (виконує перевірку лише даних, які слід
дописати). Rsync пропускатиме усі файли на боці отримувача, які не є меншими
за відповідні файли на боці відправника (це означає, що нові файли буде
передано). Також буде пропущено файли, чий розмір зменшуватиметься під час
узгодження надсилання (rsync попередить про «зменшений» файл, якщо таке
трапиться).
.IP
Цей параметр не заважатиме оновленню не пов'язаних із вмістом атрибутів
файлів (наприклад, прав доступу, прав власності тощо), якщо дані файла не
потрібно передавати. Також він не стосується оновлення каталогів або файлів,
які є особливими.
.IP \fB\-\-append\-verify\fP
Цей особливий режим копіювання працює подібно до режиму \fB\-\-append\fP, але для
обчислення контрольної суми буде використано усі дані у файлі (це робить
його менш ефективним, але, потенційно, безпечнішим). Використання цього
параметра \fBможе бути небезпечним\fP, якщо немає 100% гарантії, що розмір усіх
файлів, дані яких буде передано, зростає. Див. параметр \fB\-\-append\fP, щоб
дізнатися більше.
.IP
Зауваження: до версії rsync 3.0.0 параметр \fB\-\-append\fP працював як
\fB\-\-append\-verify\fP, тому якщо ви працюєте із застарілою версією rsync (або
під час передавання використано протокол до версії 30), використання
будь\-якого з цих параметрів призведе до започаткування передавання даних у
режимі \fB\-\-append\-verify\fP.
.IP "\fB\-\-dirs\fP, \fB\-d\fP"
Наказати включити на боці надсилання усі знайдені каталоги. На відміну від
\fB\-\-recursive\fP, вміст каталогів скопійовано не буде, якщо назву каталогу не
вказано як «.» або назва не завершується символом похилої риски (наприклад,
«.», «каталог/.», «каталог/» тощо). Без цього параметра або параметра
\fB\-\-recursive\fP rsync пропустить усі каталоги, які буде знайдено (і виведе
повідомлення про вплив на кожен запис). Якщо ви вкажете одразу \fB\-\-dirs\fP і
\fB\-\-recursive\fP, перевагу буде надано \fB\-\-recursive\fP.
.IP
Параметр \fB\-\-dirs\fP неявним чином встановлюється параметр \fB\-\-files\-from\fP або
параметр \fB\-\-list\-only\fP (разом із неявним використанням \fB\-\-list\-only\fP),
якщо не вказано \fB\-\-recursive\fP (отже каталоги видно у списку). Вкажіть
\fB\-\-no\-dirs\fP (або \fB\-\-no\-d\fP), якщо ви хочете вимкнути цю поведінку.
.IP
Також передбачено допоміжний параметр для забезпечення зворотної сумісності,
\fB\-\-old\-dirs\fP (\fB\-\-old\-d\fP). Він наказує rsync скористатися \fB\-r\ \-\-exclude='/*/*'\fP для отримання списку вмісту окремого каталогу без
рекурсії, як у старому rsync.
.IP \fB\-\-mkpath\fP
Створити пропущену частину компоненти шляху в аргументі призначення. Це
уможливлює для rsync створення декількох рівнів пропущених каталогів
призначення і створення шляху, за яким слід зберегти окремий перейменований
файл. Пам'ятайте, що вам слід вказати кінцевий символ похилої риски, якщо
хочете, щоб програма вважала шлях каталогом при копіюванні одинарного
аргументу (наказавши rsync поводитися так само, як програма поводилася б,
якщо б компонент шляху призначення вже існував).
.IP
Наприклад, вказана нижче команда створить копію файла «щось» як «десь» у
каталозі «під/каталог», створивши каталоги «під» і «під/каталог», якщо
якогось із них ще не існує:
.RS 4
.IP
.nf
rsync \-ai \-\-mkpath щось під/каталог/десь
.fi
.RE
.IP
Якщо ж ви замість цієї команди скористаєтеся наступною командою, буде
створено файл «щось» у каталозі «під/каталог/десь»:
.RS 4
.IP
.nf
rsync \-ai \-\-mkpath щось під/каталог/десь/
.fi
.RE
.IP "\fB\-\-links\fP, \fB\-l\fP"
Додати символічні посилання до переданих файлів замість ігнорування цих
файлів з повідомленням «не є звичайним файлом» для кожного знайденого
символічного посилання. Ви також можете придушити попередження за допомогою
параметра \fB\-\-info=nonreg0\fP.
.IP
Типовою обробкою символічних посилань передбачено повторне створення кожного
незмінного значення символічного посилання на боці отримувача.
.IP
Див. розділ СИМВОЛІЧНІ ПОСИЛАННЯ, щоб дізнатися більше про поєднання
параметрів.
.IP "\fB\-\-copy\-links\fP, \fB\-L\fP"
Відправник перетворює кожне знайдене символічне посилання на запис, на який
це посилання посилається, переходячи ланцюжком символічних посилань до файла
або каталогу, на які воно посилається. Якщо ланцюжок символічних посилань
пошкоджено, буде виведено повідомлення про помилку, а відповідний файл
виключено з передавання.
.IP
Цей параметр перевизначає значення усіх інших параметрів, які стосуються
символічних посилань у передаванні даних, оскільки у даних, які буде
передано, вже не буде символічних посилань.
.IP
Цей параметр не змінює обробку наявних символічних посилань на боці
отримувача, на відміну від версій rsync до 2.6.3, у яких його використання
мало побіжний ефект, який полягав у тому, що програма переходила за
символічними посиланнями і на боці отримувача. Сучасні версії rsync не
передають цей параметр на віддалені отримувачі (оскільки про нього має знати
лише відправник), тому ця проблема може виникнути лише у тих, хто
користується клієнтом rsync версії, старішої за 2.6.7 (версії, коли \fB\-L\fP
перестали передавати на бік отримувача).
.IP
Див. \fB\-\-keep\-dirlinks\fP (\fB\-K\fP), якщо вам потрібне, щоб символічне посилання
на каталог було оброблено як справжній каталог на боці отримання.
.IP
Див. розділ СИМВОЛІЧНІ ПОСИЛАННЯ, щоб дізнатися більше про поєднання
параметрів.
.IP \fB\-\-copy\-unsafe\-links\fP
Наказує rsync копіювати те, на що посилається символічне посилання, якщо
об'єкт посилання перебуває поза ієрархією копіювання. Абсолютні символічні
посилання також вважаються звичайними файлами, так само, як усі посилання у
самому шляху джерела, якщо використано \fB\-\-relative\fP.
.IP
Зауважте, що точку обрізання розташовано на верхній позиції передавання,
тобто частині шляху, яку rsync не згадує у докладних повідомленнях. Якщо ви
скопіюєте «/джерело/підкаталог» до «/призначення/» каталог «підкаталог» буде
назвою усередині ієрархії передавання, а не на верхній позиції передавання
(тобто у /джерело), тому для створених символічних посилань буде коректним
посилатися на інші об'єкти всередині каталогів /джерело і /призначення. Якщо
ж ви скопіюєте «/джерело/підкаталог/» (із кінцевою похилою рискою) до
«/призначення/підкаталог», символічні посилання на будь\-які файли поза
«підкаталог» будуть некоректними.
.IP
Зауважте, що безпечні символічні посилання буде скопійовано, лише якщо було
вказано явно чи неявно \fB\-\-links\fP. Параметр \fB\-\-copy\-unsafe\-links\fP не матиме
додаткового впливу на обробку, якщо його поєднати із \fB\-\-copy\-links\fP.
.IP
Див. розділ СИМВОЛІЧНІ ПОСИЛАННЯ, щоб дізнатися більше про поєднання
параметрів.
.IP \fB\-\-safe\-links\fP
За допомогою цього параметра можна наказати rsync на боці отримання даних
ігнорувати всі символічні посилання у межах ієрархії тек, яка
копіюється. Всі абсолютні символічні посилання буде також проігноровано.
.IP
Оскільки це ігнорування відбуватиметься на боці отримання, воно діятиме,
навіть якщо на боці надсилання є зіпсовані символічні посилання (коли
використано \fB\-\-munge\-links\fP). Також це вплине на вилучення, оскільки
наявність файл у списку передавання запобігає вилученню будь\-якого
відповідного файла на боці отримувача, якщо символічне посилання визнано
небезпечним і пропущено.
.IP
Цей параметр має бути поєднано з \fB\-\-links\fP (або \fB\-\-archive\fP), щоб якісь
символічні посилання при передаванні було умовно проігноровано. Його
результат буде перевизначено \fB\-\-copy\-unsafe\-links\fP.
.IP
Використання цього параметра разом з параметром \fB\-\-relative\fP може призвести
до небажаних результатів.
.IP
Див. розділ СИМВОЛІЧНІ ПОСИЛАННЯ, щоб дізнатися більше про поєднання
параметрів.
.IP \fB\-\-munge\-links\fP
Цей параметр стосується лише одного кінця передавання і наказує rsync
зіпсувати значення символічних посилань при отриманні файлів або відновити
значення символічних посилань при надсиланні файлів. Зіпсовані значення
зроблять символічні посилання непридатними на диску, але уможливлять
відновлення початкового вмісту символічних посилань.
.IP
Rsync на боці сервера часто вмикає цей параметр без додаткового повідомлення
для клієнта, подібно до використання параметра у файлі налаштувань фонової
служби rsync або параметра, який передано у скрипті rrsync (обмеженого
rsync). Якщо параметр вказано на боці клієнта, вказуйте його, якщо на
клієнтському боці є/потрібні зіпсовані символічні посилання, або
скористайтеся \fB\-M\-\-munge\-links\fP, щоб передати парметр на сервер, якщо той
має/потребує зіпсованих символічних посилань. Зауважте, що при локальному
копіюванні клієнт є відправником, тому задання параметра безпосередньо
скасовує псування символічних посилань, а задання його, як віддаленого
параметра, псує символічні посилання.
.IP
Цей параметр ні на що не вплине, якщо надіслати його до фонової служби за
допомогою \fB\-\-remote\-option\fP, оскільки фонову службу налаштовують на те, чи
бажаними є зіпсовані посилання, за допомогою її параметра «\fBmunge\ symlinks\fP».
.IP
Значення символічного посилання буде зіпсовано/відновлено, щойно воно
потрапить до передавання, тому будь\-який параметр, який перетворює
символічні посилання на щось, що не є символічним посиланням, має передувати
псуванню/відновленню, \fBокрім\fP параметра \fB\-\-safe\-links\fP, значення якого є
вибором отримувача, на якому буде засновано рішення щодо псування або
відновлення. Це означає, що якщо для отримувача увімкнено псування,
використання \fB\-\-safe\-links\fP призведе до ігнорування усіх символічних
посилань (оскільки усі вони будуть абсолютними).
.IP
Спосіб, у який rsync виконує псування символічних посилань, полягає у
дописуванні до кожного значення префікса «/rsyncd\-munged/». Це заважає
використанню посилань, якщо каталогу не існує. Якщо цей параметр увімкнено,
rsync відмовиться запускатися, якщо шлях є каталогом або символічним
посиланням на каталог (хоча перевірка цього виконуватиметься лише під час
запуску програми). Див. також скрипт мовою Python «munge\-symlinks» у
каталозі «support» початкового коду, щоб дізнатися більше про спосіб
псування/відновлення одного або декількох посилань на місці.
.IP "\fB\-\-copy\-dirlinks\fP, \fB\-k\fP"
Позначення цього пункту призведе до того, що програма оброблятиме символічні
посилання на каталоги на боці надсилання даних так, наче ці посилання є
справжніми каталогами Це корисно, якщо вам потрібно, щоб символічні
посилання на об'єкти, відмінні від каталогів, не було змінено так, як це
було б зроблено унаслідок використання \fB\-\-copy\-links\fP.
.IP
Без цього параметра, якщо на боці надсилання каталог було замінено
символічним посиланням на каталог, на боці отримання буде вилучено усе, що
стоїть на заваді новому символічному посиланню, включно із ієрархією
каталогів (якщо працюють \fB\-\-force\fP або \fB\-\-delete\fP).
.IP
Див. також \fB\-\-keep\-dirlinks\fP щодо аналогічного параметра на боці отримання.
.IP
\fB\-\-copy\-dirlinks\fP застосовується до усіх символічних посилань на каталоги у
джерелі. Якщо ви хочете, щоб програма переходила лише за декількома
вказаними символічними посиланнями, ви можете передати їх, як додаткові
аргументи джерела із кінцевим символом похилої риски, за допомогою параметра
\fB\-\-relative\fP, щоб встановити належну відповідність шляхів. Приклад:
.RS 4
.IP
.nf
rsync \-r \-\-relative джерело/./ джерело/./перейди\-за\-мною/ призначення/
.fi
.RE
.IP
Це працює, бо rsync викликає \fBlstat\fP(2) для аргументу джерела, як його
задано, а кінцевий символ похилої риски наказує \fBlstat\fP(2) перейти за
символічним посиланням, піднімаючи каталог у списку файлів і перевизначаючи
символічне посилання, яке буде виявлено під час сканування «джерело/./».
.IP
Див. розділ СИМВОЛІЧНІ ПОСИЛАННЯ, щоб дізнатися більше про поєднання
параметрів.
.IP "\fB\-\-keep\-dirlinks\fP, \fB\-K\fP"
Позначення цього пункту призведе до того, що програма оброблятиме символічні
посилання на каталоги на стороні отримання даних так, наче ці посилання є
справжніми каталогами. Цей параметр працюватиме, лише якщо символічне
посилання відповідає справжньому каталогу на стороні надсилання. Якщо
параметр не буде використано, символічне посилання на стороні отримання
даних буде вилучено і замінено справжнім каталогом.
.IP
Наприклад, припустімо, що ви передаєте каталог «щось», який містить файл
«файл», але «щось» є символічним посиланням на каталог «десь» на боці
отримувача. Без \fB\-\-keep\-dirlinks\fP на боці отримувача буде вилучено
символічне посилання «щось» і повторно створено його як каталог, а потім
отримано файл до нового каталогу. З \fB\-\-keep\-dirlinks\fP на боці отримувача
символічне посилання буде збережено, а «файл» буде записано до «десь».
.IP
Одне попередження: якщо ви користуєтеся \fB\-\-keep\-dirlinks\fP, вам слід або
довіритися усім символічним посиланням у копії, або увімкнути параметр
\fB\-\-munge\-links\fP на боці отримувача! Якщо недовірений користувач матиме
змогу створювати власні символічні посилання на будь\-який справжній каталог,
цей користувач потім зможе (при наступному копіюванні) замінити символічне
посилання справжнім каталогом і вплинути на вміст будь\-якого каталогу, на
який посилається символічне посилання. Для резервного копіювання вам краще
не користуватися чимось подібним до пов'язувального монтування, замість
символічного посилання, для внесення змін до вашої ієрархії отримання днаих.
.IP
Див. також \fB\-\-copy\-dirlinks\fP щодо аналогічного параметра на боці
надсилання.
.IP
Див. розділ СИМВОЛІЧНІ ПОСИЛАННЯ, щоб дізнатися більше про поєднання
параметрів.
.IP "\fB\-\-hard\-links\fP, \fB\-H\fP"
За допомогою цього пункту можна наказати rsync виявляти жорсткі посилання у
джерелі і створювати відповідні жорсткі посилання на боці призначення. Якщо
цей пункт не буде позначено, обробка жорстко пов'язаних файлів джерела
відбуватиметься так, наче ці файли є окремими файлами.
.IP
Цей параметр НЕ обов'язково забезпечує точну відповідність взірця жорстких
посилань у призначенні жорстким посиланням у джерелі. Випадки, у яких у
призначенні можуть з'явитися зайві  жорсткі посилання:
.IP
.RS
.IP o
Якщо призначення містить сторонні жорсткі посилання (більше посилань, ніж
було у списку файлів джерела), алгоритм копіювання не порушуватиме їх явним
чином. Втім, якщо за одним або декількома шляхами будуть відмінності у
даних, звичайний процес оновлення файлів порушить ці сторонні посилання
(якщо ви не скористаєтеся параметром \fB\-\-inplace\fP).
.IP o
Якщо ви вкажете катало \fB\-\-link\-dest\fP, що містить жорсткі посилання,
прив'язування файлів призначення до файлів \fB\-\-link\-dest\fP може призвести до
пов'язування деяких шляхів у призначенні між собою через прив'язки
\fB\-\-link\-dest\fP.
.RE
.IP
Зауважте, що rsync може виявляти жорсткі посилання лише між файлами, які
перебувають у наборі для передавання. Якщо rsync оновлює файл, який має
жорсткі прив'язки до файлів поза набором файлів для передавання, такі
прив'язки буде зруйновано. Якщо вам хочеться скористатися параметром
\fB\-\-inplace\fP, щоб уникнути такого руйнування, будьте дуже обережні: файли не
повіинні змінюватися до файлів протягом тривалості існування жорстких
посилань (опис додаткових можливих проблем наведено у описі параметра
\fB\-\-inplace\fP).
.IP
Якщо активною є нарощувальна рекурсія (див. \fB\-\-inc\-recursive\fP), rsync може
передати пропущений файл із жорстким посиланням до того, як виявить, що на
ці дані є інше посилання десь в ієрархії. Це не вплине на точність
передавання даних (тобто те, які файли буде пов'язано жорсткими посиланнями
між собою), а лише на його ефективність (тобто на копіювання даних заново,
випереджальне копіювання файла із жорстким посиланням, який могло б бути
знайдено пізніше під час передавання іншого запису набору файлів із
жорсткими посиланнями). Одним зі способів уникнути цієї неефективності є
вимикання нарощувальної рекурсії за допомогою параметра
\fB\-\-no\-inc\-recursive\fP.
.IP "\fB\-\-perms\fP, \fB\-p\fP"
Якщо буде позначено цей пункт, програма встановлюватиме на стороні отримання
даних rsync права доступу до елементів структури каталогів тотожні до прав
доступу до елементів структури каталогів на стороні джерела. (Див. також
параметр \fB\-\-chmod\fP, щоб дізнатися про зміну того, що rsync розглядає, як
права доступу джерела.)
.IP
Якщо значенням цього параметра є \fIoff\fP, права доступу буде встановлено ось
так:
.IP
.RS
.IP o
Наявні файли (включно із оновленими файлами) зберігатимуть наявні права
доступу, хоча параметр \fB\-\-executability\fP може змінити права доступу до
виконання файла.
.IP o
Нові файли отримають «звичайні» біти прав доступу до файла джерела з маскою
типових прав доступу каталогу отримувача (або umask процесу\-отримувача, або
права доступу, які визначено за допомогою типового ACL каталогу
призначення), а їхні особливі біти прав доступу буде вимкнено, за винятком
випадку, коли новий каталог успадковує біт setgid від свого батьківського
каталогу.
.RE
.IP
Таким чином, якщо вимкнено одразу \fB\-\-perms\fP і \fB\-\-executability\fP, поведінка
rsync буде тією самою, що і поведінка інших програм для копіювання файлів,
зокрема \fBcp\fP(1) і \fBtar\fP(1).
.IP
Резюме: щоб надати файлам призначення (старим і новим) прав доступу джерела,
скористайтеся \fB\-\-perms\fP. Щоб надати новим файлам типових для призначення
прав доступу (не змінюючи прав доступу до наявних файлів), переконайтеся, що
вимкнено параметр \fB\-\-perms\fP і скористайтеся параметром \fB\-\-chmod=ugo=rwX\fP
(який забезпечує вмикання усіх незамаскованих бітів). Якщо вам хочеться
скоротити останній запис параметра, ви можете визначити для нього
альтернативу popt, додавши цей рядок до файла \fB~/.popt\fP (нижче ми
визначаємо параметр \fB\-Z\fP і включаємо \fB\-\-no\-g\fP, щоб скористатися типовою
групою\-власником каталогу призначення):
.RS 4
.IP
.nf
rsync alias \-Z \-\-no\-p \-\-no\-g \-\-chmod=ugo=rwX
.fi
.RE
.IP
Ви можете скористатися цим новим параметром у команді, подібній до такої:
.RS 4
.IP
.nf
rsync \-avZ джерело/ призначення/
.fi
.RE
.IP
(Застереження: слід розташовувати \fB\-a\fP перед \fB\-Z\fP, інакше цей параметр
повторно увімкне обидва параметри \fB\-\-no\-*\fP, про які ми згадували вище.)
.IP
Збереження біта setgid у призначенні для новостворених каталогів, якщо
вимкнено \fB\-\-perms\fP, було додано у rsync 2.6.7. У старіших версіях rsync
помилково зберігалися три біти особливих прав доступу для новостворених
файлів, якщо \fB\-\-perms\fP було вимкнено із перевизначенням встановленого біта
setgid призначення для новоствореного каталогу. Типове дотримання ACL було
додано у латці ACL до rsync 2.6.7, отже давніші (без вмикання ACL) версії
rsyncs використовують umask, навіть якщо виявлено типові ACL. (Слід
пам'ятати, що все це стосується версії rsync на боці отримувача.)
.IP "\fB\-\-executability\fP, \fB\-E\fP"
Цей параметр наказує rsync зберегти права щодо виконання (або невиконання)
звичайних файлів, якщо не увімкнено \fB\-\-perms\fP. Звичайний файл вважатиметься
виконуваним, якщо у його правах доступ увімкнено принаймні один біт
«x». Якщо права доступу до виконання файла на боці призначення відрізняються
від прав доступу відповідного файла джерела, rsync змінить права доступу до
файла призначення таким чином:
.IP
.RS
.IP o
Щоб зробити файл непридатним до виконання, rsync вимикає усі його права
доступу «x».
.IP o
Щоб зробити файл придатним до виконання, rsync вмикає усі права доступу «x»,
де увімкнено відповідні права доступу «r».
.RE
.IP
Якщо увімкнено \fB\-\-perms\fP, цей параметр буде проігноровано.
.IP "\fB\-\-acls\fP, \fB\-A\fP"
Використання цього параметра наказує rsync оновлювати ACL призначення так,
щоб вони були такими самими, що і ACL джерела. Параметр також неявним чином
встановлює \fB\-\-perms\fP.
.IP
Щоб цей параметр працював належним чином, у системах джерела і призначення
повинні бути сумісні записи ACL. Див. параметр \fB\-\-fake\-super\fP, якщо
потрібен спосіб резервного копіювання та відновлення ACL, які є несумісними.
.IP "\fB\-\-xattrs\fP, \fB\-X\fP"
Використання цього параметра наказує rsync оновлювати розширені атрибути
призначення так, щоб вони були такими самими, що і розширені атрибути
джерела.
.IP
У системах, де передбачено підтримку просторів назв розширених атрибутів,
копіювання, що виконується надкористувачем, копіюватиме усі простори назв,
окрім system.*. Звичайний користувач зможе скопіювати лише простір назв
user.*. Щоб мати змогу створювати резервні копії і відновлювати дані для
просторів назв поза user.* від імені звичайного користувача, скористайтеся
параметром \fB\-\-fake\-super\fP.
.IP
Описане вище фільтрування назв можна перевизначити за допомогою одного або
декількох параметрів фільтрування з модифікатором \fBx\fP. Якщо ви визначаєте
правило фільтрування, що стосуватиметься x\-атрибутів, rsync вимагатиме, щоб
ви створили власне фільтрування на рівні системи/користувача, а також
виконали усе додаткове фільтрування щодо того, які назви x\-атрибутів буде
скопійовано, і які можна буде вилучити. Наприклад, щоб пропустити простір
назв system, ви можете вказати таке:
.RS 4
.IP
.nf
\-\-filter='\-x system.*'
.fi
.RE
.IP
Щоб пропустити усі простори назв, окрім простору назв user, ви можете
вказати відповідність запереченню рядку user:
.RS 4
.IP
.nf
\-\-filter='\-x! user.*'
.fi
.RE
.IP
Щоб запобігти вилученню атрибутів, ви можете вказати правило лише для
отримувача, яке виключає усі назви:
.RS 4
.IP
.nf
\-\-filter='\-xr *'
.fi
.RE
.IP
Зауважте, що використання параметра \fB\-X\fP не призведе до копіювання rsync
значень особливих x\-атрибутів (наприклад тих, які використовує
\fB\-\-fake\-super\fP), якщо ви не повторите цей параметр (наприклад, \fB\-XX\fP). Цей
режим «копіювання усіх x\-атрибутів» не можна використовувати разом із
\fB\-\-fake\-super\fP.
.IP \fB\-\-chmod=РЕЖИМ\fP
Цей параметр наказує rsync застосувати один або декілька відокремлених
комами режимів «chmod» до прав доступу до файлів у передаванні
даних. Отримане у результаті значення буде оброблено так, наче це були права
доступу на боці надсилання, що означає, що цей параметр не вплине на наявні
файли, якщо не увімкнено \fB\-\-perms\fP.
.IP
На додачу до звичайних правил обробки, які вказано на сторінці підручника
щодо \fBchmod\fP(1), ви можете вказати запис, який має бути застосовано до
каталогу, додавши префікс «D», або вказати запис, який слід застосувати лише
до файла, додавши префікс «F». Наприклад, вказана нижче команда забезпечить
позначення усіх каталогів бітом setgid, те, що усі файли не будуть
придатними до запису іншими користувачами, придатними до запису користувачем
і групою\-власником, і каталоги і файли матимуть узгоджені права на запуск
для усіх бітів:
.RS 4
.IP
.nf
\-\-chmod=Dg+s,ug+w,Fo\-w,+X
.fi
.RE
.IP
Також можна використовувати числові вісімкові режими:
.RS 4
.IP
.nf
\-\-chmod=D2775,F664
.fi
.RE
.IP
Також можна вказати декілька параметрів \fB\-\-chmod\fP, оскільки кожен
додатковий параметр просто дописує дані до списку змін, які слід внести.
.IP
Див. опис параметрів \fB\-\-perms\fP і \fB\-\-executability\fP, щоб дізнатися про те,
як остаточне значення прав доступу може бути застосовано до файлів при
передаванні.
.IP "\fB\-\-owner\fP, \fB\-o\fP"
Використання цього параметра наказує rsync встановити власника файла
призначення так, щоб він збігався із власником файла джерела, але лише якщо
rsync на боці отримувача запущено від імені надкористувача (див. також
параметри \fB\-\-super\fP і \fB\-\-fake\-super\fP). Без цього параметра власником нових
і/або перенесених файлів буде користувач, який запустив програму на боці
отримання даних.
.IP
Збереження прав власності типово призведе до прив'язки за назвами, але, за
певних обставин, резервним варіантом буде використання числового
ідентифікатора (див. також \fB\-\-numeric\-ids\fP параметр, де наведено повне
обговорення).
.IP "\fB\-\-group\fP, \fB\-g\fP"
Використання цього параметра наказує rsync встановити таку саму
групу\-власника файла призначення, що і для файла джерела. Якщо програму на
боці отримувача не запущено від імені надкористувача (або якщо не вказано
\fB\-\-no\-super\fP), буде збережено лише групи, учасником яких є користувач, який
запустив програму на боці отримання. Без цього параметра буде встановлено
типову групу користувача\-власника у системі отримання даних.
.IP
Збереження даних щодо групи\-власника типово призведе до прив'язки за
назвами, але, за певних обставин, резервним варіантом буде використання
числового ідентифікатора (див. також \fB\-\-numeric\-ids\fP параметр, де наведено
повне обговорення).
.IP \fB\-\-devices\fP
Використання цього параметра наказує rsync передавати файли символьних і
блокових пристроїв на віддалену систему так, щоб відтворити ці
пристрої. Якщо rsync на боці отримання не запущено від імені надкористувача,
rsync без додаткових повідомлень пропустить створення файлів пристроїв
(див. також параметри \fB\-\-super\fP і \fB\-\-fake\-super\fP).
.IP
Типово, rsync створює повідомлення «незвичайний файл» для кожного файла
пристрою, який трапиться програмі, коли цей параметр не використано. Ви
можете придушити це попередження, вказавши параметр \fB\-\-info=nonreg0\fP.
.IP \fB\-\-specials\fP
Використання цього параметра наказує rsync передавати особливі файли ,
зокрема іменовані сокети і FIFO. Якщо rsync на боці отримання не запущено
від імені надкористувача, rsync без додаткових повідомлень пропустить
створення особливих файлів (див. також параметри \fB\-\-super\fP і
\fB\-\-fake\-super\fP).
.IP
Типово, rsync створює повідомлення «незвичайний файл» для кожного особливого
файла, який трапиться програмі, коли цей параметр не використано. Ви можете
придушити це попередження, вказавши параметр \fB\-\-info=nonreg0\fP.
.IP \fB\-D\fP
Параметр \fB\-D\fP є тим сами, що і «\fB\-\-devices\fP \fB\-\-specials\fP».
.IP \fB\-\-copy\-devices\fP
Цей параметр наказує rsync обробляти пристрій на боці відправника як
звичайний файл, уможливлюючи його копіювання до звичайного файла призначення
(або іншого пристрою, якщо також вказано  \fB\-\-write\-devices\fP).
.IP
Цей параметр типово буде відкинуто фоновою службою rsync.
.IP \fB\-\-write\-devices\fP
Цей параметр наказує rsync обробляти пристрій на боці отримання як звичайний
файл, надаючи змогу записувати дані файла на пристрій.
.IP
Цей параметр неявним чином встановлює параметр \fB\-\-inplace\fP.
.IP
Будьте обережні з користуванням, оскільки вам потрібно буде знати, які
пристрої є на боці отримання даних, особливо, якщо rsync запущено від імені
користувача root.
.IP
Цей параметр типово буде відкинуто фоновою службою rsync.
.IP "\fB\-\-times\fP, \fB\-t\fP"
Використання цього параметра наказує rsync переносити разом із файлами дані
щодо часу внесення змін і оновлювати їх на віддаленій системі. Зауважте, що
якщо цей параметр не використано, не можна буде скористатися і оптимізацією,
яка виключає файли, які не було змінено; іншими словами, пропущений \fB\-t\fP
(або \fB\-a\fP) призведе до того, що при наступному передаванні даних програма
поводитиметься так, наче її використано з \fB\-\-ignore\-times\fP (\fB\-I\fP), тобто
буде оновлено усі файли (хоча алгоритм дельта\-передавання rsync зробить
оновлення доволі ефективним, якщо файли насправді не було змінено, вам не
варто користуватися \fB\-t\fP).
.IP "\fB\-\-atimes\fP, \fB\-U\fP"
Наказує rsync встановити часи доступу (використання) для файлів призначення
такі самі, як для файлів джерела.
.IP
Якщо повторити параметр, буде встановлено також параметр \fB\-\-open\-noatime\fP,
який може допомогти вам зробити часи доступу у системах надсилання і
отримання однаковими без потреби у додатковому запуску rsync після
перенесення даних файла.
.IP
Зауважте, що деякі застарілі версії rsync (до версії 3.2.0) може бути
зібрано із використаною до випуску латкою \fB\-\-atimes\fP, яка не встановлює
неявним чином \fB\-\-open\-noatime\fP, якщо цей параметр повторено у команді.
.IP \fB\-\-open\-noatime\fP
Використання цього параметра наказує rsync відкривати файли з прапорцем
O_NOATIME (у системах, де передбачено його підтримку), щоб уникнути зміни
часу доступу до файлів, які передаються. Якщо у вашій системі не передбачено
підтримки прапорця O_NOATIME, rsync без повідомлень проігнорує такий
параметр. Зауважте також, що деякі файлові системи монтують так, щоб
уникнути оновлення часу доступу при доступі для читання, навіть без
встановлення прапорця O_NOATIME.
.IP "\fB\-\-crtimes\fP, \fB\-N,\fP"
Наказує rsync встановити часи створення (новизни) для файлів призначення
такі самі, як для файлів джерела.
.IP "\fB\-\-omit\-dir\-times\fP, \fB\-O\fP"
Використання цього параметра наказує rsync уникати каталогів при збереженні
часу внесення змін, доступу та створення. Якщо NFS поширюється на каталоги
на боці отримання, варто скористатися \fB\-O\fP. Цей параметр буде неявно
встановлено, якщо ви скористаєтеся \fB\-\-backup\fP без \fB\-\-backup\-dir\fP.
.IP
Використання цього параметра також має побіжний ефект уникнення раннього
створення підкаталогів, яких не існує, якщо увімкнено нарощувальну рекурсію,
як це обговорено у розділі щодо параметра \fB\-\-inc\-recursive\fP.
.IP "\fB\-\-omit\-link\-times\fP, \fB\-J\fP"
Використання цього параметра наказує rsync уникати символічних посилань при
збереженні часу внесення змін, доступу та створення.
.IP \fB\-\-super\fP
Використання цього параметра наказує кінцю отримувача спробувати виконати
дії надкористувача, навіть якщо rsync на боці отримувача запущено не від
імені надкористувача. Серед цих дій такі: збереження користувачів\-власників
з використанням параметра \fB\-\-owner\fP, збереження усіх груп (не лише груп
поточного користувача) з використанням параметра \fB\-\-group\fP і копіювання
пристроїв з використанням параметра \fB\-\-devices\fP. Це корисно для систем, які
дозволяють такі дії без набуття прав надкористувача та забезпечення
отримання повідомлень про помилки, якщо на боці отримання програму запущено
не від імені надкористувача. Щоб вимкнути дії від імені надкористувача,
надкористувач може скористатися параметром \fB\-\-no\-super\fP.
.IP \fB\-\-fake\-super\fP
Якщо увімкнено цей параметр, rsync імітуватиме дії від імені надкористувача,
зберігаючи/відновлюючи привілейовані атрибути за допомогою спеціальних
розширених атрибутів, які буде долучено до кожного файла (якщо
потрібно). Серед цих атрибутів дані щодо власника і групи файла (якщо вони
не є типовими), відомості щодо пристрою файла (файли пристроїв і особливі
файли буде створено як порожні текстові файли) та усі біти прав доступу, які
було б заборонено встановлювати у справжній системі (наприклад, звичайний
файл отримує u\-s,g\-s,o\-t для безпеки), або які обмежували б доступ власнику
(оскільки справжній надкористувач завжди може отримувати доступ і змінювати
файл, доступ до зміни створених нами файлів завжди відкрито для користувача,
який їх створив). Цей параметр також обробляє ACL (якщо було вказано
\fB\-\-acls\fP) і розширені атрибути поза простором назв користувача (якщо
вказано \fB\-\-xattrs\fP).
.IP
Це добрий спосіб створення резервних копій даних без використання прав
надкористувача і зберігання ALC із несумісних систем.
.IP
Параметр \fB\-\-fake\-super\fP стосується лише того кінця з'єднання, де його
використано. Щоб вплинути на віддалений бік з'єднання із віддаленою
оболонкою, скористайтеся параметром \fB\-\-remote\-option\fP (\fB\-M\fP):
.RS 4
.IP
.nf
rsync \-av \-M\-\-fake\-super /джерело/ вузол:/призначення/
.fi
.RE
.IP
При локальному копіюванні цей параметр стосуватиметься і джерела, і
призначення. Якщо ви хочете при локальному копіюванні увімкнути цей параметр
лише для файлів призначення, вкажіть \fB\-M\-\-fake\-super\fP. Якщо ви хочете при
локальному копіюванні увімкнути цей параметр лише для файлів джерела,
поєднайте \fB\-\-fake\-super\fP із \fB\-M\-\-super\fP.
.IP
Цей параметр буде перевизначено обома параметрами, \fB\-\-super\fP і
\fB\-\-no\-super\fP.
.IP
Див. також параметр \fBfake\ super\fP у файлі rsyncd.conf фонової служби.
.IP "\fB\-\-sparse\fP, \fB\-S\fP"
Спробувати обробляти розріджені файли ефективно, щоб вони займали менше
місця у системі призначення. Якщо поєднано із \fB\-\-inplace\fP, створений файл
може бути і не складатися із розріджених блоків у деяких комбінаціях версії
ядра і/або типу файлової системи. Якщо використано \fB\-\-whole\-file\fP
(наприклад, для локального копіювання), працює завжди, оскільки rsync
обрізає файл до запису оновленої версії.
.IP
Зауважте, що версії rsync, які є старішими за 3.1.3, відмовлятимуть у
одночасному використанні \fB\-\-sparse\fP і \fB\-\-inplace\fP.
.IP \fB\-\-preallocate\fP
Наказує отримувачу розмістити на диску кожен файл призначення із його
кінцевим розміром до запису даних до файла. Rsync використовуватиме лише
підтримку справжнього попереднього отримання пам'яті на рівні файлової
системи, яку надає системний виклик Linux \fBfallocate\fP(2) або
\fBposix_fallocate\fP(3) у Cygwin, а не повільну реалізацію glibc, яка записує
нуль\-байт для кожного блоку.
.IP
Без цього параметра запис великих файлів може бути не зовсім неперервним у
файловій системі, але з цим параметром rsync, ймовірно, копіюватиме дані
дещо повільніше. Якщо у призначенні використано систему без підтримки
розширення (зокрема ext4, xfs, NTFS тощо), використання цього параметра
взагалі може не мати жодних позитивних наслідків.
.IP
Якщо поєднано із \fB\-\-sparse\fP, у файлі будуть лише розріджені блоки (на
відміну від записаних на диск послідовностей нуль\-байтів), якщо у версії
ядра системи та типі файлової системи передбачено створення «дірок» у
записаних на диск даних.
.IP "\fB\-\-dry\-run\fP, \fB\-n\fP"
Наказує rsync виконати тестовий запуск, без внесення змін (із виведенням
майже тих самих даних, що і при справжньому запуску). Найчастіше
використовують у поєднанні з параметрами \fB\-\-verbose\fP (\fB\-v\fP) і/або
\fB\-\-itemize\-changes\fP (\fB\-i\fP), щоб переглянути, які дії буде виконано
командою rsync, перш ніж її буде насправді виконано.
.IP
Виведення \fB\-\-itemize\-changes\fP має бути точно таким самим, як і при
тестовому запуску і наступному справжньому запуску (показуючи навмисні трюки
та помилки системних викликів); якщо це не так, це вада. Інші виведені
повідомлення мають бути здебільшого тими самим, але можуть відрізнятися у
деяких областях. Зокрема, тестовий запуск не надсилає справжні дані для
передавання файлів, отже \fB\-\-progress\fP не працюватиме, статистика «надіслано
байтів», «отримано байтів», «буквальні дані» і «відповідні дані» буде
заниженою, а значення «пришвидшення» буде рівним значенню при запуску, де не
виконується жодного передавання даних.
.IP "\fB\-\-whole\-file\fP, \fB\-W\fP"
Використання цього параметра вимикає алгоритм дельта\-передавання rsync, який
спричиняє цілісне надсилання усіх переданих файлів. Цей параметр може
пришвидшити передавання, якщо канал передавання даних між комп'ютером
джерела та призначення є ширшим за канал передавання даних на диск
(особливо, якщо «диском» є насправді мережева файлова система). Це типовий
режим, якщо джерело і призначення вказано як локальні шляхи, але лише якщо
не увімкнено параметр пакетного запису.
.IP "\fB\-\-no\-whole\-file\fP, \fB\-\-no\-W\fP"
Вимкнути оновлення цілих файлів, якщо типово увімкнено для локального
передавання даних. Зазвичай, уповільнює роботу rsync, але може бути
корисним, якщо ви намагаєтеся мінімізувати запис до файла призначення (якщо
поєднано із \fB\-\-inplace\fP), або для тестування алгоритму оновлення на основі
контрольних сум.
.IP
See also the \fB\-\-whole\-file\fP option.
.IP "\fB\-\-checksum\-choice=РЯДОК\fP, \fB\-\-cc=РЯДОК\fP"
За допомогою цього параметра можна перевизначити алгоритм обчислення
контрольної суми. Якщо вказано одну назву алгоритму, його буде використано
для обчислення контрольних сум передавання даних і (якщо вказано
\fB\-\-checksum\fP) обчислення контрольних сум перед передаванням даних. Якщо
вказано дві назви, які відокремлено комою, першу назву буде використано для
контрольних сум передавання даних, а другу — для контрольних сум перед
передаванням даних (\fB\-c\fP).
.IP
Параметри контрольних сум, якими ви можете скористатися, є такими:
.IP
.RS
.IP o
\fBauto\fP (типовий автоматичний вибір)
.IP o
\fBxxh128\fP
.IP o
\fBxxh3\fP
.IP o
\fBxxh64\fP (або \fBxxhash\fP)
.IP o
\fBmd5\fP
.IP o
\fBmd4\fP
.IP o
\fBnone\fP
.RE
.IP
Віддайте команду \fBrsync\ \-\-version\fP, щоб переглянути список типових
контрольних сум, підтримку яких було зібрано у вашій версії (список може
відрізнятися від наведеного вище).
.IP
Якщо вказано «none» для першої (або єдиної) назви, буде примусово
встановлено параметр \fB\-\-whole\-file\fP, перевірка контрольних сум при
передаванні даних не виконуватиметься. Якщо «none» вказано для другої (або
єдиної) назви, не можна буде скористатися параметром \fB\-\-checksum\fP.
.IP
Типовим є варіант «auto», коли вибір алгоритму в rsync буде засновано на
узгодженні між клієнтом і сервером ось так:
.IP
Якщо на обох кінцях ланцюжка передавання даних встановлено принаймні версію
3.2.0, rsync вибирає перший алгоритму у списку варіантів клієнта, який є
також у списку варіантів сервера. Якщо спільних варіантів не буде виявлено,
rsync завершить роботу із повідомленням про помилку. Якщо віддалений rsync є
надто давнім, і у ньому не передбачено підтримки узгодження контрольних сум,
значення буде вибрано на основі версії протоколу (вибір між MD5 і
різноманітними варіантами MD4 на основі віку протоколу).
.IP
Типовий порядок можна налаштувати встановленням для змінної середовища
\fBRSYNC_CHECKSUM_LIST\fP значення списку відокремлених пробілами прийнятних
назв контрольних сум. Якщо рядок містить «\fB&\fP», його буде розділено на
«рядок клієнта & рядок сервера», інакше той самий рядок буде застосовано до
обох. Якщо рядок (або частина рядка) містить непробільні символи, буде
використано типовий список контрольних сум. Цей спосіб не дозволить вам
вказати контрольну суму, яку буде застосовано до передавання даних, окремо
від контрольної суми, яку буде використано перед передаванням даних, а
«auto» і усі невідомі назви контрольних сум буде просто відкинуто. Список,
який міститиме лише некоректні назви, призведе до помилки під час
узгодження.
.IP
Використання параметра \fB\-\-checksum\-choice\fP призводить до перевизначення
цього списку середовища.
.IP "\fB\-\-one\-file\-system\fP, \fB\-x\fP"
За допомогою позначення цього пункту можна наказати rsync уникати
перетинання меж файлових систем під час рекурсивного перегляду
каталогів. Використання цього параметра не обмежує можливості користувача
щодо копіювання з декількох файлових систем, просто обмежує рекурсивний
перегляд rsync ієрархії кожної з вказаних користувачем тек, а також
аналогічного рекурсивного перегляду на стороні отримання даних під час
вилучення файлів. Крім того, вам слід пам’ятати, що rsync вважає точки
монтування, «зав'язані» на один пристрій, однією файловою системою.
.IP
Якщо повторити цей параметр в одній команді, rsync при копіюванні пропустить
усі каталоги, які є точками монтування. Якщо ж параметр не повторювати,
програма включить порожній каталог для кожної виявленої точки монтування (з
використанням атрибутів змонтованого каталогу, оскільки атрибути базового
каталогу точки монтування є недоступними).
.IP
Якщо rsync наказано згорнути символічні посилання (за допомогою
\fB\-\-copy\-links\fP або \fB\-\-copy\-unsafe\-links\fP), символічне посилання на каталог
на іншому пристрої вважатиметься точкою монтування. Цей параметр не
впливатиме на символічні посилання на записи, які не є каталогами.
.IP "\fB\-\-ignore\-non\-existing\fP, \fB\-\-existing\fP"
За допомогою цього параметра можна наказати rsync пропустити етап створення
файлів (і каталогів), яких ще немає на стороні призначення. Якщо поєднати
цей параметр з параметром \fB\-\-ignore\-existing\fP, файли не оновлюватимуться
взагалі (корисно, якщо вам потрібно просто вилучити зайві файли).
.IP
Цей параметр є правилом передавання, а не виключення, тому він не впливає на
дані, які потрапляють до списків файлів, а отже, не впливає на
вилучення. Він просто обмежує перелік файлів, на які отримувач надішле запит
щодо передавання.
.IP \fB\-\-ignore\-existing\fP
За допомогою цього параметра можна наказати rsync пропускати крок оновлення
файлів, які вже існують у файловій системі призначення (наявні каталоги
\fIне\fP буде проігноровано, інакше нічого не буде виконано). Див. також
\fB\-\-ignore\-non\-existing\fP.
.IP
Цей параметр є правилом передавання, а не виключення, тому він не впливає на
дані, які потрапляють до списків файлів, а отже, не впливає на
вилучення. Він просто обмежує перелік файлів, на які отримувач надішле запит
щодо передавання.
.IP
Цей параметр може бути корисним для тих, хто створює резервні копії з
використанням параметра \fB\-\-link\-dest\fP, якщо їм потрібно потрібно продовжити
процедуру створення резервної копії, яку було перервано. Оскільки виконання
\fB\-\-link\-dest\fP передбачає копіювання до нової ієрархії каталогів (якщо його
використано належним чином), використання \fB\-\-ignore\-existing\fP забезпечить
усування коригування вже оброблених файлів (тобто програма уникатиме зміни
прав доступу до файлів, для яких використано жорсткі посилання). Це означає,
що цей параметр призведе до пошуку лише наявних файлів у самій ієрархії
призначення.
.IP
Якщо використано \fB\-\-info=skip2\fP, rsync виводитиме повідомлення «НАЗВА_ФАЙЛА
exists (ВІДОМОСТІ)», де ВІДОМОСТІ будуть одним з рядків: «type change»
(«змінено тип»), «sum change» (змінено суму», потребує \fB\-c\fP), «file change»
(«змінено файл», на основі швидкої перевірки), «attr change» («змінено
атрибути») або «uptodate» («є актуальним»). Якщо використано \fB\-\-info=skip1\fP
(тобто також неявним чином встановлено 2 параметри \fB\-v\fP), програма виведе
повідомлення про існування, але без суфікса ВІДОМОСТІ.
.IP \fB\-\-remove\-source\-files\fP
За допомогою цього параметра можна наказати rsync вилучати зі сторони
надсилання файли (тобто елементи, які не є каталогами), дублікати яких під
час перенесення було успішно створено на стороні отримання даних.
.IP
Зауважте, що вам слід користуватися цим параметром для файлів джерела, лише
якщо вони є статичними. Якщо ви користуєтеся цим для пересування файлів у
певному каталозі на інший вузол зв'язку, переконайтеся, що завершені файли
перейменовано у каталозі джерела, а не безпосередньо записано до нього, щоб
не виникло ситуації, коли rsync переноситиме файл, який записано не
повністю. Якщо ви не можете спочатку записати файли до іншого каталогу, вам
слід скористатися ідіомою іменування, яка дозволить rsync уникнути
перенесення файлів, запис до яких ще не було завершено (наприклад, називайте
файл «щось.new», доки до нього виконується запис, перейменуйте його на
«щось», коли запис буде завершено, а потім скористайтеся параметром
\fB\-\-exclude='*.new'\fP для передавання даних rsync).
.IP
Починаючи з версії 3.1.0, rsync пропускатиме вилучення на боці відправника
(і виведення повідомлення про помилку), якщо розмір файла або час внесення
змін до файла було змінено.
.IP \fB\-\-delete\fP
Наказує rsync вилучити зайві файли з боку отримання (ті файли, яких немає на
боці відправника), але лише для каталогів, синхронізація яких
відбувається. Вам слід наказати rsync надіслати увесь каталог (наприклад
«\fBкаталог\fP» або «\fBкаталог/\fP») без використання замінника для вмісту
каталогу (наприклад «\fBкаталог/*\fP»), оскільки замінник буде розгорнуто
командною оболонкою, і,таким чином, rsync отримає запит щодо перенесення
окремих файлів, а не батьківського каталогу цих файлів. Файли, які виключено
з передавання, також буде виключено з вилучення, якщо ви не скористаєтеся
параметром \fB\-\-delete\-excluded\fP або не визначите правила, як такі,
відповідність яких визначається на боці відправника (див. модифікатори
включення\-виключення у розділі ПРАВИЛА ФІЛЬТРУВАННЯ).
.IP
До версії rsync 2.6.7 цей параметр ні на що не впливав, якщо не було
увімкнено \fB\-\-recursive\fP. Починаючи з версії 2.6.7, вилучення відбувається і
якщо увімкнено \fB\-\-dirs\fP (\fB\-d\fP), але лише для каталогів, чи вміст копіює
програма.
.IP
Цей параметр може бути небезпечним, якщо його використано не належним чином!
Завжди варто спочатку спробувати скористатися параметром \fB\-\-dry\-run\fP
(\fB\-n\fP), щоб визначити, які файли буде вилучено.
.IP
Якщо на боці відправника буде виявлено якісь помилки введення\-виведення,
вилучення будь\-яких файлів на боці призначення буде автоматично
вимкнено. Так зроблено, щоб запобігти спричиненню тимчасовими помилками у
файловій системі (зокрема помилками NFS) на боці надсилання масовому
вилученню файлів на боці призначення. Ви можете перевизначити таку поведінку
за допомогою параметра \fB\-\-ignore\-errors\fP.
.IP
Параметр \fB\-\-delete\fP може бути поєднаного з одним із параметрів
\-\-delete\-УМОВА без конфлікту, а також з параметром
\fB\-\-delete\-excluded\fP. Втім, якщо не вказано жодного параметра
\fB\-\-delete\-УМОВА\fP, rsync вибере алгоритм \fB\-\-delete\-during\fP при обміні
даними із rsync 3.0.0 або новішою версією або алгоритм \fB\-\-delete\-before\fP
при обміні даними із застарілою версією rsync. Див. також \fB\-\-delete\-delay\fP
і \fB\-\-delete\-after\fP.
.IP \fB\-\-delete\-before\fP
Вимагати, щоб вилучення файлів на боці отримання виконувалося до початку
передавання даних. Див. \fB\-\-delete\fP (буде задано неявним чином), щоб
дізнатися більше про вилучення файлів.
.IP
Вилучення до передавання даних є корисним, якщо у файловій системі доволі
мало місця, і вилучення зайвих файлів допоможе зробити передавання даних
можливим. Втім, воно додає затримку перед початком перенесення даних, і ця
затримка може спричинити перевищення часу очікування на початок передавання
даних (якщо вказано параметр \fB\-\-timeout\fP). Таке вилучення також примушує
rsync до використання застарілого алгоритму без нарощувальної рекурсії, який
потребує від rsync одночасного сканування у пам'яті усіх файлів у списку
передавання (див. \fB\-\-recursive\fP).
.IP "\fB\-\-delete\-during\fP, \fB\-\-del\fP"
Надсилає запит щодо того, щоб вилучення файлів на боці отримання
виконувалося нарощувально із кожним передаванням даних. Сканування щодо
вилучення для окремих каталогів виконується одразу перед перевіркою каталогу
на оновлення, отже у цьому режимі програма поводиться, як із більш
ефективним \fB\-\-delete\-before\fP, включно із вилученням до оновлення будь\-яких
файлів фільтрування окремих каталогів. Цей параметр було вперше додано у
версії rsync 2.6.4. Див. \fB\-\-delete\fP (буде встановлено неявним чином), щоб
дізнатися більше про вилучення файлів.
.IP \fB\-\-delete\-delay\fP
Надсилає запит щодо того, щоб перелік файлів для вилучення на боці отримання
визначався під час передавання (подібно до \fB\-\-delete\-during\fP), а потім
файли було вилучено після завершення передавання даних. Корисно у поєднанні
із параметрами \fB\-\-delay\-updates\fP і/або \fB\-\-fuzzy\fP, і є більш ефективним за
використання \fB\-\-delete\-after\fP (але може поводитися інакше, оскільки
\fB\-\-delete\-after\fP визначає список для вилучення на окремому проході після
завершення усіх оновлень). Якщо кількість вилучених файлів переповнюватиме
внутрішній буфер, для зберігання назв буде створено тимчасовий файл на боці
отримання (його буде вилучено після відкриття, тому ви не побачити його під
час передавання даних). Якщо тимчасовий файл не вдасться створити, rsync
спробує повернутися до використання \fB\-\-delete\-after\fP (програма не зможе
цього зробити, якщо \fB\-\-recursive\fP виконує нарощувальне
сканування). Див. \fB\-\-delete\fP (буде встановлено неявним чином), щоб
дізнатися більше про вилучення файлів.
.IP \fB\-\-delete\-after\fP
Надсилає запит щодо того, щоб перелік файлів для вилучення на боці отримання
визначався після завершення передавання даних. Це корисно, якщо ви
надсилаєте нові окремі для каталогу файли об'єднання як частину передавання
даних, і ви хочете, щоб виключення окремих каталогів набували чинності на
кроці вилучення поточного передавання даних. Також rsync буде примусово
використано старий, не нарощувальний алгоритм рекурсії, який потребує від
rsync одночасного сканування до пам'яті усіх файлів у передаванні
(див. \fB\-\-recursive\fP). Див. \fB\-\-delete\fP (буде встановлено неявним чином),
щоб дізнатися більше про вилучення файлів.
.IP
Див. також параметр \fB\-\-delete\-delay\fP, який може бути швидшим варіантом для
тих, хто хоче, щоб вилучення відбувалося наприкінці передавання даних.
.IP \fB\-\-delete\-excluded\fP
На додачу до вилучення на боці отримання файлів, яких немає на боці
надсилання, цей параметр наказує rsync також вилучити будь\-які файли, які
виключено на боці отримання (див. \fB\-\-exclude\fP). Див. розділ ПРАВИЛА
ФІЛЬТРУВАННЯ, щоб дізнатися більше про створення окремих виключень, які
поводитимуться у цей спосіб на боці отримування, і спосіб захисту файлів від
\fB\-\-delete\-excluded\fP. Див. \fB\-\-delete\fP (буде встановлено неявним чином), щоб
дізнатися більше про вилучення файлів.
.IP \fB\-\-ignore\-missing\-args\fP
Коли rsync спочатку обробляє явним чином вказані файли джерела (наприклад у
аргументах рядка команди або записах \fB\-\-files\-from\fP), програма вважає
помилкою ситуацію, коли файл не знайдено. За допомогою цього параметра можна
придушити повідомлення про такі помилки і просто не намагатися передати
відповідний файл. Це не стосується наступних помилок, пов'язаних із
зникненням файлів, які спочатку було виявлено, і які згодом зникли зі свого
місця під час передавання даних.
.IP \fB\-\-delete\-missing\-args\fP
Цей параметр просуває поведінку (неявним чином встановленого) параметра
\fB\-\-ignore\-missing\-args\fP ще на крок далі: кожен пропущений аргумент
вважається запитом на вилучення відповідного файла призначення на боці
отримувача (якщо він існує). Якщо файлом призначення є непорожній каталог,
його буде успішно вилучено, лише якщо використано \fB\-\-force\fP або
\fB\-\-delete\fP. Окрім цього, цей параметр є незалежним від обробки вилучення
будь\-яких інших типів.
.IP
Файли джерела, яких не вистачатиме, буде представлено особливими записами
списку файлів, які буде показано як запис «\fB*missing\fP» у виведених у
відповідь на використання параметра \fB\-\-list\-only\fP даних.
.IP \fB\-\-ignore\-errors\fP
За допомогою цього пункту можна наказати програмі за умов використання
параметра \fB\-\-delete\fP виконувати вилучення, навіть якщо сталися помилки
вводу\-виводу.
.IP \fB\-\-force\fP
У разі використання цього параметра rsync вилучатиме непорожні каталоги,
якщо їх слід замінити елементами, які не є каталогами. Цей параметр матиме
значення, лише якщо не визначено параметрів вилучення вмісту
(див. \fB\-\-delete\fP, щоб дізнатися більше).
.IP
Зауваження щодо застарілих версій rsync: вам доведеться скористатися
\fB\-\-force\fP при використанні \fB\-\-delete\-after\fP, і параметр не працюватиме,
якщо також не вказано \fB\-\-recursive\fP.
.IP \fB\-\-max\-delete=ЧИСЛО\fP
Наказує rsync не вилучати більше, ніж ЧИСЛО файлів або каталогів. Якщо буде
перевищено це обмеження, усі подальші вилучення до кінця передавання файлів
буде пропущено. Наприкінці обробки rsync виведе попередження (включено із
кількістю пропущених вилучень) і завершить роботу із кодом помилки 25 (якщо
не станеться якась серйозніша помилка).
.IP
Починаючи з версії 3.0.0, ви можете вказати \fB\-\-max\-delete=0\fP, щоб програма
попередила вас про будь\-які зайві файли у призначенні без вилучення жодного
з цих файлів. Застарілі клієнти обробляють таке значення як «без обмежень»,
тому, якщо вам не відома версія клієнта, ви можете скористатися менш
очевидним \fB\-\-max\-delete=\-1\fP, як зворотно сумісним способом вказати, що
вилучати файли заборонено (хоча дуже старі версії програми не попереджали
про перевищення обмеження).
.IP \fB\-\-max\-size=РОЗМІР\fP
Наказує rsync уникати передавання будь\-якого файла, який є більшим за
вказаний РОЗМІР. До числового значення можна дописати суфікс із рядком, який
вказує на одиниці виміру, або не вказувати суфікс, щоб вказати значення у
байтах. Можете скористатися дробовим значенням із визначенням одиниць,
наприклад \fB\-\-max\-size=1.5m\fP.
.IP
Цей параметр є правилом передавання, а не виключення, тому він не впливає на
дані, які потрапляють до списків файлів, а отже, не впливає на
вилучення. Він просто обмежує перелік файлів, на які отримувач надішле запит
щодо передавання.
.IP
Першою літерою рядка одиниці може бути \fBB\fP (байти), \fBK\fP (кіло), \fBM\fP
(мега), \fBG\fP (гіга), \fBT\fP (тера) або \fBP\fP (пета). Якщо рядок є одиничним
символом або одиничним символом із додаванням «ib» (наприклад, «G» або
«GiB»), одиниці будуть кратними до 1024. Якщо ви використовуєте дволітерний
суфікс, що завершується на «B» (наприклад «kb»), одиниці будуть кратними до
1000. Літери рядка можуть бути будь\-якою сумішшю літер верхнього і нижнього
регістрів, якою ви хочете скористатися.
.IP
Нарешті, якщо рядок завершується на «+1» або «\-1», він вважатиметься
відступом на один байт у відповідному напрямку. Найбільшим можливим
значенням, зазвичай, є \fB8192P\-1\fP.
.IP
Приклади: \fB\-\-max\-size=1.5mb\-1\fP — це 1499999 байтів, а \fB\-\-max\-size=2g+1\fP —
це 2147483649 байтів.
.IP
Зауважте, що у версіях rsync до 3.1.0 не можна використовувати
\fB\-\-max\-size=0\fP.
.IP \fB\-\-min\-size=РОЗМІР\fP
За допомогою цього пункту можна наказати rsync не переносити файли, розмір
яких менший за вказане значення РОЗМІР. Таким чином можна уникнути
надсилання малих зайвих файлів. Див. параметр \fB\-\-max\-size\fP, щоб
ознайомитися із описом аргументу РОЗМІР та іншими відомостями.
.IP
Зауважте, що у версіях rsync до 3.1.0 не можна використовувати
\fB\-\-min\-size=0\fP.
.IP \fB\-\-max\-alloc=РОЗМІР\fP
Типово, rsync обмежує окремі дії з malloc/realloc до розміру у приблизно 1
ГБ. У більшості випадків цього достатньо для запобігання помилкам протоколу,
які пов'язано із тим, що rsync надсилає запит на надто великий обсяг
пам'яті. Втім, якщо у вас мільйони файлів для передавання, багато пам'яті на
сервері, і ви не хочете ділити ваші передавання даних на багато частин, ви
можете збільшити обмеження на попереднє отримання пам'яті так, щоб програма
rsync могла споживати більше пам'яті.
.IP
Не забувайте, що це не обмеження на загальний об'єм отриманої пам'яті. Це
просто притомне обмежувальне значення для кожного окремого запиту на
отримання пам'яті.
.IP
Див. параметр \fB\-\-max\-size\fP, щоб ознайомитися із описом того, як можна
визначати РОЗМІР. Типовим суфіксом, якщо суфікс не задано, визначається
розмір у байтах.
.IP
Починаючи з версії 3.2.3, значення 0 знімає усі обмеження.
.IP
Ви можете вказати типове значення за допомогою змінної середовища
\fBRSYNC_MAX_ALLOC\fP, використовуючи ті самі значення РОЗМІРУ, для яких
передбачено підтримку для цього параметра. Якщо rsync на віддаленому кінці
з'єднання не розуміє параметра \fB\-\-max\-alloc\fP, ви можете перевизначити
значення змінної середовища за допомогою параметра \fB\-\-max\-alloc=1g\fP, який
накаже rsync уникати надсилання параметра на віддалений бік (оскільки
типовим значенням є «1G»).
.IP "\fB\-\-block\-size=РОЗМІР\fP, \fB\-B\fP"
За допомогою цього пункту можна визначити фіксований розмір блоку, який буде
використано у алгоритмі дельта\-передавання rsync. Докладніше про це можна
дізнатися з технічного звіту.
.IP
Починаючи з версії 3.2.3, РОЗМІР може бути вказано з суфіксом, як це
докладно описано для параметра \fB\-\-max\-size\fP. У старіших версіях передбачено
встановлення значення лише у байтах.
.IP "\fB\-\-rsh=КОМАНДА\fP, \fB\-e\fP"
За допомогою цього параметра ви можете вибрати альтернативну віддалену
програму командної оболонки, якою слід скористатися для обміну даними між
локальною і віддаленою копіями rsync.  Типово, rsync налаштовано на
використання ssh, але у локальній мережі ви можете віддати перевагу
користуванню rsh.
.IP
Якщо цей параметр використано з \fB[користувач@]вузол::модуль/шлях\fP, для
запуску фонової служби rsync на віддаленому вузлі буде використано віддалену
оболонку \fIКОМАНДА\fP, а усі дані буде передано за допомогою з'єднання із
віддаленою оболонкою, а не через безпосереднє з'єднання із сокетом до
запущеної фонової служби rsync на віддаленому вузлі. Див. розділ
ВИКОРИСТАННЯ МОЖЛИВОСТЕЙ ФОНОВОЇ СЛУЖБИ RSYNC\-ЗА ДОПОМОГОЮ З'ЄДНАННЯ ІЗ
ВІДДАЛЕНОЮ ОБОЛОНКОЮ вище.
.IP
Починаючи з версії rsync 3.2.0, при встановленні з'єднання із фоновою
службою за допомогою віддаленої оболонки буде встановлено змінну середовища
\fBRSYNC_PORT\fP. Її значенням буде 0, якщо слід використовувати типовий порт
фонової служби, або буде встановлено значення порту rsync, який було вказано
або за допомогою параметра \fB\-\-port\fP, або непорожнього значення в адресі
\fBrsync://\fP. Це надає змогу скрипту визначати, чи було надіслано запит щодо
нетипового порту, забезпечуючи працездатність таких речей, як SSL або
допоміжного скрипту stunnel, для встановлення з'єднання із типовим або
альтернативним портом.
.IP
У КОМАНДІ можна використовувати аргументи, якщо КОМАНДУ подано до rsync як
єдиний аргумент. Вам слід використовувати звичайні пробіли (не табуляції або
спеціалізовані пробіли) для відокремлення команди та аргументів одне від
одного. Ви також можете використовувати одинарні і/або подвійні лапки для
екранування пробілів в аргументі (але не символи зворотної похилої
риски). Зауважте, що подвоєння одинарних лапок усередині взятого в одинарні
лапки рядка дасть вам одинарні лапки; те саме стосується подвійних лапок
(хоча вам слід звернути увагу на те, які лапки обробляє командна оболонка, а
які — rsync). Декілька прикладів:
.RS 4
.IP
.nf
\-e 'ssh \-p 2234'
\-e 'ssh \-o "ProxyCommand nohup ssh firewall nc \-w1 %h %p"'
.fi
.RE
.IP
(Зауважте, що користувачі ssh можуть налаштувати специфічні параметри
з'єднання у своєму файлі .ssh/config.)
.IP
Ви також можете вибрати програму для віддаленої оболонки за допомогою
змінної середовища \fBRSYNC_RSH\fP, яка приймає той самий діапазон значень, що
і \fB\-e\fP.
.IP
Див. також параметр \fB\-\-blocking\-io\fP, на роботу якого впливає цей параметр.
.IP \fB\-\-rsync\-path=ПРОГРАМА\fP
Скористайтеся цим параметром, щоб вказати програму, яку слід запустити на
віддаленому комп'ютері для запуску rsync. Часто використовують, якщо rsync
не зберігається у типовому шляху віддаленої оболонки (наприклад,
\fB\-\-rsync\-path=/usr/local/bin/rsync\fP). Зауважте, що ПРОГРАМУ буде запущено
за допомогою командної оболонки, тому це може бути будь\-яка програма, скрипт
або послідовність команд, які вам потрібно запустити, якщо не порушено
стандартний вхід і стандартний вихід, якими rsync користується для обміну
даними.
.IP
Одним із цікавих прикладів є встановлення іншого типового каталогу на
віддаленому комп'ютері для використання з параметром \fB\-\-relative\fP. Приклад:
.RS 4
.IP
.nf
rsync \-avR \-\-rsync\-path="cd /a/b && rsync" host:c/d /e/
.fi
.RE
.IP "\fB\-\-remote\-option=ПАРАМЕТР\fP, \fB\-M\fP"
Цей параметр використовують у складніших ситуаціях, де вам потрібно обмежити
певні речі лише одним кінцем ланцюжка передавання даних. Наприклад, якщо ви
хочете передати \fB\-\-log\-file=ФАЙЛ\fP і \fB\-\-fake\-super\fP на віддалену систему,
вкажіть його так:
.RS 4
.IP
.nf
rsync \-av \-M \-\-log\-file=foo \-M\-\-fake\-super джерело/ призначення/
.fi
.RE
.IP
Якщо вам потрібно, щоб параметр впливав лише на локальний кінець ланцюжка
передавання, якщо зазвичай він впливає на обидва кінці, надішліть його
заперечення на віддалений кінець. Ось так:
.RS 4
.IP
.nf
rsync \-av \-x \-M\-\-no\-x джерело/ призначення/
.fi
.RE
.IP
Будьте з цим обережні, оскільки можна перемкнути параметр, який накаже rsync
змінити обробку даних, які потраплять до сокета, а це може призвести до
незрозумілих помилок у роботі програми.
.IP
Зауважте, що вам слід скористатися окремим параметром \fB\-M\fP для кожного
віддаленого параметра, який ви хочете передати. У застарілих версіях rsync
наявність будь\-яких пробілів в аргументах віддаленого параметра може
спричинити їхній поділ на окремі віддалені аргументи, а у сучасних версіях
rsync для відтворення такої поведінки потрібно вказати параметр
\fB\-\-old\-args\fP.
.IP
При виконанні локального передавання даних «локальним» кінцем є кінець
відправника, а «віддаленим» — кінець отримувача.
.IP
Зауважте, що у деяких версіях бібліотеки для обробки параметрів popt є вада,
яка заважає правильній обробці аргументу параметра у форматі короткої літери
після знаку «дорівнює» (наприклад, \fB\-M\-\-log\-file=/tmp/щось\fP). Якщо ви маєте
справу із такою версією popt у системі, ви можете скористатися версією popt,
яку включено до складу rsync.
.IP "\fB\-\-cvs\-exclude\fP, \fB\-C\fP"
Використання цього параметра буде корисним для виключення широкого діапазону
файлів, які зазвичай не потрібно переносити між системами. Під час роботи з
цим параметром програма використовуватиме той самий алгоритм, який допомагає
CVS визначати файли, які слід ігнорувати.
.IP
Список виключення буде ініціалізовано для виключення вказаних нижче записів
(ці початкові записи буде позначено як придатні до вилучення — див. розділ
ПРАВИЛА ФІЛЬТРУВАННЯ):
.RS 4
.IP
\fBRCS\fP \fBSCCS\fP \fBCVS\fP \fBCVS.adm\fP \fBRCSLOG\fP \fBcvslog.*\fP \fBtags\fP \fBTAGS\fP
\&\fB.make.state\fP \fB.nse_depinfo\fP \fB*~\fP \fB#*\fP \fB.#*\fP \fB,*\fP \fB_$*\fP \fB*$\fP
\fB*.old\fP \fB*.bak\fP \fB*.BAK\fP \fB*.orig\fP \fB*.rej\fP \fB.del\-*\fP \fB*.a\fP \fB*.olb\fP
\fB*.o\fP \fB*.obj\fP \fB*.so\fP \fB*.exe\fP \fB*.Z\fP \fB*.elc\fP \fB*.ln\fP \fBcore\fP \fB.svn/\fP
\&\fB.git/\fP \fB.hg/\fP \fB.bzr/\fP
.RE
.IP
далі, до списку буде додано файли зі списку у $HOME/.cvsignore і усі файли
зі списку у змінній середовища CVSIGNORE (усі назви у cvsignore буде
відокремлено пробілами).
.IP
Нарешті, будь\-який файл буде проігноровано, якщо він перебуває у тому самому
каталозі, що і файл .cvsignore, і відповідає одному із взірців зі списку у
файлі. На відміну від файлів фільтрування/виключення rsync, ці взірці буде
поділено за пробілами. Див. підручник з \fBcvs\fP(1), щоб дізнатися більше.
.IP
Якщо ви поєднуєте \fB\-C\fP із вашими власними правилами \fB\-\-filter\fP, вам слід
зауважити, що ці виключення CVS буде дописано наприкінці ваших власних
правил, незалежно від того, де розташовано \fB\-C\fP у рядку команди. Це робить
їхній пріоритет нижчим за будь\-які правила, які ви вкажете явним чином. Якщо
ви хочете керувати тим, де ці виключення CVS буде вставлено до ваших правил
фільтрування, вам слід уникати \fB\-C\fP як параметра командного рядка і
скористатися поєднанням \fB\-\-filter=:C\fP і \fB\-\-filter=\-C\fP (або у вашому рядку
команди, або додаванням правил «:C» і «\-C» до файла фільтрування із вашими
іншими правилами). Перший варіант вмикає сканування для окремих каталогів
для файла .cvsignore. Другий варіант виконує одноразове імпортування
згаданих вище виключень CVS.
.IP "\fB\-\-filter=ПРАВИЛО\fP, \fB\-f\fP"
За допомогою цього параметра ви зможете додавати правила для вибіркового
виключення певних файлів зі списку для перенесення. Вам варто
використовувати цей параметр разом з параметром рекурсивного перенесення.
.IP
Ви можете скористатися у одному рядку команди довільною кількість параметрів
\fB\-\-filter\fP, якщо хочете побудувати список файлів, які слід виключити. Якщо
у фільтрі міститься пробіл, його має бути взято у лапки, щоб командна
оболонка передала правило до rsync, як єдиний аргумент. У тексті нижче також
згадується, що ви можете скористатися символом підкреслювання, щоб замінити
пробіл, який відокремлює правило від його аргументу.
.IP
Докладний опис цього параметра можна знайти у розділі ПРАВИЛА ФІЛЬТРУВАННЯ.
.IP \fB\-F\fP
Параметр \fB\-F\fP є скороченням для додавання двох правил \fB\-\-filter\fP до вашої
команди. Перше використання цього параметра є скороченням для такого
правила:
.RS 4
.IP
.nf
\-\-filter='dir\-merge /.rsync\-filter'
.fi
.RE
.IP
За допомогою цього параметра можна наказати rsync шукати у кожному з
каталогів файли rsync\-filter, розкидані ієрархією каталогів, і
використовувати визначені у них правила для фільтрування списку файлів для
перенесення. Якщо \fB\-F\fP повторено у команді, він вважається скороченням для
такого правила:
.RS 4
.IP
.nf
\-\-filter='exclude .rsync\-filter'
.fi
.RE
.IP
За допомогою цього параметра можна увімкнути фільтрування самих файлів
\&.rsync\-filter під час перенесення даних.
.IP
Докладний опис того, як ці параметри працюють, можна знайти у розділі
ПРАВИЛА ФІЛЬТРУВАННЯ.
.IP \fB\-\-exclude=ВЗІРЕЦЬ\fP
Цей параметр є спрощеним різновидом параметра \-\-filter, за якого
використовується одне правило виключення, програма не виконуватиме повної
обробки синтаксису звичайних правил фільтрування.
.IP
Докладний опис цього параметра можна знайти у розділі ПРАВИЛА ФІЛЬТРУВАННЯ.
.IP \fB\-\-exclude\-from=ФАЙЛ\fP
Цей параметр пов'язано із параметром \fB\-\-exclude\fP, але він визначає ФАЙЛ, у
якому містяться взірці виключення (по одному на рядок). Порожні рядки у
файлі буде проігноровано, як і коментарі на увесь рядок, які починаються з
«\fB;\fP» або «\fB#\fP» (правила для назв файлів, які містять ці символи не буде
проігноровано).
.IP
Якщо значенням \fIФАЙЛ\fP є «\fB\-\fP», список буде прочитано зі стандартного
джерела вхідних даних.
.IP \fB\-\-include=ВЗІРЕЦЬ\fP
Цей параметр є спрощеним різновидом параметра \fB\-\-filter\fP, за якого
використовується одне правило включення, програма не виконуватиме повної
обробки синтаксису звичайних правил фільтрування.
.IP
Докладний опис цього параметра можна знайти у розділі ПРАВИЛА ФІЛЬТРУВАННЯ.
.IP \fB\-\-include\-from=ФАЙЛ\fP
Цей параметр пов'язано із параметром \fB\-\-include\fP, але він визначає ФАЙЛ, у
якому містяться взірці включення (по одному на рядок). Порожні рядки у файлі
буде проігноровано, як і коментарі на увесь рядок, які починаються з «\fB;\fP»
або «\fB#\fP» (правила для назв файлів, які містять ці символи не буде
проігноровано).
.IP
Якщо значенням \fIФАЙЛ\fP є «\fB\-\fP», список буде прочитано зі стандартного
джерела вхідних даних.
.IP \fB\-\-files\-from=ФАЙЛ\fP
За допомогою цього параметра можна вказати точний список файлів для
передавання (як його прочитано із вказаного ФАЙЛА або «\fB\-\fP», замінника
стандартного джерела вхідних даних). Він також коригує типову поведінку
rsync так, щоб спростити передавання вказаних файлів і каталогів:
.IP
.RS
.IP o
Параметр \fB\-\-relative\fP (\fB\-R\fP) буде встановлено неявним чином. Цей параметр
зберігає дані щодо шляху, які вказано для кожного запису у файлі
(скористайтеся \fB\-\-no\-relative\fP або \fB\-\-no\-R\fP, якщо хочете вимкнути цю
поведінку).
.IP o
Параметр \fB\-\-dirs\fP (\fB\-d\fP) буде встановлено неявним чином. Використання
цього параметра призведе до створення каталогів, які вказано у списку, на
боці призначення, замість пропускання їх без повідомлень (скористайтеся
\fB\-\-no\-dirs\fP або \fB\-\-no\-d\fP, якщо хочете вимкнути цю поведінку).
.IP o
Параметр \fB\-\-archive\fP (\fB\-a\fP) не встановлює неявним чином \fB\-\-recursive\fP
(\fB\-r\fP), тому, якщо вам це потрібно, встановіть цей параметр явно.
.IP o
Ці побіжні ефекти змінюють типовий стан rsync. Отже, розташування параметра
\fB\-\-files\-from\fP у рядку команди не впливає на те, які буде оброблено інші
параметри (наприклад, \fB\-a\fP працює однаково перед і після \fB\-\-files\-from\fP,
як і \fB\-\-no\-R\fP та усі інші параметри).
.RE
.IP
Назви файлів, які буде прочитано з файла ФАЙЛ, вважатимуться відносними щодо
каталогу джерела — будь\-які початкові символи похилої риски буде вилучено, а
посилання «..» на каталог, який перебуває вище у ієрархії за каталог
джерела, буде заборонено. Наприклад, ось така команда:
.RS 4
.IP
.nf
rsync \-a \-\-files\-from=/tmp/щось /usr remote:/backup
.fi
.RE
.IP
Якщо у /tmp/щось міститься рядок «bin» (або навіть «/bin»), каталог /usr/bin
буде створено на віддаленому вузлі як /backup/bin. Якщо у ньому міститься
«bin/» (зверніть увагу на кінцевий символ похилої риски), буде надіслано
також миттєвий вміст каталогу (без потреби у явній згадці у файлі — від
версії 2.6.4). В обох випадках, якщо було увімкнено параметр \fB\-r\fP, буде
передано усю ієрархію каталогу (пам'ятайте, що \fB\-r\fP слід явним чином з
\fB\-\-files\-from\fP, оскільки його не встановлює неявним чином \fB\-a\fP. Також
зауважте, що у результаті використання (типово увімкненого) параметра \fB\-r\fP
буде здубльовано дані щодо шляху, які буде прочитано з файла — примусового
дублювання специфічного для джерела шляху (у нашому прикладі /usr) не буде.
.IP
Крім того, файл \fB\-\-files\-from\fP може бути прочитано з віддаленого вузла,
замість локального вузла, якщо вами вказано «вузол:» перед записом файла
(вузол має відповідати одним із кінців ланцюжка передавання даних). Ви
можете скористатися скороченням, вказавши префікс «:», який означає
«скористатися віддаленим кінцем ланцюжка передавання даних». Приклад:
.RS 4
.IP
.nf
rsync \-a \-\-files\-from=:/шлях/список\-файлів джерело:/ /tmp/копія
.fi
.RE
.IP
Ця команда скопіює усі файли, які вказано у файлі /шлях/список\-файлів, який
збережено на віддаленому вузлі «джерело».
.IP
Якщо вказано параметри \fB\-\-iconv\fP і \fB\-\-protect\-args\fP, і назви файлів
\fB\-\-files\-from\fP надсилають з одного вузла на інший, назви файлів буде
перетворено з набору символів вузла відправника до набору символів вузла
отримувача.
.IP
ЗАУВАЖЕННЯ: упорядкування списку файлів на вході \fB\-\-files\-from\fP допоможе
rsync працювати ефективніше, оскільки програма уникне повторного
відвідування елементів шляху, які є спільними між сусідніми записами. Якщо
вхідний список не упорядковано, деякі елементи шляху (неявні каталоги)
програма може сканувати декілька разів, і rsync, врешті, прибере їхнє
дублювання після перетворення їх в елементи списку файлів.
.IP "\fB\-\-from0\fP, \fB\-0\fP"
Вказує rsync, що правила і назви файлів, які програма прочитає з файла,
завершуються нуль\-символом («\e0»), а не NL, CR або CR+LF. Це стосується
\fB\-\-exclude\-from\fP, \fB\-\-include\-from\fP, \fB\-\-files\-from\fP і усіх об'єднаних
файлів, які вказано у правилі \fB\-\-filter\fP. Це не стосується \fB\-\-cvs\-exclude\fP
(оскільки усі назви, які прочитано з файла .cvsignore, буде поділено за
символом пробілу).
.IP \fB\-\-old\-args\fP
Цей параметр наказує rsync припинити спроби захистити значення аргументів на
віддаленому боці ланцюжка передавання від ненавмисного поділу на слова та
іншої небажаної обробки.
.IP
Типовим у сучасних версіях rsync є екранування «активних» символів командної
оболонки (зокрема пробілів) символом зворотної похилої риски в аргументах,
які буде надіслано до віддаленої оболонки. Символи\-замінники, \fB*\fP, \fB?\fP,
\fB[\fP і \fB]\fP, не буде екрановано у аргументах назв файлів (це уможливлює
розгортання цих символів у декілька назв файлів), але їх буде захищено в
аргументах параметрів, зокрема \fB\-\-usermap\fP.
.IP
Якщо ви маєте скрипт, який використовує поділ аргументів у назвах файлів у
застарілому стилі, вкажіть цей параметр один раз. Якщо у віддаленої оболонки
виникають проблеми із зникненням екранування зворотною похилою рискою,
вкажіть цей параметр двічі.
.IP
Керувати цим параметром можна також за допомогою змінної середовища
\fBRSYNC_OLD_ARGS\fP. Якщо її значенням є «1», rsync типово працюватиме у
режимі одного параметра. Якщо значенням є «2» (або більше число), rsync
типово працюватиме у режимі повторення параметра. Якщо встановлено значення
«0», буде використано типову поведінку щодо екранування. Значення змінної
середовища завжди має нижчий пріоритет за встановлені вручну позитивні чи
негативні параметри рядка команди (негативним є \fB\-\-no\-old\-args\fP).
.IP
Цей параметр конфліктує зі параметром \fB\-\-protect\-args\fP.
.IP "\fB\-\-protect\-args\fP, \fB\-s\fP"
За допомогою цього параметра можна наказати програмі надсилати усіх назви
файлів і більшість параметрів до віддаленого rsync, не дозволяючи віддаленій
оболонці обробляти їх. Символи\-замінники буде розгорнуто на віддаленому
вузлі самою програмою rsync, замість розгортання їх командною оболонкою.
.IP
Подібне до екранування аргументів символом зворотної похилої риски у новому
стилі, яке було додано у версії 3.2.4, але із підтримкою деяких додаткових
можливостей, і без сподівання на екранування символом зворотної похилої
риски у віддаленій командній оболонці.
.IP
Якщо ви скористаєтеся цим параметром у поєднанні із \fB\-\-iconv\fP, аргументи,
які стосуються віддаленого кінця з'єднання, буде також переведено з
локального набору символів (кодування) до віддаленого набору
символів. Перетворення буде виконано до розгортання
символів\-замінників. Див. також параметр \fB\-\-files\-from\fP.
.IP
Цим параметром також можна керувати за допомогою змінної середовища
\fBRSYNC_PROTECT_ARGS\fP. Якщо ця змінна має ненульове значення, типово,
параметр буде увімкнено, якщо ж змінна матиме нульове значення, параметр
типово буде вимкнено. Будь\-який типовий стан можна буде перевизначити вручну
за допомогою позитивної або негативної версії цього параметра у рядку
команди (зауважте, що негативними версіями є \fB\-\-no\-s\fP і
\fB\-\-no\-protect\-args\fP). Також цю змінну середовища можна перевизначити за
допомогою експортування ненульового значення \fBRSYNC_OLD_ARGS\fP.
.IP
Ймовірно, вам варто вимкнути цей параметр при роботі із застарілими версіями
rsync (версіями до 3.0.0).
.IP
Цей параметр конфліктує зі параметром \fB\-\-old\-args\fP.
.IP
Зауважте, що цей параметр є несумісним із використанням скрипту обмеженого
rsync (\fBrrsync\fP), оскільки він приховує параметри від вивчення скриптом.
.IP \fB\-\-copy\-as=КОРИСТУВАЧ[:ГРУПА]\fP
Цей параметр наказує rsync використовувати записи КОРИСТУВАЧ і (якщо вказано
після двокрапки) ГРУПА для дій з копіювання. Працює, лише якщо користувач
запущеної версії rsync має доступ до зміни користувачів. Якщо групу не
вказано, буде використано типові групи користувача.
.IP
За допомогою цього параметра можна знизити ризик виконання дій запущеним від
імені root rsync у каталогах і з каталогів, у яких можуть відбуватися
інтерактивні зміни. Також він може бути корисним для заборони дій з читання
та запису загальносистемних файлів на рівні користувача root. Хоча ви можете
альтернативно запустити увесь rsync від імені вказаного користувача, іноді
вам потрібні будуть реєстраційні дані на рівні root для доступу до вузлів,
тому цей параметр надає змогу rsync скинути привілеї root для копіювальної
частини дії після встановлення з'єднання із віддаленою оболонкою або фоновою
службою.
.IP
Цей параметр впливатиме лише на один з кінців ланцюжка передавання даних,
якщо передавання не є локальним (для локальних передавань він впливатиме на
обидва кінці). Скористайтеся \fB\-\-remote\-option\fP, щоб вплинути на віддалений
кінець, наприклад, так \fB\-M\-\-copy\-as=joe\fP. Для локальних передавань у
допоміжному файлі lsh (або lsh.sh) наведено код допоміжного скрипту, яким
можна скористатися для уможливлення специфікації вузла «localhost:» або
«lh:» без потреби у налаштовуванні віддалених оболонок. Це надає вам змогу
вказати параметри на віддаленому кінці з'єднання, які впливатимуть на кінець
передавання, який використовує специфікації вузла (а використання назви
вузла «lh» надає змогу уникнути перевизначення віддаленого каталогу на
домашній каталог користувача).
.IP
Наприклад, вказана нижче команда rsync записує локальні файли від імені
користувача «joe»:
.RS 4
.IP
.nf
sudo rsync \-aiv \-\-copy\-as=joe host1:backups/joe/ /home/joe/
.fi
.RE
.IP
Робить власником усіх файлів користувача «joe», обмежує групи тими, які
доступні цьому користувачу і робить неможливим для користувача «joe»
використання вразливості, пов'язаної із можливістю внесення змін до файла,
прав на зміну якого користувач «joe» не має.
.IP
Вказана нижче команда виконує локальне копіювання до каталогу «призначення/»
від імені користувача «joe» (припускаємо, що вами встановлено support/lsh до
одного з каталогів у вашій змінній $PATH):
.RS 4
.IP
.nf
sudo rsync \-aive lsh \-M\-\-copy\-as=joe джерело/ lh:призначення/
.fi
.RE
.IP "\fB\-\-temp\-dir=КАТАЛОГ\fP, \fB\-T\fP"
Цей параметр наказує rsync скористатися КАТАЛОГОМ, як тимчасовим каталогом
при створенні тимчасових копій файлів передавання на боці отримання. Типовою
поведінку є створення кожного тимчасового файла у тому самому каталозі, що і
пов'язаний файл призначення. Починаючи з rsync 3.1.1, назви тимчасових
файлів у вказаному КАТАЛОЗІ не матимуть додаткового префікса\-крапки (хоча
програма і додаватиме до їхніх назв випадковий суфікс).
.IP
Цим параметром найчастіше користуються, якщо на розділу диска отримання
даних недостатньо вільного місця для зберігання копії найбільшого файла у
передаванні даних. У цьому випадку (тобто, якщо тимчасовий каталог перебуває
на іншому розділі диска) програма rsync не зможе перейменувати кожен
отриманий тимчасовий файл на місце пов'язаного файла призначення, а повинна
буде скопіювати його на місце. Програма rsync виконує це завдання шляхом
копіювання файла на місце файла призначення, що означає, що під час
копіювання у файлі призначення міститиметься лише частина даних. Якщо цього
не зробити (навіть якщо спочатку вилучити файл призначення, дані було
локально скопійовано до тимчасового файла у каталозі призначення з наступним
перейменуванням), старий файл може продовжувати займати місце на диску (якщо
його відкриє якась програма), і на диску може не вистачити місця для
одночасного зберігання нової версії цього файла.
.IP
Якщо ви користуєтеся цим параметром з причин, не пов'язаних із браком місця
на диску, вам варто поєднати його із параметром \fB\-\-delay\-updates\fP, що
забезпечить розміщення усіх скопійованих файлів у підкаталогах ієрархії
призначення в очікуванні кінця передавання. Якщо у вас недостатньо місця для
дублювання усіх отримуваних файлів на розділі призначення, іншим способом
вказати rsync, що ви не переймаєтеся заощадженням місця на диску, є
використання параметра \fB\-\-partial\-dir\fP із відносним шляхом; оскільки це
повідомляє rsync, що можна збирати копію окремого файла у підкаталозі
ієрархії призначення, rsync використовуватиме частковий каталог, як
тимчасову область для збирання скопійованого файла, а потім
перейменовуватиме файл відповідним чином, щоб він потрапив на
місце. (Визначення \fB\-\-partial\-dir\fP із абсолютним шляхом не має цього
побіжного ефекту.)
.IP "\fB\-\-fuzzy\fP, \fB\-y\fP"
Цей параметр повідомляє програмі rsync, що вона має шукати базовий файл для
будь\-якого файла призначення, якого не вистачає. У поточній реалізації
алгоритму програма виконує пошук у тому самому каталозі, що і файл
призначення, шукаючи файл, який або має такий самий розмір і час внесення
змін, або файл із подібною назвою. Якщо файл буде знайдено, rsync використає
неточний базовий файл у спробі пришвидшити передавання даних.
.IP
Якщо цей параметр буде повторено, неточне сканування також буде виконано у
будь\-яких відповідних альтернативних каталогах призначення, які вказано за
допомогою \fB\-\-compare\-dest\fP, \fB\-\-copy\-dest\fP або \fB\-\-link\-dest\fP.
.IP
Зауважте, що використання параметра \fB\-\-delete\fP може призвести до втрати
потенційних неточно відповідних файлів, тому або скористайтеся
\fB\-\-delete\-after\fP, або вкажіть якісь виключення для назв файлів, якщо хочете
запобігти такому вилученню.
.IP \fB\-\-compare\-dest=КАТАЛОГ\fP
Цей параметр наказує rsync використовувати \fIКАТАЛОГ\fP на комп'ютері
призначення як додаткову ієрархію для порівняння файли призначення із
набором передавання (якщо у каталозі призначення не вистачає якихось
файлів). Якщо буде виявлено файл у \fIКАТАЛОЗІ\fP, який є тотожним до файла на
боці відправника, цей файл НЕ буде передано до каталогу призначення. Корисно
для створення розрідженої резервної копії, яка складається лише з файлів,
які було змінено з моменту попереднього резервного копіювання. Цим
параметром типово користуються для копіювання до порожнього (або
новоствореного) каталогу.
.IP
Починаючи з версії 2.6.4, в одній команді може бути вказано декілька
каталогів \fB\-\-compare\-dest\fP, тобто наказати rsync шукати у відповідному
списку каталогів за вказаним порядком точні відповідники. Якщо буде знайдено
відповідник, який відрізняється лише атрибутами, буде виконано локальне
копіювання і оновлено атрибути. Якщо відповідника не буде знайдено, буде
вибрано базовий файл з одного з \fIКАТАЛОГІВ\fP у спробі пришвидшити
передавання файлів.
.IP
Якщо \fIКАТАЛОГ\fP є відносним шляхом, його буде визначено відносно каталогу
призначення. Див. також \fB\-\-copy\-dest\fP і \fB\-\-link\-dest\fP.
.IP
ЗАУВАЖЕННЯ: починаючи з версії 3.1.0, rsync вилучатиме файл з непорожньої
ієрархії каталогів призначення, якщо буде знайдено точний відповідник в
одній із ієрархій каталогів порівняння (роблячи кінцевий результат ближчим
до свіжої копії).
.IP \fB\-\-copy\-dest=КАТАЛОГ\fP
Використання цього параметра призводить до поведінки, подібної до поведінки
при використанні \fB\-\-compare\-dest\fP, але rsync також скопіює незмінені файли,
які виявлено у \fIКАТАЛОЗІ\fP до каталогу призначення за допомогою локального
копіювання. Це корисно для виконання передавання даних до нового призначення
без внесення змін до наявних файлів із наступним виконанням миттєвого
переведення на нову основу, коли усі файли буде успішно перенесено.
.IP
В одній команді може бути вказано декілька каталогів \fB\-\-copy\-dest\fP, тобто
наказати rsync шукати у відповідному списку каталогів за вказаним порядком
незмінені файли. Якщо відповідника не буде знайдено, буде вибрано базовий
файл з одного з \fIКАТАЛОГІВ\fP у спробі пришвидшити передавання файлів.
.IP
Якщо \fIКАТАЛОГ\fP є відносним шляхом, його буде визначено відносно каталогу
призначення. Див. також \fB\-\-compare\-dest\fP і \fB\-\-link\-dest\fP.
.IP \fB\-\-link\-dest=КАТАЛОГ\fP
Використання цього параметра призводить до поведінки, подібної до поведінки
при використанні \fB\-\-copy\-dest\fP, але незмінені файли буде пов'язано
жорсткими посиланнями з \fIКАТАЛОГУ\fP до каталогу призначення. Файли мають
бути тотожними в усіх збережених атрибутах (зокрема правах доступу, можливо,
власниках), щоб файли було пов'язано посиланнями. Приклад:
.RS 4
.IP
.nf
rsync \-av \-\-link\-dest=$PWD/попередній_каталог вузол:каталог_джерела/ новий_каталог/
.fi
.RE
.IP
Якщо файли не пов'язуються, ретельно перевірте їхні атрибути. Також
перевірте, чи не встановлюються примусово атрибути ззовні від rsync, зокрема
пошукайте параметри монтування, які можуть змінювати root на окремого
користувача або встановлювати для файлів на портативному носії загальні
правила власності (зокрема параметр OS X «Ігнорувати права власності на
цьому томі»).
.IP
Починаючи з версії 26.4, в одній команді може бути вказано декілька
каталогів \fB\-\-link\-dest\fP, тобто наказати rsync шукати у відповідному списку
каталогів за вказаним порядком точні відповідники (передбачено обмеження на
20 таких каталогів). Якщо буде знайдено відповідник, який відрізняється лише
атрибутами, буде виконано локальне копіювання і оновлено атрибути. Якщо
відповідника не буде знайдено, буде вибрано базовий файл з одного з
\fIКАТАЛОГІВ\fP у спробі пришвидшити передавання файлів.
.IP
Цей параметр найкраще працює при копіювання до порожньої ієрархії каталогів
призначення, оскільки для наявних файлів може бути скориговано атрибути, і
це може вплинути на зміну файлів призначення через жорсткі посилання. Крім
того, розпізнавання змін може бути дещо нечітким процесом. Зауважте, що до
версії 3.1.0 точний відповідник у альтернативному каталозі не могло бути
знайдено (і пов'язано із призначенням), якщо файл призначення вже існував.
.IP
Зауважте, що якщо ви поєднуєте цей параметр з \fB\-\-ignore\-times\fP, rsync не
пов'язуватиме посиланнями жодних файлів, оскільки програма пов'язує
посиланнями тотожні файли, використовуючи це, як заміну передавання файла, а
не як додаткову перевірку після оновлення файла.
.IP
Якщо \fIКАТАЛОГ\fP є відносним шляхом, його буде визначено відносно каталогу
призначення. Див. також \fB\-\-compare\-dest\fP і \fB\-\-copy\-dest\fP.
.IP
Зауважте, що у версіях rsync до 2.6.1 була вада, яка могла завадити належній
роботі \fB\-\-link\-dest\fP від імені звичайного користувача, якщо було вказано
\fB\-\-owner\fP (\fB\-o\fP) (можливо, неявним чином). Обійти цю ваду можна униканням
використання параметра \fB\-o\fP (або використанням \fB\-\-no\-o\fP) при надсиланні
даних до застарілої версії rsync.
.IP "\fB\-\-compress\fP, \fB\-z\fP"
З цим параметром rsync стискає дані файлів при надсиланні на комп'ютер
призначення. Це зменшує обсяг даних при передаванні — корисно для повільних
з'єднань.
.IP
У rsync передбачено підтримку декількох способів стискання. Програма
автоматично вибере спосіб стискання, якщо ви не вкажете його явним чином за
допомогою параметра \fB\-\-compress\-choice\fP (\fB\-\-zc\fP).
.IP
Віддайте команду \fBrsync\ \-\-version\fP, щоб переглянути список типових
способів стискання, підтримку яких було зібрано у вашій версії.
.IP
Якщо на обох кінцях ланцюжка передавання даних встановлено принаймні версію
3.2.0, rsync вибиратиме перший алгоритм у списку варіантів клієнта, який є у
списку варіантів сервера. Якщо не буде знайдено спільного варіанта, rsync
завершить роботу повідомленням про помилку. Якщо rsync на віддаленому кінці
ланцюжка передавання є надто старим для підтримки узгодження за контрольними
сумами, його списком вважатиметься «zlib».
.IP
Типовий порядок можна налаштувати встановленням значення змінної середовища
\fBRSYNC_COMPRESS_LIST\fP. Значенням має бути список відокремлених пробілами
прийнятних назв способів стискання. Якщо рядок містить символ «\fB&\fP», його
буде розділено на «рядок клієнта & рядок сервера», якщо рядок не містить
цього символу, його буде застосовано до обох. Якщо рядок (або частина рядка)
не містить непробільних символів, буде використано типовий список способів
стискання. Усі невідомі програмі назви способів стискання буде викинуто зі
списку, але список, що складатиметься лише з некоректних записів призведе до
помилки під час узгодження.
.IP
Існують деякі стані версії rsync, які було налаштовано на відкидання
параметра \fB\-z\fP і обов'язкове використання параметра \fB\-zz\fP, оскільки їхня
бібліотека для стискання була несумісною із типовим способом стискання
zlib. Зазвичай, ви можете ігнорувати ці проблеми, якщо сервер rsync не
скаржиться і не повідомляє вам, що вам слід вказати \fB\-zz\fP.
.IP "\fB\-\-compress\-choice=РЯДОК\fP, \fB\-\-zc=РЯДОК\fP"
Цим параметром можна скористатися для перевизначення автоматичного
узгодження алгоритму стискання, яке відбувається при використанні
\fB\-\-compress\fP. Використання параметра неявним чином встановлює параметр
\fB\-\-compress\fP, якщо не було вказано «none». Якщо вказано «none», буде
неявним чином встановлено \fB\-\-no\-compress\fP.
.IP
Параметри стискання, якими ви можете скористатися, є такими:
.IP
.RS
.IP o
\fBzstd\fP
.IP o
\fBlz4\fP
.IP o
\fBzlibx\fP
.IP o
\fBzlib\fP
.IP o
\fBnone\fP
.RE
.IP
Віддайте команду \fBrsync\ \-\-version\fP, щоб переглянути список типових
способів стискання, підтримку яких було зібрано у вашій версії (список може
відрізнятися від наведеного вище).
.IP
Зауважте, що якщо ви бачите помилку щодо параметра із назвою
\fB\-\-old\-compress\fP або \fB\-\-new\-compress\fP, це означає, що rsync намагається
надіслати параметр \fB\-\-compress\-choice=zlib\fP або \fB\-\-compress\-choice=zlibx\fP
у зворотно сумісний спосіб, який зрозумілий ширшому спектру версій rsync. Це
повідомлення про помилку вказує на те, що застаріла версія rsync на сервері
не дозволить вам примусово встановити тип стискання.
.IP
Зауважте, що алгоритм стискання «zlibx» є простим алгоритмом «zlib» із
виключенням відповідних даних з потоку стискання (щоб зробити його
суміснішим із зовнішньою реалізацією zlib).
.IP "\fB\-\-compress\-level=ЧИСЛО\fP, \fB\-\-zl=ЧИСЛО\fP"
Встановити рівень стискання явними чином (див. \fB\-\-compress\fP, \fB\-z\fP),
замість типового значення. Неявним чином буде встановлено параметр
\fB\-\-compress\fP, якщо вибраним рівнем не є рівень «не стискати» для
використаного алгоритму стискання (наприклад, zlib вважає рівень 0 рівнем
вимикання стискання).
.IP
Значення рівня залежать від вибраної контрольної суми. Оскільки rsync типово
узгоджуватиме варіант контрольної суми (якщо віддалена версія rsync є
достатньо новою), варто поєднати цей параметр з параметром
\fB\-\-compress\-choice\fP (\fB\-\-zc\fP), якщо ви не певні щодо вибраного
варіанта. Приклад:
.RS 4
.IP
.nf
rsync \-aiv \-\-zc=zstd \-\-zl=22 вузол:джерело/ призначення/
.fi
.RE
.IP
Для стискань zlib і zlibx коректними значеннями є цілі числа від 1 до 9,
типовим є 6. Вибір \fB\-\-zl=0\fP вимикає стискання, а визначення \fB\-\-zl=\-1\fP
призводить до вибору типового рівня 6.
.IP
Для стискання zstd коректними значеннями є цілі числа від \-131072 до 22,
типовим є 3. Визначення 0 призводить до вибору типового рівня 3.
.IP
Для способу стискання lz4 не передбачено рівнів, отже, значенням завжди є 0.
.IP
Якщо ви вкажете надто велике або надто мале значення, програма без
повідомлень скоригує його до прийнятного. Ви можете вказати щось подібне до
\fB\-\-zl=999999999\fP і бути певними, що отримаєте максимально можливий рівень,
незалежно від використаного алгоритму.
.IP
Якщо ви хочете дізнатися, яким є поточний рівень стискання, вкажіть параметр
\fB\-\-debug=nstr\fP, щоб переглянути результати щодо «узгодженого
рядка». Програма виведе щось таке: «\fBClient\ compress:\ zstd\ (level\ 3)\fP»
(разом із даними щодо вибраного варіанта контрольної суми).
.IP \fB\-\-skip\-compress=СПИСОК\fP
\fBЗАУВАЖЕННЯ:\fP зміни способу стискання для окремих файлів у поточній версії
не передбачено, тому цей параметр не працюватиме.
.IP
Перевизначити список суфіксів назв файлів, для яких використовуватиметься
якнайменше стискання. Rsync встановлює рівень стискання для окремих файлів
на основі суфікса назви файла. Якщо алгоритмом стискання передбачено рівень
«вимкнути», для таких файлів стискання не виконуватиметься. Для інших
алгоритмів, де передбачено підтримку зміни рівня «на ходу» рівень стискання
буде мінімізовано для зменшення використання процесора для відповідних
файлів.
.IP
\fBСПИСОК\fP має складатися з одного або декількох записів суфіксів файлів (без
крапки), які відокремлено один від одного символами похилої риски (\fB/\fP). Ви
можете вказати порожній рядок, щоб вказати програмі, що не слід пропускати
жодних файлів.
.IP
Передбачено підтримку простого встановлення відповідності за класами
символів: кожен запис класу має складатися зі списку літер у квадратних
дужках (наприклад, не передбачено підтримки спеціальних класів, зокрема
«[:alpha:]», а «\-» не має особливого значення).
.IP
Символи зірочки (\fB*\fP) і знака питання (\fB?\fP) не мають особливого значення.
.IP
Ось приклад, який задає 6 суфіксів, які слід пропускати (оскільки перше з
п'яти правил відповідає двом суфіксам):
.RS 4
.IP
.nf
\-\-skip\-compress=gz/jpg/mp[34]/7z/bz2
.fi
.RE
.IP
Типовими суфіксами у списку вимикання стискання у цій версії rsync є такі:
.RS 4
.IP
3g2 3gp 7z aac ace apk avi bz2 deb dmg ear f4v flac flv gpg gz iso jar jpeg
jpg lrz lz lz4 lzma lzo m1a m1v m2a m2ts m2v m4a m4b m4p m4r m4v mka mkv mov
mp1 mp2 mp3 mp4 mpa mpeg mpg mpv mts odb odf odg odi odm odp ods odt oga ogg
ogm ogv ogx opus otg oth otp ots ott oxt png qt rar rpm rz rzip spx squashfs
sxc sxd sxg sxm sxw sz tbz tbz2 tgz tlz ts txz tzo vob war webm webp xz z
zip zst
.RE
.IP
Цей список буде замінено вашим списком \fB\-\-skip\-compress\fP в усіх випадках,
окрім одного: копіювання з фонової служби rsync додасть ваші суфікси для
пропускання до її списку файлів, які не слід стискати (а список фонової
служби можна налаштувати на інше типове значення).
.IP \fB\-\-numeric\-ids\fP
Якщо використано цей параметр, rsync передаватиме числові ідентифікатори
групи і користувача, а не назви групи і користувача, і виконуватиме
прив'язку цих значень на обох кінцях ланцюжка передавання даних.
.IP
Типово, rsync використовуватиме назву запису користувача і назву групи для
визначення прав власності, які слід надати файлам. Особливі значення
ідентифікатора користувача 0 і особливу групу ніколи не буде пов'язано із
назвами записів користувачів і груп, навіть якщо не вказано параметр
\fB\-\-numeric\-ids\fP.
.IP
Якщо у запису користувача або групи у системі джерела немає назв або немає
відповідників у системі призначення, буде використано числовий ідентифікатор
з системи джерела. Див. також параметр \fBuse\ chroot\fP на сторінці підручника
rsyncd.conf, де наведено коментарі щодо того, як параметр chroot впливає на
можливість rsync шукати назви записів користувачів і груп, і те, що ви
можете з цим зробити.
.IP "\fB\-\-usermap=РЯДОК\fP, \fB\-\-groupmap=РЯДОК\fP"
Ці параметри надають вам змогу вказати користувачів і групи, які має бути
прив'язано до інших значень на боці отримання. Значенням \fBРЯДОК\fP є один або
декілька записів \fBЗВІДКИ\fP:\fBКУДИ\fP, які відокремлено комами. Будь\-яке
відповідне значення \fBЗВІДКИ\fP з боку відправника буде замінено на значення
\fBКУДИ\fP з боку отримувача. Ви можете вказати імена користувачів або
ідентифікатори, як значення \fBЗВІДКИ\fP і \fBКУДИ\fP, а значенням \fBЗВІДКИ\fP може
бути рядок із символами\-замінниками, відповідність якого іменам на боці
відправника встановлюватиме програма (відповідність НЕ встановлюватиметься
за номерами ідентифікаторів, хоча, як зауважено нижче, «\fB*\fP» відповідає
будь\-якому запису). Замість використання символів\-замінників для
ідентифікаторів ви можете вказати діапазон чисел ідентифікаторів із
включенням значень на межі діапазону: НИЖНІЙ\-ВЕРХНІЙ. Приклад:
.RS 4
.IP
.nf
\-\-usermap=0\-99:nobody,wayne:admin,*:normal \-\-groupmap=usr:1,1:usr
.fi
.RE
.IP
Програма використає перший же знайдений відповідник у списку. Вам слід
вказати усі ваші прив'язки користувачів за допомогою одного параметра
\fB\-\-usermap\fP, а усі ваші прив'язки груп — за допомогою одного параметра
\fB\-\-groupmap\fP.
.IP
Зауважте, що ім'я відправника для користувача і групи 0 не буде перенесено
на бік отримувача. Тому вам слід або встановити відповідність цих значень з
використанням ідентифікатора 0, або скористатися відповідними іменами на
боці отримувача (типово, «root»). Усім іншим іменам \fBЗВІДКИ\fP буде
поставлено у відповідність використані на боці відправника імена. Усім
іменам \fBКУДИ\fP буде поставлено у відповідність імена, які використано на
боці отримання.
.IP
У сенсі відповідності, будь\-які ідентифікатори, яким не відповідають імена
на боці надсилання, буде оброблено як порожні. Це надає змогу
використовувати їх, як відповідники «\fB*\fP» або порожнього імені. Приклад:
.RS 4
.IP
.nf
\-\-usermap=:nobody \-\-groupmap=*:nobody
.fi
.RE
.IP
Якщо використано параметр \fB\-\-numeric\-ids\fP, відправник не надсилатиме жодних
імен, отже усі ідентифікатори вважатимуться такими, що відповідають
порожньому імені. Це означає, що вам потрібно вказати числові значення
\fBЗВІДКИ\fP, якщо ви хочете пов'язати ці безіменні ідентифікатори з іншими
значеннями.
.IP
Щоб параметр \fB\-\-usermap\fP спрацював, програму на боці отримувача має бути
запущено від імені надкористувача (див. також параметри \fB\-\-super\fP і
\fB\-\-fake\-super\fP). Щоб спрацював параметр \fB\-\-groupmap\fP, програма на боці
отримувача повинна мати права доступ до встановлення цієї групи.
.IP
Починаючи з версії rsync 3.2.4, параметр \fB\-\-usermap\fP неявним чином
встановлює параметр \fB\-\-owner\fP (\fB\-o\fP), а параметр \fB\-\-groupmap\fP — параметр
\fB\-\-group\fP (\fB\-g\fP) (оскільки rsync потрібні ці параметри для того, щоб
працювали параметри прив'язки).
.IP
Для застарілих клієнтів rsync може знадобитися використання
\fB\-\-protect\-args\fP (\fB\-s\fP), щоб уникнути скарг програми на використання
символів\-замінників, а сучасні версії rsync обробляють такі символи
автоматично.
.IP \fB\-\-chown=USER:GROUP\fP
Цей параметр примусово встановлює для усіх файлів належність користувачу
КОРИСТУВАЧ із групою ГРУПА. Це простіший інтерфейс, за безпосереднє
використання \fB\-\-usermap\fP і \fB\-\-groupmap\fP, але його реалізовано за допомогою
цих параметрів на внутрішньому рівні, тому ці параметри можна
поєднувати. Якщо якесь із значень, КОРИСТУВАЧ або ГРУПА є порожнім,
прив'язка для пропущеної групи або користувача не виконуватиметься. Якщо
значення ГРУПА є порожнім, кінцеву двокрапку можна пропустити, але якщо
порожнім є значення КОРИСТУВАЧ, початкову двокрапку слід вказувати.
.IP
Якщо ви вкажете «\fB\-\-chown=щось:десь\fP», це буде точно те саме, що вказати
«\fB\-\-usermap=*:щось\ \-\-groupmap=*:десь\fP», але простіше (із тим самим неявним
встановленням параметрів \fB\-\-owner\fP і/або \fB\-\-group\fP).
.IP
Для застарілих клієнтів rsync може знадобитися використання
\fB\-\-protect\-args\fP (\fB\-s\fP), щоб уникнути скарг програми на використання
символів\-замінників, а сучасні версії rsync обробляють такі символи
автоматично.
.IP \fB\-\-timeout=СЕКУНДИ\fP
За допомогою цього параметра ви можете встановити максимальний час
очікування на введення\-виведення у секундах. Якщо протягом вказаного
проміжку часу не відбуватиметься передавання даних, rsync завершить
роботу. Типовим значенням є 0 — тобто, ніякого часу очікування.
.IP \fB\-\-contimeout=СЕКУНДИ\fP
За допомогою цього параметра ви можете встановити час, протягом якого rsync
очікуватиме на встановлення з'єднання із фоновою службою rsync. Якщо буде
перевищено час очікування, rsync завершить роботу із повідомленням про
помилку.
.IP \fB\-\-address=АДРЕСА\fP
Типово, rsync виконуватиме прив'язку до адреси із символами\-замінниками при
з'єднанні із фоновою службою rsync. Параметр \fB\-\-address\fP надає вам змогу
вказати певну IP\-адресу (або назву вузла), до якої слід прив'язатися.
.IP
Див. також версію для фонової служби параметра \fB\-\-address\fP.
.IP \fB\-\-port=ПОРТ\fP
Цей параметр визначає альтернативний номер порту TCP, яким слід скористатися
замість типового порту 873. Цей параметр може знадобитися, лише якщо ви
користуєтеся синтаксичною конструкцією із подвійною двокрапкою (::) для
встановлення з'єднання із фоновою службою rsync (оскільки у синтаксичній
конструкції із адресою можна вказати порт, як частину адреси).
.IP
Див. також версію для фонової служби параметра \fB\-\-port\fP.
.IP \fB\-\-sockopts=ПАРАМЕТРИ\fP
Цей параметр має відкрити нескінченні можливості для тих, хто намагається
скоригувати роботу своєї системи так, щоб усе працювало ідеально. Ви можете
встановити будь\-які параметри сокета, які можуть зробити передавання даних
швидшим (або повільнішим!). Ознайомтеся із сторінкою підручника щодо
системного виклику \fBsetsockopt()\fP, щоб дізнатися більше про деякі параметри
сокета, які ви можете встановити. Типово, ніяких особливих параметрів сокета
програма не встановлює. Цей параметр впливає лише на безпосередні з'єднання
сокетом із віддаленою фоновою службою rsync.
.IP
Див. також версію для фонової служби параметра \fB\-\-sockopts\fP.
.IP \fB\-\-blocking\-io\fP
Цей параметр наказує rsync скористатися введенням\-виведенням із блокуванням
при запуску передавання даних до віддаленої командної оболонки. Якщо
віддаленою оболонкою є rsh або remsh, rsync типово використовуватиме
введення\-виведення із блокуванням. Якщо ж це не так, типово буде використано
введення\-виведення без блокування. (Зауважте, що пріоритетним у ssh є
введення\-виведення без блокування.)
.IP \fB\-\-outbuf=РЕЖИМ\fP
Встановлює режим буферизації виведення. Значенням режиму може бути None (без
буферизації або Unbuffered), Line або Block (або повна буферизація або
Full). Ви можете вказати одну літеру для визначення режиму, у верхньому або
нижньому регістрі.
.IP
Основним призначенням цього параметра є зміна повної буферизації на
буферизацію рядків (Line), коли виведення rsync відбувається до файла або
каналу передавання даних.
.IP "\fB\-\-itemize\-changes\fP, \fB\-i\fP"
Надсилає запит щодо простого списку змін, які було внесено до кожного з
файлів, включно зі зміною атрибутів. Це те саме, що вказати
\fB\-\-out\-format='%i\ %n%L'\fP. Якщо повторити параметр в одному рядку команди,
буде також виведено список файлів, які не було змінено, але лише якщо
версією rsync на боці отримувача є принаймні 2.6.7 (ви можете скористатися
\fB\-vv\fP зі старішими версіями rsync, але це також увімкне виведення інших
докладних повідомлень).
.IP
Екранована послідовність «%i» дає не зовсім зрозумілий результат, який
складається з 11 літер. Загальний формат подібний до рядка \fBYXcstpoguax\fP,
де \fBY\fP буде замінено на тип виконаного оновлення, \fBX\fP буде замінено на тип
файла, а інші літери відповідають атрибутам, які може бути виведено, якщо їх
було змінено.
.IP
Типи оновлень, які замінюють \fBY\fP, є такими:
.IP
.RS
.IP o
\fB<\fP означає, що файл передається на віддалений вузол (надіслано).
.IP o
\fB>\fP означає, що файл передається на локальний вузол (отримано).
.IP o
\fBc\fP означає, що із об'єктом відбулися локальні зміни/створення (зокрема
створення каталогу або зміна символічного посилання тощо).
.IP o
\fBh\fP означає, що об'єкт є жорстким посиланням на інших об'єкт (потребує
\fB\-\-hard\-links\fP).
.IP o
\&\fB.\fP означає, що об'єкт не було оновлено (хоча, можливо, його атрибути було
змінено).
.IP o
\fB*\fP означає, що решта виведення у пункті є повідомленням (наприклад,
«deleting» (вилучаємо)).
.RE
.IP
Типами файлів, які замінюють \fBX\fP, є такі: \fBf\fP — файл, \fBd\fP — каталог, \fBL\fP
— символічне посилання, \fBD\fP — пристрій і \fBS\fP — особливий файл (наприклад
іменований сокет або fifo).
.IP
Інші літери у рядку вказують на те, чи було змінено якість атрибути файла,
ось так:
.IP
.RS
.IP o
«\fB.\fP» — атрибут не було змінено.
.IP o
«\fB+\fP» — файл було створено наново.
.IP o
«\fB\ \fP» — усі атрибути лишатимуться незмінними (усі крапки буде перетворено
на пробіли).
.IP o
«\fB?\fP» — зміна є невідомою (якщо віддалений rsync є застарілим).
.IP o
Літера вказує на оновлення атрибута.
.RE
.IP
Атрибути, які пов'язано із кожною з літер, є такими:
.IP
.RS
.IP o
\fBc\fP означає або те, що звичайний файл має іншу контрольну суму (потребує
\fB\-\-checksum\fP), або що символічне посилання, пристрій або особливий файл має
змінене значення. Зауважте, що якщо ви надсилаєте файли до rsync до версії
3.0.1, цей прапорець зміни буде показано лише для звичайних файлів із іншою
контрольною сумою.
.IP o
\fBs\fP означає, що розмір звичайного файла відрізняється, і його буде оновлено
під час передавання файла.
.IP o
\fBt\fP означає різні часи внесення змін із оновленням на значення з боку
відправника (потребує \fB\-\-times\fP). Альтернативне значення \fBT\fP означає, що
для часу внесення змін буде встановлено значення моменту передавання даних,
що трапляється при оновленні файла, символічного посилання або пристрою без
\fB\-\-times\fP і коли символічне посилання змінено, а отримувач не може
встановити його час. (Зауваження: при використанні клієнта rsync 3.0.0, ви
можете побачити поєднання прапорця \fBs\fP із \fBt\fP, замість належного прапорця
\fBT\fP для цієї помилки при встановленні часу.)
.IP o
\fBp\fP означає, що різними є права доступу, і їх буде оновлено за значенням
відправника (потребує \fB\-\-perms\fP).
.IP o
\fBo\fP означає, що різними є власники, і їх записи буде оновлено за значенням
відправника (потребує \fB\-\-owner\fP і прав доступу надкористувача).
.IP o
\fBg\fP означає, що група є різною, і її буде оновлено за значенням з боку
відправника (потребує \fB\-\-group\fP і уповноваження на встановлення групи).
.IP o
.IP
.RS
.IP o
\fBu\fP|\fBn\fP|\fBb\fP вказує на такі відомості:

\fBu\fP означає, що різним є час доступу (використання), і цей час буде
оновлено за значенням з боку відправника (потребує \fB\-\-atimes\fP)
.IP o
\fBn\fP означає, що різним є час створення (новизна), і цей час буде оновлено
за значенням з боку відправника (потребує \fB\-\-crtimes\fP)
.IP o
\fBb\fP означає, що різними є як час доступу, так і час створення, і обидва ці
значення буде оновлено
.RE
.IP o
\fBa\fP означає, що буде змінено дані ACL.
.IP o
\fBx\fP означає, що буде змінено дані розширених атрибутів.
.RE
.IP
Можливим є інше виведення: при вилученні файлів результатом застосування
«%i» є виведення рядка «\fB*deleting\fP» для кожного об'єкта, який вилучають
(припускаємо, що обговорюємо досттаньо нову версію rsync, яка записує до
журналу вилучення замість виведення повідомлень про них у докладному режимі
повідомлень).
.IP \fB\-\-out\-format=ФОРМАТ\fP
Надає вам змогу вказати точно, що клієнт rsync виводитиме до користувача для
окремих оновлень. ФОРМАТ — текстовий рядок, що містить вбудовані однолітерні
керівні послідовності із префіксом — символом відсотків (%). Типовий формат
«%n%L» буде використано, якщо буде вказано або \fB\-\-info=назва\fP, або \fB\-v\fP
(дає вам лише назву файла і, якщо це посилання, на що воно вказує). Із
повним списком можливих керівних символів можна ознайомитися в описів
параметра \fBlog\ format\fP на сторінці підручника rsyncd.conf.
.IP
Визначення параметра \fB\-\-out\-format\fP неявним чином встановлює параметр
\fB\-\-info=назва\fP, який призведе до виведення даних для кожного файла,
каталогу тощо, які було значно оновлено (переданий файл, повторно створене
символічне посилання або пристрій, змінений каталог). Крім того, якщо до
рядка буде включено керівну послідовність списку змін (%i) (наприклад, якщо
було використано параметр \fB\-\-itemize\-changes\fP), обсяг запису до журналу
буде збільшено шляхом додавання усіх записів, які було хоч якось змінено
(якщо на боці отримання встановлено принаймні версію 2.6.4
програми). Див. параметр \fB\-\-itemize\-changes\fP, щоб ознайомитися із описом
виведення «%i».
.IP
Rsync виводитиме рядок форматування виведення до передавання файла, якщо не
використано одну з керівних послідовностей статистики передавання. Якщо таку
послідовність використано, запис до журналу буде виконано наприкінці
передавання файла. Якщо працює це пізнє записування до журналу, і також
вказано \fB\-\-progress\fP, rsync також виводитиме назву файла, який передається,
до даних щодо поступу передавання (звичайно ж, із наступним виведенням у
форматуванні виведення).
.IP \fB\-\-log\-file=ФАЙЛ\fP
Використання цього параметра призведе до запису до журналу дій щодо файла,
які виконує rsync. Записування подібне до того, яке виконує фонова служба,
але запит щодо нього можна надсилати з блоку клієнта і/або сервера для
передавання, не пов'язаного із фоновою службою. Якщо вказано як параметр
клієнта, запис передавання до журналу буде увімкнено із типовим
форматуванням «%i %n%L». Див. параметр \fB\-\-log\-file\-format\fP, якщо хочете
перевизначити цю поведінку.
.IP
Ось приклад команди, яка просить віддалений кінець з'єднання записувати до
журналу події, які відбуваються:
.RS 4
.IP
.nf
rsync \-av \-\-remote\-option=\-\-log\-file=/tmp/rlog джерело/ призначення/
.fi
.RE
.IP
Це дуже корисно, якщо вам потрібно дізнатися, чому з'єднання неочікувано
розірвано.
.IP
Див. також версію для фонової служби параметра \fB\-\-log\-file\fP.
.IP \fB\-\-log\-file\-format=ФОРМАТ\fP
Надає вам змогу вказати точно, що буде записано до журналу у файлі,
вказаному за допомогою параметра \fB\-\-log\-file\fP (який також має бути
встановлено, щоб цей параметр запрацював). Якщо ви вкажете порожній рядок,
оновлені файли не буде згадано у файлі журналу. Щоб ознайомитися зі списком
можливих керівних символів, зверніться до опису параметра \fBlog\ format\fP на
сторінці підручника щодо rsyncd.conf.
.IP
Типовий ФОРМАТ, якщо вказано \fB\-\-log\-file\fP і значенням цього параметра не є
«%i %n%L».
.IP
Див. також версію для фонової служби параметра \fB\-\-log\-file\-format\fP.
.IP \fB\-\-stats\fP
Наказує rsync виводити докладний набір статистики щодо передавання
файлів. Це надасть вам змогу визначити, наскільки ефективним є алгоритм
дельта\-передавання rsync для ваших даних. Цей параметр є тотожним до
\fB\-\-info=stats2\fP, якщо його поєднано із 0 або 1 параметром \fB\-v\fP, або
\fB\-\-info=stats3\fP, якщо поєднано із 2 або декількома параметрами \fB\-v\fP.
.IP
Поточна статистика є такою:
.IP
.RS
.IP o
\fBNumber\ of\ files\fP — кількість усіх «файлів» (у загальному сенсі), до якої
включено каталоги, символічні посилання тощо. За загальною кількістю буде
вказано список кількостей за типом файлів (якщо загальна кількість є
ненульовою). Приклад: «(reg: 5, dir: 3, link: 2, dev: 1, special: 1)» є
даними щодо звичайних файлів, каталогів, символічних посилань, пристроїв та
особливих файлів. Якщо якесь зі значень є нульовим, його у списку буде
пропущено.
.IP o
\fBNumber\ of\ created\ files\fP — кількість «файлів» (у загальному сенсі), які
було створено (а не оновлено). Після загальної кількості буде вказано список
кількостей за типами файлів (якщо загальна кількість є ненульовою).
.IP o
\fBNumber\ of\ deleted\ files\fP — кількість «файлів» (у загальному сенсі), які
було вилучено. Після загальної кількості буде вказано список кількостей за
типами файлів (якщо загальна кількість є ненульовою). Зауважте, що цей рядок
буде виведено, лише якщо задіяно вилучення, і лише якщо використано протокол
31 (типовий протокол для версій, починаючи з rsync 3.1.x).
.IP o
\fBNumber\ of\ regular\ files\ transferred\fP — кількість звичайних файлів, які
було оновлено за алгоритмом дельта\-передавання rsync, до якого не буде
включено каталоги, символічні посилання тощо. Зауважте, що у rsync 3.1.0
додано слово «regular» до цього заголовка.
.IP o
\fBTotal\ file\ size\fP — загальна сума розмірів усіх файлів у
передаванні. Сюди не буде включено розміри каталогів та особливих файлів,
але включено розмір символічних посилань.
.IP o
\fBTotal\ transferred\ file\ size\fP — загальна сума розмірів усіх файлів для
щойно переданих файлів.
.IP o
\fBLiteral\ data\fP — об'єм невідповідних даних щодо оновлення файлів, які
довелося надіслати на бік отримання, щоб відтворити оновлені файли.
.IP o
\fBMatched\ data\fP — об'єм даних, який отримувача отримав локально при
відтворенні оновлених файлів.
.IP o
\fBFile\ list\ size\fP — наскільки великим був об'єм даних списку файлів при
надсиланні з відправника до отримувача. Цей об'єм є меншим за розмір списку
файлів у пам'яті через певне стискання дубльованих даних при надсиланні
списку за допомогою rsynct.
.IP o
\fBFile\ list\ generation\ time\fP — кількість секунд, які відправник витратив
на створення списку файлів. Це потребує сучасного rsync на боці відправника,
щоб цей рядок було показано.
.IP o
\fBFile\ list\ transfer\ time\fP — кількість секунд, які відправник витратив на
надсилання списку файлів до отримувача.
.IP o
\fBTotal\ bytes\ sent\fP — кількість усіх байтів, які програма rsync надіслала
з боку клієнта на бік сервера.
.IP o
\fBTotal\ bytes\ received\fP — кількість байтів, не пов'язаних із
повідомленнями, які програма rsync отримана на боці клієнта з боку
сервера. «Не пов'язані із повідомленнями» означає, що до цього числа не буде
включено байти з докладних повідомлень, які сервер надсилає отримувачу. Це
робить статистику узгодженішою.
.RE
.IP "\fB\-\-8\-bit\-output\fP, \fB\-8\fP"
Наказує rsync не екранувати усі високобітові символи у виведенні, замість
спроби перевірити їх на коректність у поточній локалі і екранування
некоректних. Усі керівні символи (але не табуляції) буде екрановано завжди,
незалежно від того, чи встановлено цей параметр.
.IP
Ідіома екранування, яку було започатковано у версії 2.6.7, є виведенням
самого символу зворотної похилої риски (\fB\e\fP) і решітки (\fB#\fP), після яких
має бути вказано 3 вісімкових цифри. Наприклад, символ нового рядка буде
виведено як «\fB\e#012\fP». Сам символ зворотної похилої риски, який є частиною
назви файла, не екранується, якщо після нього не вказано символу решітки і 3
цифр (0\-9).
.IP "\fB\-\-human\-readable\fP, \fB\-h\fP"
Виводити числа у зручнішому для читання форматі. Передбачено 3 можливі
рівні:
.RS
.IP
.IP 1.
виводити числа із роздільником між кожним набором з 3 цифр (комою або
крапкою, залежно від того, яким є десятковий розділювач, крапкою чи комою).
.IP 2.
виводити числа у одиницях 1000 (із символьним суфіксом для більших одиниць\ \-\- див. нижче).
.IP 3.
виводити числа у одиницях 1024.
.RE
.IP
Типовим є рівень зручності читання 1. Кожен параметр \fB\-h\fP збільшує рівень
на одиницю. Ви можете знизити рівень до 0 (щоб числа було виведено як
звичайні цифри), вказавши параметр \fB\-\-no\-human\-readable\fP (\fB\-\-no\-h\fP).
.IP
Літерами одиниць, які буде дописано на рівнях 2 і 3, є такими: \fBK\fP (кіло),
\fBM\fP (мега), \fBG\fP (гіга), \fBT\fP (тера) або \fBP\fP (пета). Наприклад, для файла
розміром у 1234567 байтів може бути виведено 1.23M на рівні 2 (припускаючи,
що крапка є десятковим розділювачем вашої локалі).
.IP
Зауваження щодо зворотної сумісності: у версіях rsync до 3.1.0 не
передбачено підтримки рівня зручності читання 1, у них типовим є рівень
0. Отже, використання одного або двох параметрів \fB\-h\fP призведе до подібної
поведінки у старих і нових версіях, якщо вами не було вказано параметр
\fB\-\-no\-h\fP до одного або декількох параметрів \fB\-h\fP. Див. \fB\-\-list\-only\fP, щоб
дізнатися більше про одну відмінність.
.IP \fB\-\-partial\fP
Типово, у разі переривання перенесення даних rsync вилучатиме всі частково
перенесені файли. За певних обставин може виникнути потреба у збереженні цих
частково перенесених файлів. За допомогою параметра \fB\-\-partial\fP ви можете
наказати rsync зберігати частково перенесені файли. Це пришвидшить
перенесення файлів під час наступної спроби.
.IP \fB\-\-partial\-dir=КАТАЛОГ\fP
Цей параметр змінює поведінку у відповідь на використання параметра
\fB\-\-partial\fP з неявним припущенням, що його увімкнено. Цей удосконалений
спосіб часткового передавання файлів призводить до розташування частково
переданих файлів у вказаному \fIКАТАЛОЗІ\fP, замість запису частково переданих
файлів до файла призначення. При наступному передаванні rsync використає
файл, знайдений у цьому каталозі як дані для пришвидшення відновлення
передавання, а потім вилучить його після того, як він виконає своє завдання.
.IP
Зауважте, що якщо вказано \fB\-\-whole\-file\fP (або встановлено неявним чином),
будь\-які файли, які буде знайдено у каталозі часткових даних і які має бути
оновлено, буде просто вилучено (оскільки rsync надсилає файли без
використання алгоритму дельта\-передавання rsync).
.IP
Rsync створить \fIКАТАЛОГ\fP, якщо його ще немає, але лише останній каталог в
ієрархії\ \-\- не увесь шлях. Це спрощує використання відносного шляху
(зокрема «\fB\-\-partial\-dir=.rsync\-partial\fP») для створення rsync каталогу
часткових даних у каталозі файла призначення, якщо це потрібно, а потім
вилучення цього каталогу, коли буде вилучено частковий файл. Зауважте, що це
вилучення каталогу буде виконано для відносного шляху, оскільки вважається,
що абсолютний шлях призначено для каталогу, який зарезервовано для обробки
partial\-dir.
.IP
Якщо значенням partial\-dir не є абсолютний шлях, rsync додасть правило
виключення наприкінці усіх ваших наявних виключень. Це правило запобігатиме
надсиланню будь\-яких файлів у partial\-dir, які можуть міститися на боці
надсилання, а також запобігатиме невчасному вилученню записів partial\-dir на
боці отримання. Приклад: наведений вище параметр \fB\-\-partial\-dir\fP додасть
еквівалент цього «тимчасового» виключення наприкінці усіх інших правил
фільтрування: \fB\-f\ '\-p\ .rsync\-partial/'\fP
.IP
Якщо ви надаєте ваші власні правила виключення, вам, можливо, варто додати
ваше власне правило виключення, приховування або захисту для partial\-dir
через такі причини:
.RS
.IP
.IP 1.
автоматично додане правило може не спрацювати наприкінці ваших інших правил
або
.IP 2.
вам знадобиться перевизначення варіантів виключення, встановлених rsync.
.RE
.IP
Наприклад, якщо ви хочете, щоб програма rsync вилучала усі лишки часткових
каталогів, вам слід вказати \fB\-\-delete\-after\fP і додати правило фільтрування
«risk», наприклад, \fB\-f\ 'R\ .rsync\-partial/'\fP. Уникайте використання
\fB\-\-delete\-before\fP або \fB\-\-delete\-during\fP, якщо ви не хочете, щоб програма
rsync використовувала лишки даних у каталозі часткових даних під час
поточного запуску.
.IP
ВАЖЛИВО: \fB\-\-partial\-dir\fP має бути непридатним до запису для інших
користувачів, інакше це завадить безпеці у системі! Наприклад, УНИКАЙТЕ
«/tmp»!
.IP
Ви також можете встановити значення partial\-dir за допомогою змінної
середовища \fBRSYNC_PARTIAL_DIR\fP. Встановлення цієї змінної у середовищі не
призведе до примусового вмикання \fB\-\-partial\fP, а лише впливає на те, ще
зберігатимуться часткові файли, якщо вказано \fB\-\-partial\fP. Наприклад,
замість використання \fB\-\-partial\-dir=.rsync\-tmp\fP разом із \fB\-\-progress\fP, ви
можете встановити \fBRSYNC_PARTIAL_DIR=.rsync\-tmp\fP у вашому середовищі, а
потім скористатися параметром \fB\-P\fP для вмикання використання каталогу
\&.rsync\-tmp для часткових передавань. Єдиними випадками, коли використання
параметра \fB\-\-partial\fP не призведе до пошуку цього значення середовища, є
такі:
.RS
.IP
.IP 1.
якщо було вказано \fB\-\-inplace\fP (оскільки \fB\-\-inplace\fP конфліктує з
\fB\-\-partial\-dir\fP) і
.IP 2.
якщо було вказано \fB\-\-delay\-updates\fP (див. нижче).
.RE
.IP
Коли сучасна версія rsync відновлює передавання файла у каталозі часткових
даних, цей частковий файл буде оновлено на місці замість створення ще однієї
копії тимчасового файла (отже, максимально матимемо призначення +
тимчасовий, замість призначення + частковий + тимчасовий). Це потребує, щоб
на обох кінцях з'єднання було встановлено принаймні версію 3.2.0.
.IP
Для параметра «\fBrefuse\ options\fP» у налаштуваннях фонової служби
\fB\-\-partial\-dir\fP \fIне\fP встановлює явним чином \fB\-\-partial\fP. Таким чином,
відмовою від використання параметра \fB\-\-partial\fP можна скористатися для
заборони перезапису файлів призначення за допомогою часткового передавання,
але з уможливленням безпечнішої ідіоми, яка надається параметром
\fB\-\-partial\-dir\fP.
.IP \fB\-\-delay\-updates\fP
Використання цього параметра призводить до зберігання тимчасового файла для
кожного оновлено файла до каталогу зберігання до кінця передавання даних із
наступним перейменовуванням файлів до нового місця. Це робить оновлення
файлів дещо більше атомарним. Типово, файли буде розташовано у підкаталозі
із назвою \fB.~tmp~\fP у кожному з каталогів призначення, але якщо вами було
вказано параметр \fB\-\-partial\-dir\fP, буде використано вказаний в аргументі до
цього параметра каталог. Див. коментарі у розділі щодо \fB\-\-partial\-dir\fP, щоб
ознайомитися із тим, як цей каталог \fB.~tmp~\fP буде виключено з передавання
даних, і тим, що ви можете зробити, якщо хочете, щоб програма rsync вилучала
застарілі зайві каталоги \fB.~tmp~\fP. Параметр не можна використовувати разом
із \fB\-\-inplace\fP і \fB\-\-append\fP.
.IP
Цей параметр неявним чином встановлює \fB\-\-no\-inc\-recursive\fP, оскільки він
потребує повного списку файлів у пам'яті, щоб мати змогу виконувати ітерацію
списком.
.IP
Використання цього параметра призводить до збільшення споживання пам'яті на
боці отримання (на один біт для кожного переданого файла), а також потребує
достатньо вільного місця на боці отримання для зберігання додаткової копії
усіх оновлених файлів. Також зауважте, що вам не слід використовувати
абсолютний шлях до \fB\-\-partial\-dir\fP, якщо не виконуються такі умови:
.RS
.IP
.IP 1.
у наборі файлів передавання немає файлів із однаковими назвами (оскільки усі
оновлені файли буде збережено до одного каталогу, якщо шлях є абсолютним);
.IP 2.
у ієрархії каталогів немає точок монтування (оскільки відкладені оновлення
зазнають невдачі, якщо їх не можна буде перейменувати до остаточного місця
зберігання).
.RE
.IP
Див. також скрипт мовою Python «atomic\-rsync» у підкаталозі «support», щоб
ознайомитися із алгоритмом оновлення, який є ще атомарнішим (у ньому
використано \fB\-\-link\-dest\fP і паралельну ієрархію файлів).
.IP "\fB\-\-prune\-empty\-dirs\fP, \fB\-m\fP"
Використання цього параметра наказує rsync на боці отримання позбутися
порожніх каталогів зі списку файлів, включно із вкладеними каталогами, у
яких немає дочірніх об'єктів, які не є каталогами. Корисно для уникнення
створення низки непотрібних каталогів при рекурсивному сканування каталогів
rsync відправника в ієрархії файлів за допомогою правил включення,
виключення і фільтрування.
.IP
Зауважте, що використання правил передавання, зокрема параметра
\fB\-\-min\-size\fP, не впливає на вміст списку файлів, а отже, не лишає каталоги
порожніми, навіть якщо жоден з файлів у каталозі не відповідає правилу
передавання.
.IP
Оскільки програма насправді виконує спрощення списку файлів, цей параметр
також впливає на те, які каталоги буде вилучено, якщо увімкнено
вилучення. Втім, слід пам'ятати, що виключені файли і каталоги можуть
заважати вилученню наявних об'єктів через те, що одночасно приховують файли
джерела і захищають файли призначення. Див. параметр тимчасового правила
фільтрування, щоб дізнатися про те, як уникнути цього.
.IP
Ви можете запобігти оптимізаційному вилученню певних порожніх каталогів зі
списку файлів за допомогою загального фільтра «protect». Наприклад, цей
параметр забезпечить збереження каталогу «порожній_каталог» у списку файлів:
.RS 4
.IP
.nf
\-\-filter 'protect порожній_каталог/'
.fi
.RE
.IP
Нижче наведено приклад копіювання усіх файлів .pdf в ієрархії, створить лише
потрібні каталоги призначення для зберігання файлів .pdf і забезпечить
вилучення зайвих файлів і каталогів у призначенні (зауважте, що використано
фільтр приховування для об'єктів, які не є каталогами, а не виключення цих
об'єктів):
.RS 4
.IP
.nf
rsync \-avm \-\-del \-\-include='*.pdf' \-f 'hide,! */' джерело/ призначення
.fi
.RE
.IP
Якщо ви не хочете вилучати зайві файли призначення, замість фільтра
приховування можуть спрацювати традиційніші параметри \fB\-\-include='*/'\ \-\-exclude='*'\fP (якщо ви вважаєте їх природнішими).
.IP \fB\-\-progress\fP
Використання цього параметра наказує rsync вивести відомості щодо поступу
передавання даних. Таким чином, знудьгований користувач матиме за чим
спостерігати. У сучасному rsync це те саме, що і зазначення
\fB\-\-info=flist2,name,progress\fP, але будь\-які вказані користувачем параметри
для цих прапорців відомостей матимуть вищий пріоритет (наприклад,
\fB\-\-info=flist0\ \-\-progress\fP).
.IP
Під час передавання rsync звичайного файла програма оновлює рядок поступу,
який виглядає ось так:
.RS 4
.IP
.nf
782448  63%  110.64kB/s    0:00:04
.fi
.RE
.IP
У цьому прикладі отримувач відтворив 782448 байтів або 63% файла
відправника, який відтворюється зі швидкістю 110,64 кілобайтів за секунду, а
передавання буде завершено за 4 секунд, якщо вдасться підтримувати поточну
швидкість до кінця передавання.
.IP
Ці статистичні дані можуть бути оманливими, якщо використано алгоритм
дельта\-передавання rsync. Наприклад, якщо файл відправника складається з
базового файла із додатковими даними, повідомлена програмою швидкість,
ймовірно, значно впаде, коли отримувач отримає буквальні дані, а
передавання, ймовірно, триватиме набагато довше, чим оцінка отримувача,
оскільки оцінка враховує лише завершення відповідної частини файла.
.IP
Коли завершується передавання файлів, rsync замінює рядок поступу рядком
резюме, який виглядає ось так:
.RS 4
.IP
.nf
1,238,099 100%  146.38kB/s    0:00:08  (xfr#5, to\-chk=169/396)
.fi
.RE
.IP
У цьому прикладі файл має загальний розмір 1238099 байтів, середня швидкість
передавання файла склала 146,38 кілобайтів за секунду, передавання тривало 8
секунд, це було 5\-е передавання звичайного файла під час поточного сеансу
rsync, і лишилося ще 169 файлів, які отримувач має перевірити (щоб
дізнатися, чи є вони актуальними), із загального списку у 396 файлів.
.IP
Під час нарощувального сканування загальна кількість файлів у файловому
списку буде невідомою rsync, аж доки програма не завершить сканування, але
оскільки вона починає передавання файлів під час сканування, буде показано
рядок з текстом «ir\-chk» (нарощувальна рекурсивна перевірка), замість
«to\-chk», аж до моменту, коли програмі стане відомим загальний розмір списку
і програма зможе перемкнутися на використання «to\-chk». Отже, якщо ви бачите
«ir\-chk», це означає, що загальна кількість файлів у списку ще зростатиме (і
кожного разу, коли таке траплятиметься, зростатиме і кількість файлів, які
слід буде перевірити на кількість файлів, які додано до списку).
.IP \fB\-P\fP
Параметр \fB\-P\fP є тотожним до «\fB\-\-partial\fP \fB\-\-progress\fP». Його призначенням
значне спрощення визначення двох цих параметрів для довгих передавань, які
може бути перервано.
.IP
Також передбачено параметр \fB\-\-info=progress2\fP, використання якого
призводить до виведення статистичних даних на основі усього передавання
даних, а не передавання окремих файлів. Скористайтеся цим прапорцем без
виведення назв файлів (наприклад, уникайте \fB\-v\fP або вкажіть
\fB\-\-info=name0\fP), якщо вам потрібно бачити дані щодо поступу передавання без
гортання екрана через велику кількість назв. (Вам не потрібно вказувати
параметр \fB\-\-progress\fP, щоб скористатися \fB\-\-info=progress2\fP.)
.IP
Нарешті, ви можете отримати миттєвий звіт щодо поступу надсиланням rsync
сигналу SIGINFO або SIGVTALRM. У системах BSD SIGINFO можна створити
натисканням комбінації клавіш Ctrl+T (у поточній версії Linux не передбачено
підтримки сигналу SIGINFO). Коли процес на боці клієнта отримує один з цих
сигналів, він встановлює прапорець для виведення єдиного звіту щодо поступу,
який буде виведено по завершенню передавання поточного файла (тому можлива
невеличка затримка, якщо під час надсилання сигналу буде виконуватися
передавання великого файла). Буде виведено назву файла (якщо потрібно) із
наступним форматом \fB\-\-info=progress2\fP даних щодо поступу. Якщо ви не
знаєте, який з 3 процесів rsync є клієнтським, можна надіслати сигнал усім
процесам (оскільки неклієнтські процес ігнорують сигнал).
.IP
ПОПЕРЕДЖЕННЯ: надсилання SIGVTALRM до застарілого rsync (до 3.2.0) призведе
до завершення роботи rsync.
.IP \fB\-\-password\-file=ФАЙЛ\fP
За допомогою цього параметра ви можете вказати пароль для доступу до фонової
служби rsync, скориставшись файлом або стандартним джерелом вхідних даних,
якщо замість аргументу \fBФАЙЛ\fP вказано \fB\-\fP. Файл має містити лише пароль у
першому рядку (усі інші рядки буде проігноровано). Rsync завершить роботу
повідомленням про помилку, якщо \fBФАЙЛ\fP буде придатним до читання від імені
довільного користувача, або якщо запущена від імені root програма rsync
виявить файл, власником якого не є користувач root.
.IP
Цей параметр не надсилає пароль до обробника даних віддаленої оболонки,
зокрема ssh. Щоб дізнатися, як виконати таку дію, зверніться до документації
з віддаленої оболонки. При доступу до фонової служби rsync за допомогою
віддаленої оболонки як засобу передавання даних, цей параметр спрацює, лише
після завершення процедури розпізнавання у віддаленій оболонці (тобто, якщо
ви також вкажете пароль у файлі налаштувань фонової служби).
.IP \fB\-\-early\-input=ФАЙЛ\fP
За допомогою цього параметра можна дозволити rsync надсилати до 5 кілобайтів
даних до скрипту «early exec» до його стандартного джерела вхідних
даних. Одним із можливих використань цих даних є передавання скрипту
реєстраційних даних, якими можна скористатися для монтування шифрованої
файлової системи (яку слід демонтувати у скрипті «post\-xfer exec»).
.IP
Версією фонової служби має бути принаймні 3.2.1.
.IP \fB\-\-list\-only\fP
Використання цього параметра призведе до виведення списку файлів джерела,
замість передавання цих файлів. Цей параметр буде використано неявним чином,
якщо вказано одинарний аргумент джерела і жодного призначення, тому його
основним призначенням є таке:
.RS
.IP
.IP 1.
перетворення команди копіювання, до якої включено аргумент призначення, на
команду виведення списку файлів або
.IP 2.
уможливлення визначення декількох аргументів джерел. Зауваження: не забудьте
включити до команди призначення.
.RE
.IP
ПОПЕРЕДЖЕННЯ: пам'ятайте, що аргумент джерела із символами\-замінниками буде
розгорнуто командною оболонкою у декілька аргументів, тому ніколи не буде
безпечною спроба використати аргумент\-список без використання цього
параметра. Приклад:
.RS 4
.IP
.nf
rsync \-av \-\-list\-only щось* призначення/
.fi
.RE
.IP
Починаючи з версії rsync 3.1.0, на виведення розмірів параметром
\fB\-\-list\-only\fP впливає параметр \fB\-\-human\-readable\fP. Типово, у значеннях
розмірів містяться десяткові розділювачі, але за вищих рівнів зручності
читання, програма починає виводити розміри із суфіксами одиниць. Зауважте,
що ширину стовпчика для виведення розміру для усіх зручних для читання
рівнів збільшено з 11 до 14 символів. Скористайтеся параметром \fB\-\-no\-h\fP,
якщо вам потрібні лише цифри у розмірах і стара ширина стовпчика у 11
символів.
.IP
Зауваження щодо сумісності: при надсиланні запиту щодо списку файлів на
віддаленому боці з'єднання до rsync версії 2.6.3 або давнішої у вас можуть
виникнути проблеми, якщо побудова списку буде нерекурсивною. Причиною є те,
що під час побудови списку файлів неявним чином встановлюється параметр
\fB\-\-dirs\fP без параметра \fB\-\-recursive\fP, а у старіших версіях rsync цього
параметра немає. Щоб уникнути цієї проблеми або вкажіть параметр
\fB\-\-no\-dirs\fP (якщо вам не потрібне розгортання вмісту каталогів), або
увімкніть рекурсію і виключіть вміст підкаталогів: \fB\-r\ \-\-exclude='/*/*'\fP.
.IP \fB\-\-bwlimit=ШВИДКІСТЬ\fP
За допомогою цього параметра ви можете вказати максимальну швидкість
надсилання даних крізь сокет, вказавши її в одиницях за секунду. До значення
ШВИДКІСТЬ можна дописати суфікс — рядок, який вказуватиме на множник
розміру, можна також вказати дробове значення (приклад:
\fB\-\-bwlimit=1.5m\fP). Якщо суфікс не вказано, програма припускатиме, що
одиницями є блоки по 1024 байтів (так, наче вказано суфікс «K» або
«KiB»). Див. параметр \fB\-\-max\-size\fP, щоб ознайомитися із описом усіх
доступних суфіксів. Значення 0 знімає обмеження на швидкість.
.IP
З міркувань зворотної сумісності обмеження на швидкість буде округлено до
найближчої одиниці КіБ, тому використання швидкостей, менших за 1024 байтів
за секунду, неможливе.
.IP
Rsync записує дані крізь сокет блоками, а цей параметр одночасно обмежує
розмір блоків, які записує rsync, і намагається зберегти середню швидкість
передавання на вказаному рівні. Під час передавання може бути створено
розриви, коли rsync записує великий блок даних, а потім бездіяльно очікує,
щоб зберегти середню швидкість.
.IP
Через внутрішню буферизацію даних параметр \fB\-\-progress\fP може бути неточним
відтворенням того, наскільки швидко надсилатимуться дані. Причиною цього є
те, що програма може показувати, що якісь дані миттєво надіслано, коли дані
просто швидко буферизуються, а швидкість надсилання інших даних може бути
показана як дуже низька, коли програма намагається спорожнити буфер
виведення. Можливо, цю проблему буде розв'язано у майбутніх версіях.
.IP
Див. також версію для фонової служби параметра \fB\-\-bwlimit\fP.
.IP "\fB\-\-stop\-after=ХВИЛИНИ\fP, (\fB\-\-time\-limit=ХВИЛИНИ\fP)"
Використання цього параметра наказує rsync припинити копіювання, якщо
процедура триватиме вказану кількість хвилин.
.IP
Заради максимальної гнучкості, rsync не передає цей параметр до віддаленого
rsync, оскільки, зазвичай, для завершення процедури достатньо розірвання
з'єднання з одного боку. Таким чином, параметром можна скористатися, навіть
якщо його підтримку передбачено лише на одному боці з'єднання. Ви можете
повідомити віддаленому кінцю з'єднання про обмеження часу за допомогою
параметра \fB\-\-remote\-option\fP (\fB\-M\fP), якщо у цьому виникне потреба.
.IP
Версія \fB\-\-time\-limit\fP цього параметра є застарілою.
.IP \fB\-\-stop\-at=y\-m\-dTh:m\fP
Використання цього параметра наказує rsync зупинити копіювання, коли буде
досягнуто вказану часову позначку. Дату і час можна повністю вказати у
числовому форматі рік\-місяць\-деньTгодина:хвилина (наприклад
2000\-12\-31T23:59) у місцевому часовому поясі. Ви можете наказати програмі
відокремлювати числа у даті за допомогою символів похилої риски, замість
дефісів.
.IP
Значення може бути скорочено у декілька способів, зокрема визначенням
2\-цифрового року і/або пропусканням різних значень. Що б там не було,
значенням буде наступна можлива часова позначка, якій відповідають надані
дані. Якщо значення вказує поточний час або момент часу у минулому, rsync
завершить роботу повідомленням про помилку.
.IP
Наприклад, «1\-30» вказує на наступне 30 січня (опівночі на місцевим часом),
«14:00» вказує на наступну другу годину дня, «1» задає наступне 1\-е число
місяця опівночі, «31» задає наступний місяць, де є 31\-й день, а «:59» задає
наступну 59\-у хвилину за годину.
.IP
Заради максимальної гнучкості, rsync не передає цей параметр до віддаленого
rsync, оскільки, зазвичай, для завершення процедури достатньо розірвання
з'єднання з одного боку. Таким чином, параметром можна скористатися, навіть
якщо його підтримку передбачено лише на одному боці з'єднання. Ви можете
повідомити віддаленому кінцю з'єднання про обмеження часу за допомогою
параметра \fB\-\-remote\-option\fP (\fB\-M\fP), якщо у цьому виникне
потреба. Пам'ятайте, що на віддаленому вузлі може бути встановлено інший
типовий часовий пояс, ніж на локальному вузлі.
.IP \fB\-\-fsync\fP
Наказує виконати fsync на боці отримання для кожного файла, передавання
якого буде завершено. Це може уповільнити передавання, але може допомогти
убезпечити оновлення критичних файлів.
.IP \fB\-\-write\-batch=ФАЙЛ\fP
Записати файл, який можна буде згодом застосувати для іншого ідентичного
призначення за допомогою \fB\-\-read\-batch\fP. Див. розділ «ПАКЕТНИЙ РЕЖИМ», щоб
дізнатися більше, а також параметр \fB\-\-only\-write\-batch\fP.
.IP
Цей параметр перевизначає узгоджені контрольні суми і списки стискання, а
також узгоджує вибір на основі давніх варіантів md5, md4, zlib. Якщо ви
хочете сучасніших варіантів, скористайтеся параметрами \fB\-\-checksum\-choice\fP
(\fB\-\-cc\fP) і/або \fB\-\-compress\-choice\fP (\fB\-\-zc\fP).
.IP \fB\-\-only\-write\-batch=ФАЙЛ\fP
Працює як \fB\-\-write\-batch\fP, але без виконання оновлень у системі призначення
при створенні пакетного файла. Це надає вам змогу передавати зміни до
системи призначення в інші способи, а потім застосувати зміни за допомогою
\fB\-\-read\-batch\fP.
.IP
Зауважте, що ви можете записувати пакетні файли безпосередньо на деякі
портативні носії даних: якщо цей носій буде заповнено до максимальної
місткості до завершення передавання даних, ви можете просто застосувати
часткове передавання на призначення і повторити усю процедуру, щоб отримати
решту змін (якщо ви не проти часткового оновлення системи призначення під
час циклу із багатьма оновленнями).
.IP
Також зауважте, що ви лише заощадите потужності каналу передавання даних при
записі змін до віддаленої системи, оскільки це надасть змогу відхилити
пакетні дані з боку відправника до пакетного файла без переповнення каналу
до отримувача (при отриманні даних відправник є віддаленим боком, і отже, не
може записувати пакетні дані).
.IP \fB\-\-read\-batch=ФАЙЛ\fP
Застосувати усі зміни, які зберігаються у ФАЙЛІ, файлі, який раніше було
створено \fB\-\-write\-batch\fP. Якщо значенням \fIФАЙЛ\fP є \fB\-\fP, пакетні дані буде
прочитано зі стандартного джерела вхідних даних. Див. розділ «ПАКЕТНИЙ
РЕЖИМ», щоб дізнатися більше.
.IP \fB\-\-protocol=ЧИСЛО\fP
Примусово застосувати застарілу версію протоколу. Корисно для створення
пакетного файла, який є сумісним із застарілими версіями rsync. Наприклад,
якщо використано rsync 2.6.4 із параметром \fB\-\-write\-batch\fP, а для запуску з
параметром \fB\-\-read\-batch\fP буде використано версію 2.6.3, вам слід
використати «\-\-protocol=28» при створенні пакетного файла для застарілих
версій протоколу, які буде використано у пакетному файлі (припускаємо, що ви
не можете оновити rsync на системі читання).
.IP \fB\-\-iconv=СПЕЦИФІКАЦІЯ_ПЕРЕТВОРЕННЯ\fP
Rsync може перетворювати назви між кодуваннями за допомогою цього
параметра. За допомогою встановлення значення CONVERT_SPEC «.» можна
наказати rsync шукати типове кодування на основі встановленої локалі. Крім
того, ви можете повністю вказати, яке перетворення слід виконати, заданням
локального і віддаленого кодування через кому у порядку
\fB\-\-iconv=ЛОКАЛЬЕН,ВІДДАЛЕНЕ\fP, наприклад \fB\-\-iconv=utf8,iso88591\fP. Цей
порядок забезпечує незмінність запису параметра, незалежно від того,
надсилаєте ви файли чи отримуєте їх. Нарешті, ви можете вказати або
\fB\-\-no\-iconv\fP, або значення CONVERT_SPEC «\-», щоб вимкнути перетворення
взагалі. Типове значення цього параметра залежить від операційної системи,
на нього може вплинути змінна середовища \fBRSYNC_ICONV\fP.
.IP
Щоб отримати список назв кодувань, підтримку яких передбачено у вашій
локальній бібліотеці iconv, ви можете скористатися командою «\fBiconv\ \-\-list\fP».
.IP
Якщо ви вкажете параметр \fB\-\-protect\-args\fP (\fB\-s\fP), rsync виконає
перетворення назв файлів, які ви вкажете у рядку команди, який буде
надіслано на віддалений вузол. Див. також параметр \fB\-\-files\-from\fP.
.IP
Зауважте, що rsync не виконує ніяких перетворень назв у файлах фільтрування
(включно з файлами включення/виключення). Забезпечити відповідність вказаних
правил на обох кінцях ланцюжка передавання даних маєте ви. Наприклад, ви
можете вказати додаткові правила включення/виключення, якщо є відмінності на
кінцях з'єднання, які слід врахувати.
.IP
Якщо ви передаєте параметр \fB\-\-iconv\fP фоновій службі rsync, яка може з ним
працювати, фонова служба використає кодування, вказане у її параметрі
налаштування «charset», незалежно від віддаленого кодування, яке ви
насправді передаєте. Таким чином, ви можете вказати лише локальне кодування
для передавання до фонової служби (наприклад  \fB\-\-iconv=utf8\fP).
.IP "\fB\-\-ipv4\fP, \fB\-4\fP або \fB\-\-ipv6\fP, \fB\-6\fP"
Вказує rsync, що слід надати перевагу IPv4/IPv6 при створенні сокетів чи
запуску ssh. Це стосується сокетів, над якими має безпосереднє керування
rsync, зокрема вихідного сокета при безпосередньому контакті із фоновою
службою rsync, а також переспрямування параметра \fB\-4\fP або \fB\-6\fP до ssh,
якщо rsync може визначити, що використано ssh, як віддалену оболонку. Для
інших віддалених оболонок вам слід вказати параметр «\fB\-\-rsh\ ОБОЛОНКА\ \-4\fP»
безпосередньо (або будь\-які параметри\-підказки IPv4/IPv6, які вони
використовують).
.IP
Див. також версії для фонової служби цих параметрів.
.IP
Якщо rsync було зібрано без підтримки IPv6, параметр \fB\-\-ipv6\fP не
працюватиме. Виведення \fBrsync\ \-\-version\fP міститиме рядок «\fBno\ IPv6\fP»,
якщо це так.
.IP \fB\-\-checksum\-seed=ЧИСЛО\fP
Встановити початкове число контрольної суми у значення ЧИСЛО. Це базове
число контрольної суми, що має складатися з  байтів, буде використано під ас
обчислення всіх контрольних сум MD4 для блоків і файлів (сучасніші
контрольні суми файлів MD5 не використовують базового значення). Типово,
початкове число контрольної суми буде створено сервером на основі даних про
поточний час, \fBtime\fP(). Цим параметром можна скористатися для встановлення
певного початкового значення для обчислення контрольних сум, що корисно,
якщо ви користуєтеся програмами, яким потрібні сталі значення контрольних
сум блоків, або у випадках, коли потрібне якесь зовсім випадкове початкове
значення. Встановлення значення ЧИСЛО=0 призведе до використання rsync
типового початкового значення контрольної суми, отриманого за допомогою
команди функції \fBtime\fP().
.P
.SH "ПАРАМЕТРИ ФОНОВОЇ СЛУЖБИ"
.P
Параметри, якими можна скористатися при запуску фонової служби rsync, є
такими:
.P
.IP \fB\-\-daemon\fP
Цей параметр наказує rsync запуститися у режимі фонової служби. Доступ до
запущеної фонової служби можна буде здійснювати за допомогою клієнта rsync з
використанням синтаксису \fBвузол::модуль\fP або \fBrsync://вузол/модуль/\fP.
.IP
Якщо стандартним джерелом вхідних даних є сокет, rsync припускатиме, що
програму запущено за допомогою inetd, інакше програма від'єднається від
поточного термінала і стане фоновою службою. Фонова служба читатиме файл
налаштувань (rsyncd.conf) при кожному з'єднанні, яке встановлюватиме клієнт,
і відповідатиме на запити відповідним чином.
.IP
Щоб дізнатися більше, ознайомтеся зі сторінкою підручника \fBrsyncd.conf\fP(5).
.IP \fB\-\-address=АДРЕСА\fP
Типово, rsync прив'язуватиметься до вказаної символами\-замінниками адреси
при запуску в формі служби з параметром \fB\-\-daemon\fP. Параметр \fB\-\-address\fP
надає вам змогу вказати певну IP\-адресу (або назву вузла), до якого слід
прив'язатися. Це, у поєднанні із параметром \fB\-\-config\fP, надає змогу
створювати віртуальні провідні вузли.
.IP
Див. також загальний параметр адреси на сторінці підручника rsyncd.conf і
клієнтську версію параметра \fB\-\-address\fP.
.IP \fB\-\-bwlimit=ШВИДКІСТЬ\fP
За допомогою цього параметра ви можете вказати максимальну швидкість
передавання для даних, які фонова служба надсилає крізь сокет. Втім, клієнт
може вказати менше значення \fB\-\-bwlimit\fP, але більші значення буде
заборонено.
.IP
Див. версію для клієнта параметра \fB\-\-bwlimit\fP, щоб ознайомитися із
додатковими подробицями.
.IP \fB\-\-config=ФАЙЛ\fP
Цей параметр вказує альтернативний файл налаштувань, відмінний від
типового. Діє, лише якщо вказано \fB\-\-daemon\fP. Типовим файлом є
/etc/rsyncd.conf, якщо фонову службу не запущено за допомогою програми
віддаленої командної оболонки і віддалений користувач не є надкористувачем;
якщо це не так, типовим є файл rsyncd.conf у поточному каталозі (типово,
$HOME).
.IP "\fB\-\-dparam=ПЕРЕВИЗНАЧЕННЯ\fP, \fB\-M\fP"
Цим параметром можна скористатися для встановлення параметра налаштувань
фонової служби при запуску rsync у режимі фонової служби. Він тотожний
додаванню параметра наприкінці загальний параметрів до визначення першого
модуля. Назви параметрів можна вказувати без пробілів, якщо ви цього
хочете. Приклад:
.RS 4
.IP
.nf
rsync \-\-daemon \-M pidfile=/шлях/rsync.pid
.fi
.RE
.IP \fB\-\-no\-detach\fP
У режимі роботи фонової служби цей параметр наказує rsync не від'єднуватися
і стати фоновим процесом. Цей параметр потрібен, коли програма працює як
служба у Cygwin, а також може бути корисним, якщо супервізором rsync є
програма, подібна до \fBdaemontools\fP чи \fBSystem\ Resource\ Controller\fP в
AIX. Також рекомендуємо скористатися \fB\-\-no\-detach\fP, якщо rsync запущено під
керування засобу діагностики. Цей параметр не працюватиме, якщо rsync
запущено з inetd або sshd.
.IP \fB\-\-port=ПОРТ\fP
Цей параметри визначає альтернативний номер порту TCP, на якому має
очікувати на дані фонова служба, замість типового порту 873.
.IP
Див. також версію для клієнта параметра \fB\-\-port\fP і загальний параметр порту
на сторінці підручника щодо rsyncd.conf.
.IP \fB\-\-log\-file=ФАЙЛ\fP
Використання цього параметра наказує фоновій службі rsync використовувати
файл журналу із вказаною назвою, замість значення параметра «\fBlog\ file\fP» у
файлі налаштувань.
.IP
Див. також версію для клієнта параметра \fB\-\-log\-file\fP.
.IP \fB\-\-log\-file\-format=ФОРМАТ\fP
Використання цього параметра наказує фоновій службі rsync використовувати
вказаний рядок ФОРМАТ, замість використання значення параметра «\fBlog\ format\fP» у файлі налаштувань. Також буде увімкнено «\fBtransfer\ logging\fP»,
якщо рядок не є порожнім; якщо ж це не так, записування журналу передавання
буде вимкнено.
.IP
Див. також версію для клієнта параметра \fB\-\-log\-file\-format\fP.
.IP \fB\-\-sockopts\fP
Цей параметр перевизначає параметр \fBsocket\ options\fP у файлі rsyncd.conf і
має такий самий синтаксис.
.IP
Див. також версію для клієнта параметра \fB\-\-sockopts\fP.
.IP "\fB\-\-verbose\fP, \fB\-v\fP"
Використання цього параметра збільшує обсяг інформації, яку фонова служба
запису до журналу під час фази запуску. Після встановлення з'єднання із
клієнтом рівнем докладності журналу керуватимуть параметри роботи клієнта та
параметр «\fBmax\ verbosity\fP» у розділі налаштувань модуля.
.IP
Див. також версію для клієнта параметра \fB\-\-verbose\fP.
.IP "\fB\-\-ipv4\fP, \fB\-4\fP або \fB\-\-ipv6\fP, \fB\-6\fP"
Наказує rsync віддавати перевагу IPv4/IPv6 при створенні вхідних сокетів,
які фонова служба rsync використовуватиме для очікування на з'єднання. Один
з цих параметрів може бути обов'язковим у застарілих версіях Linux для того,
щоб обійти ваду IPv6 у ядрі системи (якщо ви бачите помилку «адресу вже
використано», коли нічого не може використовувати порт спробуйте вказати
\fB\-\-ipv6\fP або \fB\-\-ipv4\fP при запуску фонової служби).
.IP
Див. також версії для клієнта цих параметрів.
.IP
Якщо rsync було зібрано без підтримки IPv6, параметр \fB\-\-ipv6\fP не
працюватиме. Виведення \fBrsync\ \-\-version\fP міститиме рядок «\fBno\ IPv6\fP»,
якщо це так.
.IP "\fB\-\-help\fP, \fB\-h\fP"
Якщо вказано після \fB\-\-daemon\fP, вивести коротку довідкову сторінку із описом
параметрів, якими можна скористатися для запуску фонової служби rsync.
.P
.SH "ПРАВИЛА ФІЛЬТРУВАННЯ"
.P
Правила фільтрування дозволяють скористатися гнучким вибором того, які файли
передавати (включати), а які файли пропускати (виключати). Правила або
безпосередньо вказують взірці включення\-виключення, або визначають спосіб
отримати додаткові взірці включення\-виключення (наприклад, прочитати ці
взірці з файла).
.P
При побудові списку файлів та каталогів для передавання rsync виконує
перевірку кожної назви за взірцями включення/виключення. Задіяно буде перший
відповідний взірець: якщо це взірець виключення, файл буде пропущено; якщо
це взірець включення, файл не буде пропущено; якщо не буде знайдено
відповідного взірця, файл не буде пропущено.
.P
Відступ: оскільки взаємодія правил фільтрування може бути складною, корисно
скористатися параметром \fB\-\-debug=ФІЛЬТР\fP, якщо щось працює не так, як ви б
хотіли. Виведення на рівні\-1 (типовий рівень, якщо номер рівня не вказано)
включає правило фільтрування, яке спершу використовується для кожного файла
у передаванні. Також програма попереджає, якщо у правилі фільтрування є
кінцевий пробіл. На рівні 2 виведення використовує набагато більше подій
фільтрування, включно із визначенням кожного правила і обробкою фільтрування
файлів на рівні каталогів.
.P
Rsync будує упорядкований список правил фільтрування, як їх вказано у рядку
команди. Для правил фільтрування передбачено такий синтаксис:
.RS 4
.P
.nf
ПРАВИЛО [ВЗІРЕЦЬ_АБО_НАЗВА_ФАЙЛА]
ПРАВИЛО,МОДИФІКАТОРИ [ВЗІРЕЦЬ_АБО_НАЗВА_ФАЙЛА]
.fi
.RE
.P
Ви можете вибрати між використання коротких або довгих назв ПРАВИЛ, як це
описано нижче. Якщо ви скористаєтеся короткими назвами правил, відокремлення
«,» ПРАВИЛА від МОДИФІКАТОРІВ є необов'язковим. Наступний ВЗІРЕЦЬ або
наступна НАЗВА_ФАЙЛА (якщо їх вказано) має бути вказано після одинарного
пробілу або символу підкреслення (_). Ось доступні префікси правил:
.P
.IP \fBexclude,\ '\-'\fP
визначає взірець для виключення.
.IP \fBinclude,\ '+'\fP
визначає взірець для включення.
.IP \fBmerge,\ '.'\fP
вказує файл об'єднання для читання додаткових правил.
.IP \fBdir\-merge,\ ':'\fP
вказує файл об'єднання на рівні каталогу.
.IP \fBhide,\ 'H'\fP
визначає взірець для приховування файлів від перенесення.
.IP \fBshow,\ 'S'\fP
файли, які відповідають взірцю, не приховано.
.IP \fBprotect,\ 'P'\fP
визначає взірець для захисту файлів від вилучення.
.IP \fBrisk,\ 'R'\fP
файли, які відповідають взірцю, не захищено.
.IP \fBclear,\ '!'\fP
спорожнює поточний список включення/виключення (не приймає аргументів)
.P
Якщо правила буде прочитано з файла, порожні рядки буде проігноровано, як і
цілорядкові коментарі, які починаються з «\fB#\fP» (правила щодо назв файлів,
які містять символ решітки не буде проігноровано).
.P
Зауважте, що параметри командного рядка \fB\-\-include\fP і \fB\-\-exclude\fP не
дозволяють скористатися повним діапазоном обробки правил, як це описано
вище\ — вони лише дозволяють вказати специфікацію взірців
включення/виключення і символ «\fB!\fP» для очищення списку (і звичайна обробка
коментарів, якщо правила буде прочитано з файла). Якщо взірець не
починається з «\fB\-\ \fP» (дефіс, пробіл) або «\fB+\ \fP» (плюс, пробіл), правило
буде оброблено так, наче до рядка було дописано префікс «\fB+\ \fP» (для
правила включення) або «\fB\-\ \fP» (для правила виключення). Параметр
\fB\-\-filter\fP, з іншого боку, має завжди містить коротку або довгу назву
правила на початку запису правила.
.P
Зауважте, що параметри \fB\-\-filter\fP, \fB\-\-include\fP і \fB\-\-exclude\fP приймають по
одному правилу/взірцю. Щоб додати декілька правил, ви можете повторити
параметри у рядку команди, скористатися синтаксисом об'єднання файлів у
параметрі \fB\-\-filter\fP або параметрами \fB\-\-include\-from\fP / \fB\-\-exclude\-from\fP.
.P
.SH "ПРАВИЛА ВКЛЮЧЕННЯ/ВИКЛЮЧЕННЯ ЗА ВЗІРЦЯМИ"
.P
Ви можете включати і виключати файли, вказуючи взірці за допомогою правил
фільтрування «+», «\-» тощо (початковий опис наведено у розділі ПРАВИЛА
ФІЛЬТРУВАННЯ вище). Кожне правило включення/виключення вказує взірець,
порівняння його виконується за назвами файлів, які має бути передано. Ці
взірці можуть мати декілька форм:
.P
.IP o
якщо взірець починається з \fB/\fP, його буде прив'язано до певного місця у
ієрархії файлів, інакше його буде зіставлено із кінцем шляху. Це подібне до
початкового \fB^\fP у формальних виразах. Таким чином, \fB/щось\fP відповідає
назві «щось» або у «кореневій теці передавання» (для загального правила),
або у каталозі файла об'єднання (для правила на рівні каталогу). Просте
\fBщось\fP відповідає назві «щось» будь\-де у ієрархії каталогів, оскільки
алгоритм буде застосовано рекурсивно згори вниз; програма поводить себе так,
наче кожен компонент шляху працює наприкінці назви файла. Навіть
неприв'язаний запис «підкаталог/щось» відповідає у будь\-якій точці в
ієрархії, де «щось» було знайдено у каталозі із назвою
«підкаталог». Див. розділ ПРИВ'ЯЗКА ВЗІРЦІВ ВКЛЮЧЕННЯ/ВИКЛЮЧЕННЯ, щоб
ознайомитися із повним обговоренням того, як вказати взірець, який
відповідає кореневій теці передавання.
.IP o
якщо взірець завершується на \fB/\fP, він відповідатиме лише каталогу, не
звичайному файлу, символічному посиланню або пристрою.
.IP o
rsync вибирає між виконанням простого порівняння рядків і порівнянням рядка
із рядком із символами\-замінниками, де взірці містять один із таких
символів\-замінників: «\fB*\fP», «\fB?\fP» і «\fB[\fP».
.IP o
«\fB*\fP» відповідає будь\-якому компоненту шляху, але без включення символів
похилої риски.
.IP o
скористайтеся «\fB**\fP» для встановлення відповідності будь\-якій частині
рядка, включено із символами похилої риски.
.IP o
«\fB?\fP» відповідає будь\-якому символу, окрім символу похилої риски (\fB/\fP).
.IP o
«\fB[\fP» вставляє клас символів, зокрема \fB[a\-z]\fP або \fB[[:alpha:]]\fP.
.IP o
у взірці із символами\-замінниками символ зворотної похилої риски можна
використати для екранування символу\-замінника. Після екранування символи
буде оброблено як звичайні символи. це означає, що існує додатковий рівень
вилучення зворотних похилих рисок, коли взірець містить символи\-замінники,
порівняно із взірцем, яких їх не містить. Наприклад, якщо ви додаєте
символ\-замінник до «\fBщось\eдесь\fP» (який відповідає зворотній похилій
рисці), вам слід скористатися "\fBщось\e\eдесь*\fP», щоб уникнути варіанта,
коли «\fB\eд\fP» стане просто «д».
.IP o
якщо взірець містить \fB/\fP (без кінцевого /) або «\fB**\fP», він відповідатиме
повній назві файла, включно із усіма початковими записами каталогів. Якщо
взірець не містить \fB/\fP або «\fB**\fP», він відповідатиме лише останньому
компоненту назви файла. (Пам'ятайте, що алгоритм буде застосовано
рекурсивно, отже, «повна назва файла» може насправді бути будь\-якою частиною
шляху від початкового каталогу униз ієрархією.)
.IP o
кінцеве «\fBназва_каталогу/***\fP» відповідатиме одразу каталогу (наче було
вказано «назва_каталогу/») і усе у каталозі (наче було вказано
«\fBназва_каталогу/**\fP»). Таку поведінку було додано у версії 2.6.7.
.P
Зауважте, що при використанні параметра \fB\-\-recursive\fP (\fB\-r\fP) (який
встановлюється неявним чином \fB\-a\fP), будь\-який компонент підкаталогу
будь\-якого шляху буде оброблено зліва праворуч, кожен каталог може бути
виключено до його вмісту. У цей спосіб взірці включення/виключення буде
застосовано рекурсивно до назви шляху кожного вузла в ієрархії файлової
системи (всередині каталогу передавання). Взірці виключення замикають
обробку на стадії обходу, коли rsync шукає файли для надсилання.
.P
Наприклад, щоб було включено «\fB/щось/десь/тут\fP», каталоги «\fB/щось\fP» і
«\fB/щось/десь\fP» має бути не виключено. Виключення одного з цих батьківських
каталогів забороняє вивчення її вмісту, обрізаючи рекурсію rsync у цих
шляхах і усуваючи включення «\fB/щось/десь/тут\fP» (оскільки у rsync не
встановлюється відповідність і програма ніколи не заглядатиме до обрізаної
гілки в ієрархії каталогів).
.P
Концепція виключення шляхів є частково важливою при використанні кінцевого
правила «\fB*\fP». Наприклад, це не працюватиме:
.RS 4
.P
.nf
+ /якийсь/шлях/цей\-файл\-не\-буде\-знайдено
+ /файл\-включено
\- *
.fi
.RE
.P
Це не працюватиме, оскільки батьківський каталог «якийсь» буде виключено
правилом «\fB*\fP», отже rsync ніколи не бачитиме файлів у каталогах «якийсь»
та «якийсь/шлях». Одним із вирішень цієї проблеми є включення усіх каталогів
в ієрархії за допомогою єдиного правила включення: «\fB+\ */\fP» (розташуйте
його десь до правила «\fB\-\ *\fP»), і, можливо, скористайтеся параметром
\fB\-\-prune\-empty\-dirs\fP. Іншим рішенням є додавання специфічних правил
включення для усіх батьківських каталогів, які слід обробити. Наприклад, цей
набір правил працює:
.RS 4
.P
.nf
+ /якийсь/
+ /якийсь/шлях/
+ /якийсь/шлях/цей\-файл\-знайдено
+ /також\-включений\-файл
\- *
.fi
.RE
.P
Ось декілька прикладів включення/виключення зі встановленням відповідності:
.P
.IP o
«\fB\-\ *.o\fP» призведе до виключення усіх назв, які відповідають взірцю \fB*.o\fP
.IP o
«\fB\-\ /щось\fP» виключить файл (або каталог) із назвою «щось» у кореневому
каталозі передавання
.IP o
«\fB\-\ щось/\fP» виключить будь\-який каталог із назвою «щось»
.IP o
«\fB\-\ /щось/*/десь\fP» виключить будь\-який файл із назвою «десь», який
перебуває на два рівні нижче каталогу із назвою «щось» у кореневому каталозі
передавання
.IP o
«\fB\-\ /щось/**/десь\fP» виключить будь\-який файл із назвою «десь», який
перебуває на два рівні або більше рівнів нижче каталогу із назвою «щось» у
кореневому каталозі передавання
.IP o
Поєднання «\fB+\ */\fP», «\fB+\ *.c\fP» і «\fB\-\ *\fP» включить усі каталоги і усі
файли початкового коду C, але ніяких інших об'єктів (див. також параметр
\fB\-\-prune\-empty\-dirs\fP)
.IP o
Комбінація «\fB+\ щось/\fP», «\fB+\ щось/десь.c\fP» і «\fB\-\ *\fP» призведе до
включення лише каталогу «щось» і «щось/десь.c» (каталог «щось» має бути
явним чином включено, інакше його будеи виключено правилом «\fB*\fP»)
.P
Після «\fB+\fP» або «\fB\-\fP» можна використовувати такі модифікатори:
.P
.IP o
\fB/\fP вказує, що правило включення/виключення слід застосовувати до
абсолютного шляху поточного запису. Наприклад, «\fB\-/\ /etc/passwd\fP»
виключить файл passwd, коли під час передавання надсилатимуться з каталогу
«/etc», а «\-/ підкаталог/щось» завжди виключає «щось», коли цей об'єкт
перебуває у каталозі із назвою «підкаталог», навіть якщо «щось» перебуває у
кореневому каталозі поточного передавання.
.IP o
\fB!\fP вказує, що включення/виключення має відбутися, якщо взірець не
відповідатиме знайденому файлу. Наприклад, «\fB\-!\ */\fP» призведе до
виключення усіх об'єктів, які не є каталогами.
.IP o
\fBC\fP використовують для позначення того, що усі загальні правила виключення
CVS має бути вставлено як виключення на місце «\-C». Аргументів після
вказувати не можна.
.IP o
\fBs\fP використовують для позначення того, що правило слід застосовувати на
боці надсилання. Якщо правило стосується боку надсилання, воно запобігає
передаванню файлів. Типово, правило стосуватиметься обох кінців з'єднання,
якщо не вказано \fB\-\-delete\-excluded\fP. Якщо ж цей параметр вказано, типові
правила стосуватимуться лише відправника. Див. також правила приховування
(H) і показу (S), які є альтернативним способом вказати включення/виключення
на боці відправника.
.IP o
\fBr\fP використовують для позначення того, що правило застосовується до кінця
отримувача. Якщо правило стосується кінця отримання, воно забороняє
вилучення файлів. Див. модифікатор \fBs\fP, щоб дізнатися більше. Див. також
правила захисту (P) і ризику (R), які є альтернативним способом вказати
включення/виключення на боці отримувача.
.IP o
\fBp\fP вказує, що правило є тимчасовим, що означає, що його буде проігноровано
у каталогах, які вилучаються. Наприклад, типові правила параметра
\fB\-\-cvs\-exclude\fP (\fB\-C\fP), які виключають об'єкти, подібні до «CVS» і
«\fB*.o\fP» буде позначено як тимчасове, і воно не запобігатиме від вилучення
каталогу, який вилучено у джерелі, на боці призначення.
.IP o
\fBx\fP вказує, що правило стосується назв xattr у діях з копіювання/вилучення
(і таким чином його буде проігноровано при встановленні відповідності назв
файлів/каталогів). Якщо правил із встановленням відповідності за xattr не
вказано, буде використано типове правило фільтрування за xattr
(див. параметр \fB\-\-xattrs\fP).
.P
.SH "ПРАВИЛА ФІЛЬТРУВАННЯ ІЗ ОБ'ЄДНАННЯМ ФАЙЛІВ"
.P
Ви можете об'єднати з вашими правилами фільтрування цілі файли, якщо вкажете
правило фільтрування об'єднання (.) або об'єднання каталогів (:) (як їх
представлено у розділі ПРАВИЛА ФІЛЬТРУВАННЯ вище).
.P
Існує два типи об'єднаних файлів\ \-\- для окремих екземплярів («.») і для
окремих каталогів («:»). Файл об'єднання для окремих екземплярів буде
прочитано один раз, а його правила буде вбудовано до списку фільтрування
замість правила «.». Для файлів об'єднання для окремих каталогів rsync,
шукаючи іменований файл, виконуватиме сканування кожного каталогу,
об'єднуючи вміст файла, якщо файл існує у поточному списку успадкованих
правил. Ці файли правил для окремих каталогів має бути створено на боці
відправника, оскільки сканування щодо доступних для передавання файлів
виконуватиметься на боці відправника. Ці файли правил можуть потребувати
передавання на бік отримувача, якщо ви хочете, щоб вони впливали на те, які
файли не слід вилучати (див. ОКРЕМІ ДЛЯ КАТАЛОГІВ ПРАВИЛА І ВИЛУЧЕННЯ
нижче).
.P
Декілька прикладів:
.RS 4
.P
.nf
merge /etc/rsync/default.rules
\&. /etc/rsync/default.rules
dir\-merge .per\-dir\-filter
dir\-merge,n\- .non\-inherited\-per\-dir\-excludes
:n\- .non\-inherited\-per\-dir\-excludes
.fi
.RE
.P
Приймаються такі модифікатори після правила об'єднання або об'єднання
каталогів:
.P
.IP o
\fB\-\fP вказує, що файл складається лише зі взірців виключення; без іншої
обробки правил, окрім коментарів у файлі.
.IP o
\fB+\fP вказує, що файл складається лише зі взірців включення; без іншої
обробки правил, окрім коментарів у файлі.
.IP o
\fBC\fP є способом вказати, що файл має бути прочитано у спосіб, сумісний із
CVS. Вмикає «n», «w» і «\-», але також уможливлює визначення мітки
спорожнення списку (!). Якщо не вказано назви файла, буде використано назву
«.cvsignore».
.IP o
\fBe\fP виключить назву файла об'єднання зі списку передавання; наприклад,
«dir\-merge,e \&.rules» є тим самим, що і «dir\-merge .rules» і «\- .rules».
.IP o
\fBn\fP визначає, що правила не успадковуються підкаталогами.
.IP o
\fBw\fP вказує, що правила слід розділяти на слова за пробілами, а не звичайним
поділом за рядками. Також вимикає коментарі. Зауваження: пробіл, який
відокремлює префікс від правила, буде оброблено особливим чином, отже «\-
щось + десь» буде оброблено як два правила (припускаємо, що не було також
вимкнено обробку префіксів).
.IP o
Ви також можете вказати будь\-які модифікатори для правил «+» або «\-» (вище),
щоб усі правила, які буде прочитано з файла, типово мали встановлений
модифікатор (окрім модифікатора \fB!\fP, який не матиме сенсу). Наприклад,
«merge,\-/ .excl» наказує обробляти вміст .excl, як виключення за абсолютними
шляхами, а «dir\-merge,s .filt» і «:sC» кожне призведуть до застосування
їхніх правил для окремих каталогів на боці відправника. Якщо правила
об'єднання вказують кінці передавання, яких вони стосуються (за допомогою
модифікатора \fBs\fP або \fBr\fP чи обох модифікаторів), правила у файлі не
повинні містити визначення кінця передавання (за допомогою модифікатора або
префікса правил, зокрема \fBhide\fP).
.P
Правила для окремих каталогів успадковуються в усіх підкаталогах каталогу,
де було знайдено файл об'єднання, якщо не було використано модифікатор
«n». Правила для окремих підкаталогів буде дописано до успадкованих правил
для окремих каталогів з його батьківських каталогів, що дає найновішим
правилам вищий пріоритет за успадковані правила. Увесь набір правила
об'єднання каталогів буде згруповано у місці, Де було вказано файли
об'єднання, тому можна перевизначити правила об'єднання каталогів за
допомогою правила, яке вказано раніше у списку загальних правил. Якщо з
файла для окремих каталогів буде прочитано правило спорожнення списку («!»),
воно спорожнюватиме лише успадковані правила для поточного файла об'єднання.
.P
Іншим способом запобігти успадкуванню окремого правила з файла об'єднання
каталогів є його прив'язування за допомогою початкового символу похилої
риски. Прив'язані правила у файлів об'єднання для окремих каталогів є
відносними до каталогу файла об'єднання, тому взірець «/щось» відповідатиме
лише файлу «щось» у каталозі, де буде знайдено файл фільтрування об'єднання
каталогів.
.P
Ось приклад файла фільтрування, який можна вказати за допомогою
\fB\-\-filter=".\ file":\fP
.RS 4
.P
.nf
merge /home/user/.global\-filter
\- *.gz
dir\-merge .rules
+ *.[ch]
\- *.o
\- щось*
.fi
.RE
.P
У результаті на початок списку буде внесено вміст файла
/home/user/.global\-filter, а також визначено назву файла «.rules» для файла
фільтрування для окремих каталогів. Усі правила, які буде прочитано перед
початком сканування каталогів, підлягатимуть загальним правилам прив'язки
(тобто початковий символ похилої риски відповідатиме кореневому каталогу
передавання даних).
.P
Якщо вказано файл об'єднання для окремих каталогів із шляхом, який є
батьківським шляхом першого каталогу передавання, rsync буде сканувати усі
батьківські каталоги з початкової точки для передавання каталогу для
вказаного файла окремих каталогів. Наприклад, ось типове фільтрування
(див. \fB\-F\fP):
.RS 4
.P
.nf
\-\-filter=': /.rsync\-filter'
.fi
.RE
.P
Це правило наказує rsync сканувати файл .rsync\-filter в усіх каталогах від
кореневого через батьківський каталог передавання до початку звичайного
сканування каталогів файла у каталогах, які буде надіслано як частину
передавання. (Зауваження: для фонової служби rsync кореневим каталогом
завжди буде той самий каталог, що і «шлях» модуля.)
.P
Декілька прикладів цього попереднього сканування для файлів окремих
каталогів:
.RS 4
.P
.nf
rsync \-avF /джерело/шлях/ /призначення/каталог
rsync \-av \-\-filter=': ../../.rsync\-filter' /джерело/шлях/ /призначення/каталог
rsync \-av \-\-filter=': .rsync\-filter' /джерело/шлях/ /призначення/каталог
.fi
.RE
.P
Перші дві команди вище призведуть до пошуку «.rsync\-filter» у «/» і «/src»
перед початком звичайного сканування. Буде виконано пошук файла у
«/джерело/шлях» і його підкаталогах. Остання команда призведе до уникання
сканування батьківського каталогу і дасть пошук файлів «.rsync\-filter» лише
у кожному каталозі, який є частиною передавання.
.P
Якщо ви хочете включити вміст «.cvsignore» до ваших взірців, вам слід
скористатися правилом «:C», яке створює об'єднання каталогів файла
\&.cvsignore, але із обробкою у сумісний із CVS спосіб. Ви можете скористатися
цим для того, щоб вплинути на те, де відбуватиметься включення параметра
\fB\-\-cvs\-exclude\fP (\fB\-C\fP) файла \&.cvsignore для окремих каталогів до ваших
правил, за допомогою розташування «:C» там, де ви хочете розмістити ваші
правила фільтрування. Без цього, rsync додаватиме правило об'єднання
каталогів для файла .cvsignore наприкінці усіх ваших інших правил (що
надаватиме йому нижчої пріоритетності за правила у рядку команди). Приклад:
.RS 4
.P
.nf
cat <<EOT | rsync \-avC \-\-filter='. \-' a/ b
+ щось.o
:C
\- *.old
EOT
rsync \-avC \-\-include=щось.o \-f :C \-\-exclude='*.old' a/ b
.fi
.RE
.P
Обидві наведені вище команди rsync є тотожними. Кожна з них об'єднуватиме
усі правила .cvsignore для окремих каталогів всередині списку, а не у його
кінці. Це надає змогу його правилам для окремих каталогів мати вищий
пріоритет за правила, які описано після :C, а не бути перевизначеними усіма
вашими правилами. Щоб вплинути на інші правила виключення CVS (тобто типовий
список виключень, вміст $HOME/.cvsignore та значення $CVSIGNORE), вам слід
уникати використання параметра командного рядка \fB\-C\fP, а замість цього
вставити правило «\-C» до ваших правил фільтрування; наприклад,
«\fB\-\-filter=\-C\fP».
.P
.SH "ПРАВИЛО ФІЛЬТРУВАННЯ СПОРОЖНЕННЯ СПИСКУ"
.P
Ви можете спорожнити поточний список включення/виключення за допомогою
правила фільтрування «!» (як про це згадано у розділі ПРАВИЛА ФІЛЬТРУВАННЯ
вище). «Поточним» вважається список, який є або загальним списком правил
(якщо правило було виявлено під час обробки параметрів фільтрування), або
набір правил для окремих каталогів (які успадковуються у своєму власному
підписку, отже, на рівні підкаталогу цим можна скористатися для спорожнення
правил батьківського каталогу).
.P
.SH "ПРИВ'ЯЗКА ВЗІРЦІВ ВКЛЮЧЕННЯ/ВИКЛЮЧЕННЯ"
.P
Як вже згадувалося раніше, загальні взірці включення/виключення буде
прив'язано до «кореневого каталогу передавання» (на відміну від взірців
окремих каталогів, які прив'язано до каталогу файла об'єднання). Якщо
розглядати передавання, які підієрархію назв, які буде надіслано від
відправника до отримувача, кореневим каталогом передавання є каталог, де
починається ієрархія, яку слід здублювати у каталозі призначення. Цей
кореневий каталог керує тим, де встановлюватиметься відповідність взірців,
які починаються з /.
.P
Оскільки відповідність є відносною до кореневого каталогу передавання, зміна
кінцевого символу похилої риски у шляху джерела або зміна вашого
використання параметра \fB\-\-relative\fP впливає на шлях, яким вам слід
скористатися у вашій відповідності (на додачу до зміни того, наскільки
ієрархію файлів буде здубльовано на вузлі призначення). Це демонструють
наведені нижче приклади.
.P
Припустімо, що ви хочете встановити відповідність двох файлів джерела,
одного із абсолютним шляхом «/home/я/щось/десь», і одного зі шляхом
«/home/ви/десь/тут». Ось, як відрізняються різні варіанти команди для
передавання із 2 джерелами:
.RS 4
.P
.nf
Приклад команди: rsync \-a /home/я /home/ви /призначення
+/\- pattern: /я/щось/десь
+/\- pattern: /ви/десь/тут
Файл цілі: /призначення/я/щось/десь
Файл цілі: /призначення/ви/десь/тут
.fi
.RE
.RS 4
.P
.nf
Приклад команди: rsync \-a /home/я/ /home/ви/ /призначення
+/\- pattern: /щось/десь               (зауважте пропущене «я»)
+/\- pattern: /десь/тут                (зауважте пропущене «ви»)
Файл цілі: /призначення/щось/десь
Файл цілі: /призначення/десь/тут
.fi
.RE
.RS 4
.P
.nf
Приклад команди: rsync \-a \-\-relative /home/я/ /home/ви /призначення
+/\- pattern: /home/я/щось/десь       (зауважте повний шлях)
+/\- pattern: /home/ви/десь/тут       (те саме)
Файл цілі: /призначення/home/я/щось/десь
Файл цілі: /призначення/home/ви/десь/тут
.fi
.RE
.RS 4
.P
.nf
Приклад команди: cd /home; rsync \-a \-\-relative я/щось ви/ /призначення
+/\- pattern: /я/щось/десь      (починається з вказаного шляху)
+/\- pattern: /ви/десь/тут      (те саме)
Файл цілі: /призначення/я/щось/десь
Файл цілі: /призначення/ви/десь/тут
.fi
.RE
.P
Найпростішим способом перегляду, яку назву вам слід фільтрувати, є проста
обробка виведення при використанні \fB\-\-verbose\fP і додавання / перед назвою
(скористайтеся параметром \fB\-\-dry\-run\fP, якщо ви не готові до копіювання
якихось файлів).
.P
.SH "ПРАВИЛА ДЛЯ ОКРЕМИХ КАТАЛОГІВ ТА ВИЛУЧЕННЯ"
.P
Без параметра вилучення правила для окремих каталогів є дієвими лише на боці
відправника, ви можете виключити самі файли об'єднання без впливу на
передавання. Щоб спростити це, це виключення додає модифікатор «e», як це
можна бачити у цих двох тотожних командах:
.RS 4
.P
.nf
rsync \-av \-\-filter=': .excl' \-\-exclude=.excl вузол:джерело/каталог /призначення
rsync \-av \-\-filter=':e .excl' вузол:джерело/каталог /призначення
.fi
.RE
.P
Втім, якщо ви хочете виконати вилучення на боці отримання І ви хочете
виключити якісь файли зі списку вилучення, вам потрібно бути певними, що на
боці отримання було відомо, які файли слід виключити. Найпростішим способом
є включення файлів об'єднання окремих каталогів у передаванні і використання
\fB\-\-delete\-after\fP, оскільки це забезпечує те, що кінець отримання отримає ті
самі правила виключення, що маємо на боці відправника, перш ніж буде
зроблено спробу щось вилучити:
.RS 4
.P
.nf
rsync \-avF \-\-delete\-after вузол:джерело/каталог /призначення
.fi
.RE
.P
Втім, якщо файли об'єднання не є частиною передавання даних, вам слід або
вказати якісь загальні правила виключення (тобто правила, які вказано у
рядку команди), або вам доведеться супроводжувати ваші власні файли
об'єднання окремих каталогів на боці отримання. Прикладом першого є таке
(припускаємо, що віддалені файли .rules виключають самі себе):
.RS 4
.P
.nf
rsync \-av \-\-filter=': .rules' \-\-filter='. /my/extra.rules'
   \-\-delete вузол:джерело/каталог /призначення
.fi
.RE
.P
У наведеному вище прикладі файл extra.rules може стосуватися обох боків
передавання, але (на боці відправника) правила є підлеглими щодо правил, які
об'єднано з файлів .rules, оскільки їх було вказано після правила об'єднання
окремих каталогів.
.P
В останньому прикладі віддалений бік виключає файли .rsync\-filter з
передавання, але ми хочемо скористатися нашими власними файлами
\&.rsync\-filter для керування тим, що буде вилучено на боці отримання. Щоб
зробити це, ми маємо спеціально виключити файли об'єднання окремих каталогів
(отже, їх не буде вилучено), а потім записати правила до локальних файлів
для керування тим, що ще не має бути вилучено. Як одна з цих команд:
.RS 4
.P
.nf
rsync \-av \-\-filter=':e /.rsync\-filter' \-\-delete \e
    вузол:джерело/каталог /призначення
rsync \-avFF \-\-delete вузол:джерело/каталог /призначення
.fi
.RE
.P
.SH "ПАКЕТНИЙ РЕЖИМ"
.P
Пакетним режимом можна скористатися для застосування того самого набору
оновлень до багатьох тотожних систем. Припустімо, що маємо ієрархію, яка
відтворюється на значній кількості вузлів. Тепер, припустімо, що до ієрархії
джерела було внесено якісь зміни, і ці зміни має бути поширено на інші
вузли. Для того, щоб виконати це завдання за допомогою пакетного режиму,
rsync запускають із параметром пакетного запису для застосування змін, які
внесено до ієрархії джерела, до ієрархій призначення. Параметр пакетного
запису (write\-batch) наказує клієнту rsync зберігати у «пакетному файлі» усі
дані, які потрібні для повторення цих дій із іншими, тотожними, ієрархіями
призначення.
.P
Одноразове створення пакетного файла заощаджує час на перевірку стану
файлів, контрольних сум та створення блоку даних при оновленні декількох
ієрархій призначення. Можна використати протоколи трансляції даних для
паралельного одночасного передавання файлів пакетного оновлення на багато
вузлів, замість надсилання тих самих даних кожному вузлу окремо.
.P
Щоб застосувати записані зміни до іншої ієрархії призначення, запустіть
rsync із параметром пакетного читання (read\-batch), вказавши назву того
самого пакетного файла і ієрархію призначення. Rsync оновить ієрархію
призначення на основі відомостей, які збережено у пакетному файлі.
.P
For your convenience, a script file is also created when the write\-batch
option is used: it will be named the same as the batch file with ".sh"
appended.  This script file contains a command\-line suitable for updating a
destination tree using the associated batch file.  It can be executed using
a Bourne (or Bourne\-like) shell, optionally passing in an alternate
destination tree pathname which is then used instead of the original
destination path.  This is useful when the destination tree path on the
current host differs from the one used to create the batch file.
.P
Приклади:
.RS 4
.P
.nf
$ rsync \-\-write\-batch=щось \-a вузол:/джерело/каталог/ /aпризначення/каталог/
$ scp щось* remote:
$ ssh remote ./щось.sh /bпризначення/каталог/
.fi
.RE
.RS 4
.P
.nf
$ rsync \-\-write\-batch=щось \-a /джерело/каталог/ /aпризначення/каталог/
$ ssh remote rsync \-\-read\-batch=\- \-a /bпризначення/каталог/ <щось
.fi
.RE
.P
In these examples, rsync is used to update /adest/dir/ from /source/dir/ and
the information to repeat this operation is stored in "foo" and "foo.sh".
The host "remote" is then updated with the batched data going into the
directory /bdest/dir.  The differences between the two examples reveals some
of the flexibility you have in how you deal with batches:
.P
.IP o
Перший приклад показує, що початкове копіювання не має бути обов'язково
локальним\ \-\- ви можете, за потреби, записати або отримати дані до/з
віддаленого вузла за допомогою або синтаксису віддаленої оболонки, або
синтаксису фонової служби rsync.
.IP o
У першому прикладі використано створений файл «щось.sh» для отримання
належних параметрів rsync при запуску команди пакетного читання на
віддаленому вузлі.
.IP o
The second example reads the batch data via standard input so that the batch
file doesn't need to be copied to the remote machine first.  This example
avoids the foo.sh script because it needed to use a modified \fB\-\-read\-batch\fP
option, but you could edit the script file if you wished to make use of it
(just be sure that no other option is trying to use standard input, such as
the \fB\-\-exclude\-from=\-\fP option).
.P
Застереження:
.P
The read\-batch option expects the destination tree that it is updating to be
identical to the destination tree that was used to create the batch update
fileset.  When a difference between the destination trees is encountered the
update might be discarded with a warning (if the file appears to be
up\-to\-date already) or the file\-update may be attempted and then, if the
file fails to verify, the update discarded with an error.  This means that
it should be safe to re\-run a read\-batch operation if the command got
interrupted.  If you wish to force the batched\-update to always be attempted
regardless of the file's size and date, use the \fB\-I\fP option (when reading
the batch).  If an error occurs, the destination tree will probably be in a
partially updated state.  In that case, rsync can be used in its regular
(non\-batch) mode of operation to fix up the destination tree.
.P
The rsync version used on all destinations must be at least as new as the
one used to generate the batch file.  Rsync will die with an error if the
protocol version in the batch file is too new for the batch\-reading rsync to
handle.  See also the \fB\-\-protocol\fP option for a way to have the creating
rsync generate a batch file that an older rsync can understand.  (Note that
batch files changed format in version 2.6.3, so mixing versions older than
that with newer versions will not work.)
.P
When reading a batch file, rsync will force the value of certain options to
match the data in the batch file if you didn't set them to the same as the
batch\-writing command.  Other options can (and should) be changed.  For
instance \fB\-\-write\-batch\fP changes to \fB\-\-read\-batch\fP, \fB\-\-files\-from\fP is
dropped, and the \fB\-\-filter\fP / \fB\-\-include\fP / \fB\-\-exclude\fP options are not
needed unless one of the \fB\-\-delete\fP options is specified.
.P
The code that creates the BATCH.sh file transforms any
filter/include/exclude options into a single list that is appended as a
"here" document to the shell script file.  An advanced user can use this to
modify the exclude list if a change in what gets deleted by \fB\-\-delete\fP is
desired.  A normal user can ignore this detail and just use the shell script
as an easy way to run the appropriate \fB\-\-read\-batch\fP command for the
batched data.
.P
Початкова версія пакетного режиму у rsync було засновано на «rsync+», але у
найсвіжішій версії використано нову реалізацію.
.P
.SH "СИМВОЛІЧНІ ПОСИЛАННЯ"
.P
Three basic behaviors are possible when rsync encounters a symbolic link in
the source directory.
.P
By default, symbolic links are not transferred at all.  A message "skipping
non\-regular" file is emitted for any symlinks that exist.
.P
If \fB\-\-links\fP is specified, then symlinks are added to the transfer (instead
of being noisily ignored), and the default handling is to recreate them with
the same target on the destination.  Note that \fB\-\-archive\fP implies
\fB\-\-links\fP.
.P
Якщо вказано \fB\-\-copy\-links\fP, символічні посилання буде «згорнуто»
копіюванням того, на що вони посилаються, а не самого символічного
посилання.
.P
Rsync can also distinguish "safe" and "unsafe" symbolic links.  An example
where this might be used is a web site mirror that wishes to ensure that the
rsync module that is copied does not include symbolic links to
\fB/etc/passwd\fP in the public section of the site.  Using
\fB\-\-copy\-unsafe\-links\fP will cause any links to be copied as the file they
point to on the destination.  Using \fB\-\-safe\-links\fP will cause unsafe links
to be omitted by the receiver.  (Note that you must specify or imply
\fB\-\-links\fP for \fB\-\-safe\-links\fP to have any effect.)
.P
Symbolic links are considered unsafe if they are absolute symlinks (start
with \fB/\fP), empty, or if they contain enough ".." components to ascend from
the top of the transfer.
.P
Here's a summary of how the symlink options are interpreted.  The list is in
order of precedence, so if your combination of options isn't mentioned, use
the first line that is a complete subset of your options:
.P
.IP \fB\-\-copy\-links\fP
Turn all symlinks into normal files and directories (leaving no symlinks in
the transfer for any other options to affect).
.IP \fB\-\-copy\-dirlinks\fP
Turn just symlinks to directories into real directories, leaving all other
symlinks to be handled as described below.
.IP \fB\-\-links\ \-\-copy\-unsafe\-links\fP
Перетворити усі небезпечні символічні посилання на файли і створити усі
безпечні символічні посилання.
.IP \fB\-\-copy\-unsafe\-links\fP
Перетворити усі небезпечні символічні посилання на файли і з повідомленнями
пропустити усі безпечні символічні посилання.
.IP \fB\-\-links\ \-\-safe\-links\fP
The receiver skips creating unsafe symlinks found in the transfer and
creates the safe ones.
.IP \fB\-\-links\fP
Створити усі символічні посилання.
.P
Щоб дізнатися про роботу \fB\-\-munge\-links\fP, див. обговорення у розділі цього
параметра.
.P
Note that the \fB\-\-keep\-dirlinks\fP option does not effect symlinks in the
transfer but instead affects how rsync treats a symlink to a directory that
already exists on the receiving side.  See that option's section for a
warning.
.P
.SH ДІАГНОСТИКА
.P
Rsync occasionally produces error messages that may seem a little cryptic.
The one that seems to cause the most confusion is "protocol version
mismatch\ \-\- is your shell clean?".
.P
This message is usually caused by your startup scripts or remote shell
facility producing unwanted garbage on the stream that rsync is using for
its transport.  The way to diagnose this problem is to run your remote shell
like this:
.RS 4
.P
.nf
ssh remotehost /bin/true > out.dat
.fi
.RE
.P
then look at out.dat.  If everything is working correctly then out.dat
should be a zero length file.  If you are getting the above error from rsync
then you will probably find that out.dat contains some text or data.  Look
at the contents and try to work out what is producing it.  The most common
cause is incorrectly configured shell startup scripts (such as .cshrc or
\&.profile) that contain output statements for non\-interactive logins.
.P
If you are having trouble debugging filter patterns, then try specifying the
\fB\-vv\fP option.  At this level of verbosity rsync will show why each
individual file is included or excluded.
.P
.SH "ЗНАЧЕННЯ ВИХОДУ"
.P
.IP o
\fB0\fP — успіх
.IP o
\fB1\fP — синтаксична помилка або помилка використання
.IP o
\fB2\fP — несумісність протоколів
.IP o
\fB3\fP — помилки вибору вхідних\-вихідних файлів, каталоги
.IP o
.P
.RS
.IP o
\fB4\fP — підтримки бажаної дії не передбачено. Варіанти дій:

зроблено спробу керування 64\-бітовими файлами на платформі, де не
передбачено їхньої підтримки
.IP o
вказано параметр, підтримку якого передбачено на клієнті, але не на сервері
.RE
.IP o
\fB5\fP — помилка під час запуску протоколу клієнт\-сервер
.IP o
\fB6\fP — фоновій службі не вдалося дописати дані до файла журналу
.IP o
\fB10\fP — помилка у введенні\-виведенні із сокета
.IP o
\fB11\fP — помилка у введенні\-виведенні до файла
.IP o
\fB12\fP — помилка у потоці даних протоколу rsync
.IP o
\fB13\fP — помилки у діагностиці програми
.IP o
\fB14\fP — помилка у коді IPC
.IP o
\fB20\fP — отримано SIGUSR1 або SIGINT
.IP o
\fB21\fP — \fBwaitpid()\fP повернуто якусь помилку
.IP o
\fB22\fP — помилка розподілу буферів пам'яті ядра
.IP o
\fB23\fP — часткове передавання через помилку
.IP o
\fB24\fP — часткове передавання через зникнення початкових файлів
.IP o
\fB25\fP — зупинення вилучень через обмеження \-\-max\-delete
.IP o
\fB30\fP — перевищення часу очікування під час надсилання\-отримання даних
.IP o
\fB35\fP — перевищення часу очікування на з'єднання з фоновою службою
.P
.SH "ЗМІННІ СЕРЕДОВИЩА"
.P
.IP \fBCVSIGNORE\fP
The CVSIGNORE environment variable supplements any ignore patterns in
\&.cvsignore files.  See the \fB\-\-cvs\-exclude\fP option for more details.
.IP \fBRSYNC_ICONV\fP
Specify a default \fB\-\-iconv\fP setting using this environment variable. First
supported in 3.0.0.
.IP \fBRSYNC_OLD_ARGS\fP
Specify a "1" if you want the \fB\-\-old\-args\fP option to be enabled by default,
a "2" (or more) if you want it to be enabled in the repeated\-option state,
or a "0" to make sure that it is disabled by default. When this environment
variable is set to a non\-zero value, it supersedes the \fBRSYNC_PROTECT_ARGS\fP
variable.
.IP
This variable is ignored if \fB\-\-old\-args\fP, \fB\-\-no\-old\-args\fP, or
\fB\-\-protect\-args\fP is specified on the command line.
.IP
Вперше реалізовано підтримку у 3.2.4.
.IP \fBRSYNC_PROTECT_ARGS\fP
Specify a non\-zero numeric value if you want the \fB\-\-protect\-args\fP option to
be enabled by default, or a zero value to make sure that it is disabled by
default.
.IP
This variable is ignored if \fB\-\-protect\-args\fP, \fB\-\-no\-protect\-args\fP, or
\fB\-\-old\-args\fP is specified on the command line.
.IP
Вперше реалізовано підтримку у версії 3.1.0. Починаючи з 3.2.4, цю змінну
буде проігноровано, якщо встановлено ненульове значення для
\fBRSYNC_OLD_ARGS\fP.
.IP \fBRSYNC_RSH\fP
This environment variable allows you to override the default shell used as
the transport for rsync.  Command line options are permitted after the
command name, just as in the \fB\-\-rsh\fP (\fB\-e\fP) option.
.IP \fBRSYNC_PROXY\fP
This environment variable allows you to redirect your rsync client to use a
web proxy when connecting to an rsync daemon.  You should set \fBRSYNC_PROXY\fP
to a hostname:port pair.
.IP \fBRSYNC_PASSWORD\fP
This environment variable allows you to set the password for an rsync
\fBdaemon\fP connection, which avoids the password prompt.  Note that this does
\fBnot\fP supply a password to a remote shell transport such as ssh (consult
its documentation for how to do that).
.IP "\fBUSER\fP або \fBLOGNAME\fP"
The USER or LOGNAME environment variables are used to determine the default
username sent to an rsync daemon.  If neither is set, the username defaults
to "nobody".  If both are set, \fBUSER\fP takes precedence.
.IP \fBRSYNC_PARTIAL_DIR\fP
This environment variable specifies the directory to use for a \fB\-\-partial\fP
transfer without implying that partial transfers be enabled.  See the
\fB\-\-partial\-dir\fP option for full details.
.IP \fBRSYNC_COMPRESS_LIST\fP
This environment variable allows you to customize the negotiation of the
compression algorithm by specifying an alternate order or a reduced list of
names.  Use the command \fBrsync\ \-\-version\fP to see the available compression
names.  See the \fB\-\-compress\fP option for full details.
.IP \fBRSYNC_CHECKSUM_LIST\fP
This environment variable allows you to customize the negotiation of the
checksum algorithm by specifying an alternate order or a reduced list of
names.  Use the command \fBrsync\ \-\-version\fP to see the available checksum
names.  See the \fB\-\-checksum\-choice\fP option for full details.
.IP \fBRSYNC_MAX_ALLOC\fP
Ця змінна середовища встановлює максимум отримання пам'яті, подібний до
того, який встановлює використання параметра \fB\-\-max\-alloc\fP.
.IP \fBRSYNC_PORT\fP
This environment variable is not read by rsync, but is instead set in its
sub\-environment when rsync is running the remote shell in combination with a
daemon connection.  This allows a script such as \fBrsync\-ssl\fP to be able to
know the port number that the user specified on the command line.
.IP \fBHOME\fP
Цю змінну середовища використовують для пошуку типового файла .cvsignore
користувача.
.IP \fBRSYNC_CONNECT_PROG\fP
Цю змінну середовища, в основному, використовують у конфігураціях для
діагностики для встановлення програми, яку слід використовувати при
встановленні з'єднання із фоновою службою. Див. розділ З'ЄДНАННЯ ІЗ ФОНОВОЮ
СЛУЖБОЮ RSYNC, щоб ознайомитися з усіма подробицями.
.IP \fBRSYNC_SHELL\fP
Цю змінну середовища, в основному, використовують у конфігураціях для
діагностики для встановлення програми, яку слід використовувати для запуску
програми, яку вказано за допомогою [\fBRSYNC_CONNECT_PROG\fP]. Див. розділ
З'ЄДНАННЯ ІЗ ФОНОВОЮ СЛУЖБОЮ RSYNC, щоб ознайомитися з усіма подробицями.
.P
.SH ФАЙЛИ
.P
/etc/rsyncd.conf або rsyncd.conf
.P
.SH "ДИВ. ТАКОЖ"
.P
\fBrsync\-ssl\fP(1), \fBrsyncd.conf\fP(5), \fBrrsync\fP(1)
.P
.SH ВАДИ
.P
.IP o
Часові значення передаються як значення *nix time_t.
.IP o
При передавання даних до файлових систем FAT rsync може повторно
синхронізувати незмінені файли. Див. коментарі щодо параметра
\fB\-\-modify\-window\fP.
.IP o
Права доступу до файлів, пристроїв тощо передаються як природні для системи
числові значення.
.IP o
Див. також коментарі щодо параметра \fB\-\-delete\fP.
.P
Будь ласка, повідомляйте про вади! Див. сайт на https://rsync.samba.org/.
.P
.SH ВЕРСІЯ
.P
Ця сторінка підручника є актуальною для версії 3.2.4 rsync.
.P
.SH "ВНУТРІШНІ ПАРАМЕТРИ"
.P
The options \fB\-\-server\fP and \fB\-\-sender\fP are used internally by rsync, and
should never be typed by a user under normal circumstances.  Some awareness
of these options may be needed in certain scenarios, such as when setting up
a login that can only run an rsync command.  For instance, the support
directory of the rsync distribution has an example script named rrsync (for
restricted rsync)  that can be used with a restricted ssh login.
.P
.SH ПОДЯКИ
.P
Поширення rsync відбувається за умов дотримання GNU General Public
License. Див. файл COPYING, щоб дізнатися більше.
.P
Сайтом rsync є https://rsync.samba.org/. На сайті є FAQ\-O\-Matic, де можуть
бути відповіді на питання, яких немає на цій сторінці підручника.
.P
Проєкт rsync на github має адресу https://github.com/WayneD/rsync.
.P
Ми будемо раді почути від вас про те, що вам подобається ця програма. Будь
ласка, зв'яжіться з нами за допомогою списку листування
rsync@lists.samba.org.
.P
У цій програмі використано чудову бібліотеку для стискання zlib, яку
написано Jean\-loup Gailly і Mark Adler.
.P
.SH ПОДЯКИ
.P
Особливі подяки John Van Essen, Matt McCutchen, Wesley W. Terpstra, David
Dykstra, Jos Backus, Sebastian Krahmer, Martin Pool і нашому другу, який
полишив нас, але якого ми не забули, J.W. Schultz.
.P
Дякуємо також Richard Brent, Brendan Mackay, Bill Waite, Stephen Rothwell і
David Bell. Ймовірно, ми когось забули. Вибачте, якщо це так.
.P
.SH АВТОР
.P
Першу версію rsync було написано Andrew Tridgell і Paul Mackerras. З того
часу участь у розробці взяло багато людей. Поточний супровід програми
здійснює Wayne Davison.
.P
Списки листування для підтримки та розробників наведено на сторінці
https://lists.samba.org/.
