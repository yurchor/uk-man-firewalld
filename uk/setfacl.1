.\" Access Control Lists manual pages
.\"
.\" (C) 2000 Andreas Gruenbacher, <a.gruenbacher@bestbits.at>
.\"
.\" This is free documentation; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public License as
.\" published by the Free Software Foundation; either version 2 of
.\" the License, or (at your option) any later version.
.\"
.\" The GNU General Public License's references to "object code"
.\" and "executables" are to be interpreted as the output of any
.\" document formatting or typesetting system, including
.\" intermediate and printed output.
.\"
.\" This manual is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public
.\" License along with this manual.  If not, see
.\" <http://www.gnu.org/licenses/>.
.\"
.\"*******************************************************************
.\"
.\" This file was generated with po4a. Translate the source file.
.\"
.\"*******************************************************************
.TH SETFACL 1 "Програми для роботи з файлами ACL" "травень 2000 року" "Списки керування доступом"
.SH НАЗВА
setfacl — встановлення списків керування доступом до файлів
.SH "КОРОТКИЙ ОПИС"

\fBsetfacl\fP [\-bkndRLPvh] [{\-m|\-x} специфікація_acl] [{\-M|\-X} файл_acl] файл
\&...

\fBsetfacl\fP \-\-restore=файл

.SH ОПИС
Ця допоміжна програма встановлює списки керування доступом (Access Control
Lists або ACL) для файлів і каталогів. У рядку команди за послідовністю
команд має бути вказано послідовність файлів (за якою можна також вказати ще
одну послідовність команд тощо).

Параметрам \fI\-m\fP і \fI\-x\fP слід передати ACL у рядку команди. Якщо вказано
декілька ACL, записи слід відокремлювати комами («,»). Використання
параметрів \fI\-M\fP і \fI\-X\fP призведе до читання ACL з файла або стандартного
джерела вхідних даних. Формат запису ACL описано у розділі «ЗАПИСИ ACL».

Параметри \fI\-\-set\fP і \fI\-\-set\-file\fP встановлюють ACL файла або
каталогу. Попередній ACL буде замінено. Записи ACL для цієї дії мають
включати права доступу.

Параметри \fI\-m (\-\-modify)\fP і \fI\-M (\-\-modify\-file)\fP вносять зміни до ACL
файла або каталогу. Записи ACL для цієї дії мають включати права доступу.

Використання параметрів \fI\-x (\-\-remove)\fP і \fI\-X (\-\-remove\-file)\fP призведе до
вилучення записів ACL. Вилучення запису, якого не існує, не вважається
помилкою. Як параметри, приймаються лише записи ACL без поля
\fIправа_доступу\fP, якщо не визначено POSIXLY_CORRECT.

При читанні даних з файлів, якщо використано параметри \fI\-M\fP і \fI\-X\fP,
setfacl приймає дані, які виведено програмою getfacl. Кількість записів ACL
у одному рядку має не перевищувати одного. Усі дані після символу решітки
(«#»), аж до кінця рядка, вважатимуться коментарем.

Якщо setfacl буде використано для файлової системи, у якій не передбачено
підтримки ACL, setfacl працюватиме з бітами режиму доступу до файлів. Якщо
повної відповідності ACL бітам прав доступу не вдасться встановити, setfacl
видозмінить біти режиму доступу до файлів так, щоб відтворити ACL якомога
точніше, запише повідомлення про помилку до стандартного виведення помилок і
поверне код виходу, який перевищуватиме 0.

.SS "ПРАВА ДОСТУПУ"
Власнику файла і процесам із можливістю CAP_FOWNER буде надано права для
внесення змін до ACL файла. Це аналогічно до прав доступу, які потрібні для
доступу до даних щодо режиму доступу до файла. (У поточних системах Linux
єдиним користувачем, який має доступ до можливості CAP_FOWNER, є root.)

.SH ПАРАМЕТРИ
.TP  4
\fI\-b, \-\-remove\-all\fP
Вилучити усі розширені записи ACL. Лишаться лише базові записи ACL щодо
власника, груп та інших користувачів.
.TP  4
\fI\-k, \-\-remove\-default\fP
Вилучити типовий ACL. Якщо типового ACL не існує, програма не виводитиме
попереджень.
.TP  4
\fI\-n, \-\-no\-mask\fP
Не переобчислювати маску ефективних прав. Типовою поведінкою setfacl є
переобчислення запису маски ACL, якщо не вказано явним чином запис
маски. Запис маски буде встановлено як об'єднання усіх прав доступу
групи\-власника і усіх іменованих записів користувачів і груп. (Це саме ті
записи, на які впливає запис маски).
.TP  4
\fI\-\-mask\fP
Переобчислити маску ефективних прав доступу, навіть якщо запис маски ACL
було задано явно. (Див. параметр \fI\-n\fP.)
.TP  4
\fI\-d, \-\-default\fP
Усі дії буде застосовано до типового ACL. Звичайні записи ACL у вхідному
наборі даних буде розширено до типових записів ACL. Записи типових ACL у
вхідному наборі даних буде відкинуто. (Якщо таке трапиться, буде виведено
попередження.)
.TP  4
\fI\-\-restore=файл\fP
Відновити резервну копію прав доступу, яку створено «getfacl \-R» або
подібною командою. Усі права доступу повного піддерева каталогів буде
відновлено за допомогою цього механізму. Якщо вхідні дані містять коментарі
щодо власника або коментарі щодо групи, setfacl спробує відновити дані щодо
користувача\-власника і групи\-власника. Якщо у вхідних даних містяться
коментарі щодо прапорців (яків визначають біти setuid, setgid і липкий біт),
setfacl встановить значення цих трьох бітів за коментарями. Якщо таких
коментарів виявлено не буде, біти буде очищено. Цей параметр не можна
використовувати у поєднанні з іншими параметрами, окрім параметра «\-\-test».
.TP  4
\fI\-\-test\fP
Режим тестування. Замість внесення змін до ACL якихось файлів, буде просто
виведено список ACL результатів можливого виконання команди.
.TP  4
\fI\-R, \-\-recursive\fP
Застосувати дії до усіх файлів та каталогів рекурсивно. Цей параметр не
можна поєднувати з параметром «\-\-restore».
.TP  4
\fI\-L, \-\-logical\fP
Логічний обхід з переходом за символічними посиланнями на каталоги. Типовою
поведінкою є перехід за аргументами символічних посилань і пропускання
символічних посилань у підкаталогах. Працює лише у поєднанні з \-R. Цей
параметр не можна поєднувати з параметром «\-\-restore».
.TP  4
\fI\-P, \-\-physical\fP
Фізичний обхід без переходу за символічними посиланнями на каталоги. У
результаті також буде пропущено аргументи символічних посилань. Працює лише
у поєднанні з \-R. Цей параметр не можна поєднувати з параметром «\-\-restore».
.TP  4
\fI\-v, \-\-version\fP
Вивести дані щодо версії setfacl і завершити роботу.
.TP  4
\fI\-h, \-\-help\fP
Вивести довідку із поясненням щодо параметрів командного рядка.
.TP  4
\fI\-\-\fP
Кінець параметрів командного рядка. Решта параметрів вважатиметься назвами
файлів, навіть якщо вони починаються із символу дефіса.
.TP  4
\fI\-\fP
Якщо параметр назви файла є одинарним символом дефіса, setfacl читає список
файлів зі стандартного джерела вхідних даних.

.SS "ЗАПИСИ ACL"
У програмі setfacl передбачено розпізнавання таких форматів записів ACL
(пробіли вставлено для зручності):

.fam C
.TP 
[d[efault]:] [u[ser]:]\fIuid \fP[:\fIправа_доступу\fP]
.fam T
Права доступу іменованого користувача. Права доступу власника файла, якщо
\fIuid\fP є порожнім.
.fam C
.TP 
[d[efault]:] g[roup]:\fIgid \fP[:\fIправа_доступу\fP]
.fam T
Права доступу іменованої групи. Права доступу групи\-власника, якщо \fIgid\fP є
порожнім.
.fam C
.TP 
[d[efault]:] m[ask][:] [:\fIправа_доступу\fP]
.fam T
Маска ефективних прав
.fam C
.TP 
[d[efault]:] o[ther][:] [:\fIправа_доступу\fP]
.fam T
Права доступу інших.
.PP
Пробіли між символами\-роздільниками і символами, які не є роздільниками,
буде проігноровано.
.PP
.PP
Належні записи ACL, включно з правами доступу, буде використано у діях зі
зміни та встановлення прав доступу (параметри \fI\-m\fP, \fI\-M\fP, \fI\-\-set\fP і
\fI\-\-set\-file\fP). Записи без поля \fIправа_доступу\fP буде використано для
\fIвилучення\fP записів (параметри \fI\-x\fP і \fI\-X\fP).
.PP
Для \fIuid\fP і \fIgid\fP ви можете вказати назву або число. Символьні літерали
можна вказувати за допомогою символу зворотної похилої риски із наступним
3\-цифровим вісімковим значенням, яке відповідають коду ASCII символу
(наприклад, \fI\e101\fP — це «A»). Якщо у назві міститься сам символ зворотної
похилої риски із трьома наступними цифрами, символ зворотної похилої риски
слід екранувати (тобто, \fI\e\e\fP).
.PP
Поле \fIправа_доступу\fP є комбінацією символів, які позначають права доступу
до читання \fI(r)\fP, записування \fI(w)\fP, виконання \fI(x)\fP. Символи дефіса у
полі \fIправа_доступу\fP, \fI(\-)\fP, буде проігноровано. Символ \fIX\fP позначає
права доступу для виконання, якщо файл є каталогом або вже має права доступу
для виконання для іншого користувача. Крім того, у полі \fIправа_доступу\fP
права доступу можна визначати у числовій формі, як побітове поєднання
значень читання \fI(4)\fP, записування \fI(2)\fP та виконання \fI(1)\fP. Нульове
значення у полі \fIправа_доступу\fP або поля \fIправа_доступу\fP, що складаються
лише з дефісів, означають те, що відповідних прав доступу немає.
.PP
.SS "ЗАПИСИ, ЯКІ СТВОРЕНО АВТОМАТИЧНО"
Спочатку, записи файлів і каталогів містять лише три базових записи ACL щодо
власника, групи та доступу інших користувачів. Передбачено певні правила,
які має бути виконано, щоб запис ACL був коректним:
.IP * 4
Три базових записи не можна вилучати. Має бути точно один запис для кожного
з цих базових типів записів.
.IP * 4
Якщо ACL містить іменовані записи користувачів або іменовані об'єкти груп,
він також має містити маску ефективних прав доступу.
.IP * 4
Якщо ACL містить записи типового ACL, також мають існувати три базових
записи ACL (права для типового власника, типової групи та інших
користувачів).
.IP * 4
Якщо типовий ACL містить іменовані записи користувачів або іменовані об'єкти
груп, він також має містити типову маску ефективних прав доступу.
.PP
Щоб допомогти користувачеві у виконанні цих правил, setfacl створює записи
на основі наявних записів за таких умов:
.IP * 4
Якщо ACL містить іменовані записи користувача або іменовані записи груп, і
немає запису маски, буде створено запис маски, що міститиме ті самі права
доступу, що і запис групи. Якщо не вказано параметр \fI\-n\fP, права доступу
запису маски буде скориговано так, щоб включити об'єднання усіх прав
доступу, яких стосується запис маски. Див. опис параметра \fI\-n\fP.
.IP * 4
Якщо буде створено запис типового ACL, і типовий ACL не містить прав доступу
для власника, групи власника та інших користувачів, до типового ACL буде
додано запис власника ACL, групи власника ACL або запис інших користувачів
ACL.
.IP * 4
Якщо типовий ACL містить іменовані записи користувача або іменовані записи
груп, і немає запису маски, буде додано запис маски, що міститиме ті самі
права доступу, що і типовий запис групи типового ACL. Якщо не вказано
параметр \fI\-n\fP, права доступу запису маски буде скориговано так, щоб
включити об'єднання усіх прав доступу, яких стосується запис
маски. Див. опис параметра \fI\-n\fP.
.PP
.SH ПРИКЛАДИ
.PP
Надання додаткових прав доступу до читання користувачем
.RS
.fam C
setfacl \-m u:lisa:r файл
.fam T
.RE
.PP
Відкликання доступу до запису для усіх груп і усіх іменованих користувачів
(за допомогою маски ефективних прав)
.RS
.fam C
setfacl \-m m::rx файл
.fam T
.RE
.PP
Вилучення іменованого запису групи з ACL файла
.RS
.fam C
setfacl \-x g:staff файл
.fam T
.RE
.PP
Копіювання ACL одного файла до іншого
.RS
.fam C
getfacl файл1 | setfacl \-\-set\-file=\- файл2
.fam T
.RE
.PP
Копіювання ACL доступу до типового ACL
.RS
.fam C
getfacl \-\-access каталог | setfacl \-d \-M\- каталог
.fam T
.RE
.SH "СУМІСНІСТЬ ІЗ ЧЕРНЕТКОЮ СТАНДАРТУ POSIX 1003.1e 17"
Якщо визначено змінну середовища POSIXLY_CORRECT, типову поведінку setfacl
буде змінено таким чином: усі нестандартні параметри буде вимкнено. Префікс
\*(lqdefault:\*(rq буде вимкнено. Параметри \fI\-x\fP і \fI\-X\fP прийматимуть поля прав
доступу (і ігноруватимуть їх).
.SH АВТОР
Andreas Gruenbacher, <\fIa.gruenbacher@bestbits.at\fP>.

Будь ласка, надсилайте ваші звіти про вади, пропозиції можливостей та
коментарі на вказану вище адресу.
.SH "ДИВ. ТАКОЖ"
\fBgetfacl\fP(1), \fBchmod\fP(1), \fBumask\fP(1), \fBacl\fP(5)
